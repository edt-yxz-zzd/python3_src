
import sympy
from sympy import factor, binomial, factorint
from sympy.matrices import Matrix
from sympy.abc import x

from Stirling_numbers import Stirling_circle
from Pascal_numbers import Pascal_number
from fractions import Fraction
from factor_fraction import factor_fraction


fr = Fraction
one = Fraction(1)
C = binomial



def make_poly(cs, x=x):
    'big-endian: sum cs[i] x**(L-i) {i=0..L} where L = len(cs)-1 = deg'
    f = 0
    for c in cs:
        f *= x
        f += c
    return f

def factor_poly_by_coeffs(cs, x=x):
    f = make_poly(cs,x)
    r = factor(f)
    return r


def Vandermonde_matrix(xs):
    L = len(xs)
    mx = [[x**i for i in reversed(range(L))] for x in xs]
    return mx


def poly_xys2coeffs(xs, ys):
    V = Matrix(Vandermonde_matrix(xs))
    invV = V.inv()
    cs = invV * Matrix(ys)
    return list(cs)






def diff(xs):
    xp1s = xs[1:]
    return [xp1-x for xp1, x in zip(xp1s, xs)]

        
def ints_polyfit(ints, start=0):
    ys = ints
    deg = 0
    while len(ys):
        ys = diff(ys)
        if not any(ys):
            break
        deg += 1
    else:
        raise ValueError('cant fit')

    L = deg+1
    assert len(ints) >= L
    
    xs = list(range(start, start+len(ints)))
    ys = ints
    
    cs = poly_xys2coeffs(xs[:L], ys[:L])
    cs = list(cs)
    
    assert all(make_poly(cs, x) == y for x,y in zip(xs, ys))
    return cs



'''

Stirling_polynomial(n, x) = Stirling[x,x-n]/fall(x, n+1)
    = Stirling[x,x-n]/x/(x-1)/.../(x-n)
degree(Stirling_polynomial(n, x), x) = n-1
    n >= 1
    Stirling_polynomial(n, i) = Stirling[i,i-n]/fall(i, n+1) for i = (n+1)..(2n)

Stirling_poly_LC1(d, x) = Stirling_polynomial(d+1, x) 2**(d+1) (d+1)!
    = Stirling[x,x-(d+1)]/fall(x, d+1+1) 2**(d+1) (d+2)!/(d+2)
    = Stirling[x,x-(d+1)] 2**(d+1)/(d+2)/C(x, d+2)
'''


def calc_Stirling_poly_LC1(d, C=C):
    n = d+1
    xs = list(reversed(range(n+1, 2*n+1))) # max(xs) = 2n = 2(d+1)
    
    yN_s = list(Stirling_circle(x, x-n)*2**n for x in xs)
    yD_s = list((n+1)*C(x, n+1) for x in xs)
    ys = [one*N/D for N, D in zip(yN_s, yD_s)]
    
##    qs = [N//D for N, D in zip(yN_s, yD_s)]
##    rs = [N%D for N, D in zip(yN_s, yD_s)]
##    if any(rs):
##        print(d, rs)
##        #assert not any(rs)
    
    cs = poly_xys2coeffs(xs, ys)

    assert cs[0] == 1
    return cs

Stirling_poly_LC1_table = []

def Stirling_poly_LC1_table_least_len(L):
    table = Stirling_poly_LC1_table

    if L > len(table):
        max_d = L-1
        max_x = 2*(max_d+1)
        Pascal_number(max_x, 1)
        Stirling_circle(max_x, 1)
        for d in range(len(table), L):
            row = calc_Stirling_poly_LC1(d, C=Pascal_number)
            table.append(row)
        assert len(table) == L > 0
        assert len(table[-1]) == L == d+1

    
    return table

##print(list(map(factor_fraction, calc_Stirling_poly_LC1(3))))
#print(Stirling_poly_LC1_ls(10))
assert calc_Stirling_poly_LC1(3) == [1, -2, 1/3, 2/15]
assert Stirling_poly_LC1_table_least_len(6)[:6] == [
    [1], [1, fr(-1,3)], [1, -1, 0], [1, -2, 1/3, 2/15],
    [1, -10/3, 5/3, 2/3, 0], [1, -5, 5, 13/9, -2/3, -16/63],]

'''
Stirling_poly_LC1_table_least_len(30)
py -m nn_ns.txt.txt_replace tmp.txt -f (\d+)/(\d+) -r fr(\1,\2) -m rr

Stirling_poly_LC1_table = [
    [1],
    [1, -1/3],
    [1, -1, 0],
    [1, -2, 1/3, 2/15],
    [1, -10/3, 5/3, 2/3, 0],
    [1, -5, 5, 13/9, -2/3, -16/63],
    [1, -7, 35/3, 7/9, -14/3, -16/9, 0],
    [1, -28/3, 70/3, -56/9, -469/27, -4, 404/135, 16/15],
    [1, -12, 42, -448/15, -133/3, 20/3, 404/15, 48/5, 0],
    [1, -15, 70, -266/3, -245/3, 745/9, 1072/9, 188/9, -208/9, -256/33],
    [1, -55/3, 110, -638/3, -847/9, 3179/9, 968/3, -1100/9, -2288/9, -256/3, 0],
    [1, -22, 165, -1342/3, 77/3, 3146/3, 12661/27, -10582/9, -34892/27, -2488/15, 255968/945, 353792/4095],
    [1, -26, 715/3, -858, 1573/3, 154726/63, -55627/135, -237094/45, -96668/27, 34216/15, 3327584/945, 353792/315, 0],
    [1, -91/3, 1001/3, -23023/15, 17017/9, 42185/9, -713713/135, -6565559/405, -22022/9, 8790964/405, 903656/45, 712672/405, -603392/135, -4096/3],
    [1, -35, 455, -23387/9, 5005, 63635/9, -566137/27, -986843/27, 778778/27, 2802436/27, 1477736/27, -1410080/27, -603392/9, -20480, 0],
    [1, -40, 1820/3, -37856/9, 34034/3, 6864, -1622764/27, -1487200/27, 14343329/81, 26575640/81, -2983864/81, -41901760/81, -170600624/405, -8787584/405, 13321472/135, 7407616/255],
    [1, -136/3, 2380/3, -59024/9, 628082/27, -28288/9, -1273844/9, -1127984/81, 52234897/81, 272022712/405, -453143704/405, -1066552256/405, -438371248/405, 602636672/405, 226465024/135, 7407616/15, 0],
    [1, -51, 1020, -29716/3, 133042/3, -116246/3, -12825956/45, 11678524/45, 5321459/3, 500676163/1215, -833643824/135, -3405549208/405, 144415952/45, 6305863312/405, 103066240/9, 1825965824/8505, -2653554688/945, -2874867712/3591],
    [1, -57, 1292, -218348/15, 239666/3, -1178950/9, -22153924/45, 52588276/45, 104525707/27, -4279960919/1215, -6998960384/315, -39540256888/2835, 6179837552/135, 6792927728/81, 395207296/15, -444120132352/8505, -50417539072/945, -2874867712/189, 0],
    [1, -190/3, 1615, -62662/3, 1237090/9, -21195260/63, -6306898/9, 94712644/27, 174548231/27, -4848845638/243, -301489295939/5103, 1348108330/63, 60325596296/243, 7156486192/27, -44013566576/243, -24636553013024/42525, -9986974905344/25515, 12794412544/2835, 624182448128/6237, 22886612992/825],
    [1, -70, 1995, -88046/3, 682822/3, -2257124/3, -18535678/27, 77552300/9, 169509431/27, -183313500734/2673, -27364870403/243, 21436582990/81, 361780571224/405, 108707345104/405, -865729339216/405, -19921376143712/6075, -911817872384/1215, 300281183744/135, 624182448128/297, 160206290944/275, 0],
    [1, -77, 7315/3, -121429/3, 1094324/3, -13849594/9, 3204806/27, 165377938/9, -193670477/27, -223439442863/1215, -124651224269/1215, 4345353851377/3645, 8184850095202/3645, -2841293709496/1215, -14203922012896/1215, -6763266942608/675, 21226516994848/2025, 95336230592768/3645, 59866981027328/3645, -1328300302336/2025, -8842115842048/2025, -81456529408/69],
    [1, -253/3, 8855/3, -54901, 5114648/9, -26544254/9, 398298406/135, 14049293918/405, -1613705093/27, -495348492149/1215, 1053110085989/3645, 13891955119571/3645, 11497320849278/3645, -21356249295656/1215, -3398129675776/81, 425610933968/6075, 2108758776387296/18225, 563409841654528/3645, 84882896003584/3645, -229527120306176/2025, -203368664367104/2025, -81456529408/3, 0],
    [1, -92, 3542, -3301144/45, 2590973/3, -48358420/9, 1383992984/135, 7800568864/135, -5559261851/27, -904997303228/1215, 2370044584882/1215, 11576836719896/1215, -8660399429605/2187, -53868141351244/729, -1043579237620084/10935, 1147019165375248/6075, 11729611741956592/18225, 2695859041327936/6075, -183481793736874432/273375, -25694888556475136/18225, -63533089962165248/76545, 2361975286509568/42525, 632800778428448768/2764125, 247845713084416/4095],
    [1, -100, 12650/3, -870320/9, 1283975, -84527300/9, 716627560/27, 2214681040/27, -44230817345/81, -250683135940/243, 1673183227090/243, 174509138568400/9477, -100563289259245/2187, -164998917739180/729, -97940121802820/2187, 10480420892268976/8505, 11651990822978704/5103, -3615371095534528/5103, -79364611224029632/10935, -31518392110776064/3645, -10172029287764992/15309, 11599145721376768/1701, 632800778428448768/110565, 1239228565422080/819, 0],
    [1, -325/3, 14950/3, -1133210/9, 50535485/27, -142693265/9, 1613517620/27, 7061483000/81, -100747677745/81, -152351666155/243, 96050480545630/5103, 116979885621650/5103, -424279898878381/2187, -3389241749938343/6561, 64414364995552/81, 1154375511094074412/229635, 7391134409360416/1701, -236011635183417808/15309, -449897968546713856/10935, -147513735615168832/6561, 1237348698950184704/25515, 4110145412772545536/45927, 181224695525076992/3645, -117726690384969728/25515, -40263682362966016/2835, -11038250500096/3],
    [1, -117, 5850, -162110, 2680535, -181832365/7, 369880940/3, 64595960/3, -2526823585, 178866358853/81, 8172957845026/189, -1608219029086/189, -144630772253653/243, -180440059226303/243, 1155354063644872/243, 125175738808934476/8505, -17561288034319744/2835, -53949151285311568/567, -1212095493969073792/8505, 112570052014533568/1215, 4463673164361518848/8505, 963645737618596864/1701, 2971311818641408/945, -64616914721275904/135, -40263682362966016/105, -99344254500864, 0],
    [1, -126, 6825, -206570, 3777865, -124381010/3, 238955717, -228526298, -41733676985/9, 924624187214/81, 2296096638329/27, -13478582967982/81, -357777750735607/243, 70729628110922/243, 12913917329531855/729, 104802385437967594/3645, -344011076505792124/3645, -277663272636995960/729, -233158583558413552/1215, 1651582935780852256/1215, 11042922668479452608/3645, 23084291808336423808/18225, -72339211676537078272/18225, -24093623499674519552/3645, -4232251515232608256/1215, 831206463984959488/2025, 694578666150035456/675, 113842810733461504/435],
    [1, -406/3, 7917, -1303666/5, 15741635/3, -193985350/3, 1323792899/3, -8017536098/9, -68926602745/9, 2824767607298/81, 33986618341429/243, -53627941515806/81, -720195712497967/243, 4825059709119130/729, 36732801247661491/729, 5011226820134786/405, -1735889646220966028/3645, -3817889148088071992/3645, 7234028825581556752/6075, 5971848966262026848/729, 7350260643188186048/729, -64233680599432612736/6075, -792059360954282392064/18225, -156631919103241578496/3645, 3370559219063922688/1215, 78555573347487383552/2025, 20142781318351028224/675, 113842810733461504/15, 0],
    [1, -145, 9135, -326221, 7191275, -98783425, 7051300555/9, -2394019745, -99806201495/9, 7026553304225/81, 13897873900885/81, -17230507031375/9, -1092273013558325/243, 6975594047253295/243, 27224761515905635/243, -2089848657020357789/10935, -1214771376701934662/729, -3267778959029798044/2187, 12977485945013632952/1215, 352129764279423820144/10935, 3883781414076568160/729, -1444288511245423235392/10935, -929182982866452021632/3645, -831695593543472461312/10935, 446328437134454720512/1215, 43036026454399236890624/76545, 7200286503880328609792/25515, -536406031325016358912/13365, -2685199452325342609408/31185, -462559456349604806656/21483]
]

'''

Stirling_poly_LC1_table = [
    [1],
    [1, fr(-1,3)],
    [1, -1, 0],
    [1, -2, fr(1,3), fr(2,15)],
    [1, -fr(10,3), fr(5,3), fr(2,3), 0],
    [1, -5, 5, fr(13,9), -fr(2,3), -fr(16,63)],
    [1, -7, fr(35,3), fr(7,9), -fr(14,3), -fr(16,9), 0],
    [1, -fr(28,3), fr(70,3), -fr(56,9), -fr(469,27), -4, fr(404,135), fr(16,15)],
    [1, -12, 42, -fr(448,15), -fr(133,3), fr(20,3), fr(404,15), fr(48,5), 0],
    [1, -15, 70, -fr(266,3), -fr(245,3), fr(745,9), fr(1072,9), fr(188,9), -fr(208,9), -fr(256,33)],
    [1, -fr(55,3), 110, -fr(638,3), -fr(847,9), fr(3179,9), fr(968,3), -fr(1100,9), -fr(2288,9), -fr(256,3), 0],
    [1, -22, 165, -fr(1342,3), fr(77,3), fr(3146,3), fr(12661,27), -fr(10582,9), -fr(34892,27), -fr(2488,15), fr(255968,945), fr(353792,4095)],
    [1, -26, fr(715,3), -858, fr(1573,3), fr(154726,63), -fr(55627,135), -fr(237094,45), -fr(96668,27), fr(34216,15), fr(3327584,945), fr(353792,315), 0],
    [1, -fr(91,3), fr(1001,3), -fr(23023,15), fr(17017,9), fr(42185,9), -fr(713713,135), -fr(6565559,405), -fr(22022,9), fr(8790964,405), fr(903656,45), fr(712672,405), -fr(603392,135), -fr(4096,3)],
    [1, -35, 455, -fr(23387,9), 5005, fr(63635,9), -fr(566137,27), -fr(986843,27), fr(778778,27), fr(2802436,27), fr(1477736,27), -fr(1410080,27), -fr(603392,9), -20480, 0],
    [1, -40, fr(1820,3), -fr(37856,9), fr(34034,3), 6864, -fr(1622764,27), -fr(1487200,27), fr(14343329,81), fr(26575640,81), -fr(2983864,81), -fr(41901760,81), -fr(170600624,405), -fr(8787584,405), fr(13321472,135), fr(7407616,255)],
    [1, -fr(136,3), fr(2380,3), -fr(59024,9), fr(628082,27), -fr(28288,9), -fr(1273844,9), -fr(1127984,81), fr(52234897,81), fr(272022712,405), -fr(453143704,405), -fr(1066552256,405), -fr(438371248,405), fr(602636672,405), fr(226465024,135), fr(7407616,15), 0],
    [1, -51, 1020, -fr(29716,3), fr(133042,3), -fr(116246,3), -fr(12825956,45), fr(11678524,45), fr(5321459,3), fr(500676163,1215), -fr(833643824,135), -fr(3405549208,405), fr(144415952,45), fr(6305863312,405), fr(103066240,9), fr(1825965824,8505), -fr(2653554688,945), -fr(2874867712,3591)],
    [1, -57, 1292, -fr(218348,15), fr(239666,3), -fr(1178950,9), -fr(22153924,45), fr(52588276,45), fr(104525707,27), -fr(4279960919,1215), -fr(6998960384,315), -fr(39540256888,2835), fr(6179837552,135), fr(6792927728,81), fr(395207296,15), -fr(444120132352,8505), -fr(50417539072,945), -fr(2874867712,189), 0],
    [1, -fr(190,3), 1615, -fr(62662,3), fr(1237090,9), -fr(21195260,63), -fr(6306898,9), fr(94712644,27), fr(174548231,27), -fr(4848845638,243), -fr(301489295939,5103), fr(1348108330,63), fr(60325596296,243), fr(7156486192,27), -fr(44013566576,243), -fr(24636553013024,42525), -fr(9986974905344,25515), fr(12794412544,2835), fr(624182448128,6237), fr(22886612992,825)],
    [1, -70, 1995, -fr(88046,3), fr(682822,3), -fr(2257124,3), -fr(18535678,27), fr(77552300,9), fr(169509431,27), -fr(183313500734,2673), -fr(27364870403,243), fr(21436582990,81), fr(361780571224,405), fr(108707345104,405), -fr(865729339216,405), -fr(19921376143712,6075), -fr(911817872384,1215), fr(300281183744,135), fr(624182448128,297), fr(160206290944,275), 0],
    [1, -77, fr(7315,3), -fr(121429,3), fr(1094324,3), -fr(13849594,9), fr(3204806,27), fr(165377938,9), -fr(193670477,27), -fr(223439442863,1215), -fr(124651224269,1215), fr(4345353851377,3645), fr(8184850095202,3645), -fr(2841293709496,1215), -fr(14203922012896,1215), -fr(6763266942608,675), fr(21226516994848,2025), fr(95336230592768,3645), fr(59866981027328,3645), -fr(1328300302336,2025), -fr(8842115842048,2025), -fr(81456529408,69)],
    [1, -fr(253,3), fr(8855,3), -54901, fr(5114648,9), -fr(26544254,9), fr(398298406,135), fr(14049293918,405), -fr(1613705093,27), -fr(495348492149,1215), fr(1053110085989,3645), fr(13891955119571,3645), fr(11497320849278,3645), -fr(21356249295656,1215), -fr(3398129675776,81), fr(425610933968,6075), fr(2108758776387296,18225), fr(563409841654528,3645), fr(84882896003584,3645), -fr(229527120306176,2025), -fr(203368664367104,2025), -fr(81456529408,3), 0],
    [1, -92, 3542, -fr(3301144,45), fr(2590973,3), -fr(48358420,9), fr(1383992984,135), fr(7800568864,135), -fr(5559261851,27), -fr(904997303228,1215), fr(2370044584882,1215), fr(11576836719896,1215), -fr(8660399429605,2187), -fr(53868141351244,729), -fr(1043579237620084,10935), fr(1147019165375248,6075), fr(11729611741956592,18225), fr(2695859041327936,6075), -fr(183481793736874432,273375), -fr(25694888556475136,18225), -fr(63533089962165248,76545), fr(2361975286509568,42525), fr(632800778428448768,2764125), fr(247845713084416,4095)],
    [1, -100, fr(12650,3), -fr(870320,9), 1283975, -fr(84527300,9), fr(716627560,27), fr(2214681040,27), -fr(44230817345,81), -fr(250683135940,243), fr(1673183227090,243), fr(174509138568400,9477), -fr(100563289259245,2187), -fr(164998917739180,729), -fr(97940121802820,2187), fr(10480420892268976,8505), fr(11651990822978704,5103), -fr(3615371095534528,5103), -fr(79364611224029632,10935), -fr(31518392110776064,3645), -fr(10172029287764992,15309), fr(11599145721376768,1701), fr(632800778428448768,110565), fr(1239228565422080,819), 0],
    [1, -fr(325,3), fr(14950,3), -fr(1133210,9), fr(50535485,27), -fr(142693265,9), fr(1613517620,27), fr(7061483000,81), -fr(100747677745,81), -fr(152351666155,243), fr(96050480545630,5103), fr(116979885621650,5103), -fr(424279898878381,2187), -fr(3389241749938343,6561), fr(64414364995552,81), fr(1154375511094074412,229635), fr(7391134409360416,1701), -fr(236011635183417808,15309), -fr(449897968546713856,10935), -fr(147513735615168832,6561), fr(1237348698950184704,25515), fr(4110145412772545536,45927), fr(181224695525076992,3645), -fr(117726690384969728,25515), -fr(40263682362966016,2835), -fr(11038250500096,3)],
    [1, -117, 5850, -162110, 2680535, -fr(181832365,7), fr(369880940,3), fr(64595960,3), -2526823585, fr(178866358853,81), fr(8172957845026,189), -fr(1608219029086,189), -fr(144630772253653,243), -fr(180440059226303,243), fr(1155354063644872,243), fr(125175738808934476,8505), -fr(17561288034319744,2835), -fr(53949151285311568,567), -fr(1212095493969073792,8505), fr(112570052014533568,1215), fr(4463673164361518848,8505), fr(963645737618596864,1701), fr(2971311818641408,945), -fr(64616914721275904,135), -fr(40263682362966016,105), -99344254500864, 0],
    [1, -126, 6825, -206570, 3777865, -fr(124381010,3), 238955717, -228526298, -fr(41733676985,9), fr(924624187214,81), fr(2296096638329,27), -fr(13478582967982,81), -fr(357777750735607,243), fr(70729628110922,243), fr(12913917329531855,729), fr(104802385437967594,3645), -fr(344011076505792124,3645), -fr(277663272636995960,729), -fr(233158583558413552,1215), fr(1651582935780852256,1215), fr(11042922668479452608,3645), fr(23084291808336423808,18225), -fr(72339211676537078272,18225), -fr(24093623499674519552,3645), -fr(4232251515232608256,1215), fr(831206463984959488,2025), fr(694578666150035456,675), fr(113842810733461504,435)],
    [1, -fr(406,3), 7917, -fr(1303666,5), fr(15741635,3), -fr(193985350,3), fr(1323792899,3), -fr(8017536098,9), -fr(68926602745,9), fr(2824767607298,81), fr(33986618341429,243), -fr(53627941515806,81), -fr(720195712497967,243), fr(4825059709119130,729), fr(36732801247661491,729), fr(5011226820134786,405), -fr(1735889646220966028,3645), -fr(3817889148088071992,3645), fr(7234028825581556752,6075), fr(5971848966262026848,729), fr(7350260643188186048,729), -fr(64233680599432612736,6075), -fr(792059360954282392064,18225), -fr(156631919103241578496,3645), fr(3370559219063922688,1215), fr(78555573347487383552,2025), fr(20142781318351028224,675), fr(113842810733461504,15), 0],
    [1, -145, 9135, -326221, 7191275, -98783425, fr(7051300555,9), -2394019745, -fr(99806201495,9), fr(7026553304225,81), fr(13897873900885,81), -fr(17230507031375,9), -fr(1092273013558325,243), fr(6975594047253295,243), fr(27224761515905635,243), -fr(2089848657020357789,10935), -fr(1214771376701934662,729), -fr(3267778959029798044,2187), fr(12977485945013632952,1215), fr(352129764279423820144,10935), fr(3883781414076568160,729), -fr(1444288511245423235392,10935), -fr(929182982866452021632,3645), -fr(831695593543472461312,10935), fr(446328437134454720512,1215), fr(43036026454399236890624,76545), fr(7200286503880328609792,25515), -fr(536406031325016358912,13365), -fr(2685199452325342609408,31185), -fr(462559456349604806656,21483)]
]



_Stirling_poly_LC1_table = lambda L: Stirling_poly_LC1_table_least_len(L)[:L]
'''
print(list(map(factor_poly_by_coeffs, _Stirling_poly_LC1_table(30))))
[1,
(3*x - 1)/3,
x*(x - 1),
(15*x**3 - 30*x**2 + 5*x + 2)/15,
x*(x - 1)*(3*x**2 - 7*x - 2)/3,
(63*x**5 - 315*x**4 + 315*x**3 + 91*x**2 - 42*x - 16)/63,
x*(x - 1)*(9*x**4 - 54*x**3 + 51*x**2 + 58*x + 16)/9,
(135*x**7 - 1260*x**6 + 3150*x**5 - 840*x**4 - 2345*x**3 - 540*x**2 + 404*x + 144)/135,
x*(x - 1)*(15*x**6 - 165*x**5 + 465*x**4 + 17*x**3 - 648*x**2 - 548*x - 144)/15,
(99*x**9 - 1485*x**8 + 6930*x**7 - 8778*x**6 - 8085*x**5 + 8195*x**4 + 11792*x**3 + 2068*x**2 - 2288*x - 768)/99,
x*(x - 1)*(9*x**8 - 156*x**7 + 834*x**6 - 1080*x**5 - 1927*x**4 + 1252*x**3 + 4156*x**2 + 3056*x + 768)/9,
(12285*x**11 - 270270*x**10 + 2027025*x**9 - 5495490*x**8 + 315315*x**7 + 12882870*x**6 + 5760755*x**5 - 14444430*x**4 - 15875860*x**3 - 2037672*x**2 + 3327584*x + 1061376)/12285,
x*(x - 1)*(945*x**10 - 23625*x**9 + 201600*x**8 - 609210*x**7 - 113715*x**6 + 2207175*x**5 + 1817786*x**4 - 3161188*x**3 - 6544568*x**2 - 4388960*x - 1061376)/945,
(405*x**13 - 12285*x**12 + 135135*x**11 - 621621*x**10 + 765765*x**9 + 1898325*x**8 - 2141139*x**7 - 6565559*x**6 - 990990*x**5 + 8790964*x**4 + 8132904*x**3 + 712672*x**2 - 1810176*x - 552960)/405,
x*(x - 1)*(27*x**12 - 918*x**11 + 11367*x**10 - 58794*x**9 + 76341*x**8 + 267246*x**7 - 298891*x**6 - 1285734*x**5 - 506956*x**4 + 2295480*x**3 + 3773216*x**2 + 2363136*x + 552960)/27,
(6885*x**15 - 275400*x**14 + 4176900*x**13 - 28959840*x**12 + 78108030*x**11 + 47258640*x**10 - 413804820*x**9 - 379236000*x**8 + 1219182965*x**7 + 2258929400*x**6 - 253628440*x**5 - 3561649600*x**4 - 2900210608*x**3 - 149388928*x**2 + 679395072*x + 200005632)/6885,
x*(x - 1)*(405*x**14 - 17955*x**13 + 303345*x**12 - 2352735*x**11 + 7068495*x**10 + 5795535*x**9 - 51527445*x**8 - 57167365*x**7 + 204007120*x**6 + 476029832*x**5 + 22886128*x**4 - 1043666128*x**3 - 1482037376*x**2 - 879400704*x - 200005632)/405,
(161595*x**17 - 8241345*x**16 + 164826900*x**15 - 1600652340*x**14 + 7166307330*x**13 - 6261590790*x**12 - 46058007996*x**11 + 41937579684*x**10 + 286640389035*x**9 + 66589929679*x**8 - 997871657328*x**7 - 1358814133992*x**6 + 518597683632*x**5 + 2516039461488*x**4 + 1850554339200*x**3 + 34693350656*x**2 - 453757851648*x - 129369047040)/161595,
x*(x - 1)*(8505*x**16 - 476280*x**15 + 10512180*x**14 - 113291136*x**13 + 566161974*x**12 - 547945776*x**11 - 4735037412*x**10 + 5204146752*x**9 + 38129744457*x**8 + 8170018024*x**7 - 180801912344*x**6 - 299422683008*x**5 + 89907082768*x**4 + 803164494208*x**3 + 1027247031040*x**2 + 583126898688*x + 129369047040)/8505,
(1403325*x**19 - 88877250*x**18 + 2266369875*x**17 - 29311717050*x**16 + 192893258250*x**15 - 472124416500*x**14 - 983403070650*x**13 + 4922689671900*x**12 + 9072144306225*x**11 - 28002083559450*x**10 - 82909556383225*x**9 + 30029113050750*x**8 + 348380318609400*x**7 + 371958369829200*x**6 - 254178346976400*x**5 - 813006249429792*x**4 - 549283619793920*x**3 + 6333234209280*x**2 + 140441050828800*x + 38930128699392)/1403325,
x*(x - 1)*(66825*x**18 - 4610925*x**17 + 128704950*x**16 - 1832519700*x**15 + 13377340350*x**14 - 36900096750*x**13 - 82775899800*x**12 + 493049927700*x**11 + 912585769425*x**10 - 3670251748925*x**9 - 11195591109750*x**8 + 6489589857000*x**7 + 66183384108960*x**6 + 84120096051120*x**5 - 58725244919520*x**4 - 277860382500352*x**3 - 328010365481472*x**2 - 179371179528192*x - 38930128699392)/66825,
(419175*x**21 - 32276475*x**20 + 1022088375*x**19 - 16966667025*x**18 + 152904420900*x**17 - 645044840550*x**16 + 49754613150*x**15 + 7702477462350*x**14 - 3006734155425*x**13 - 77086607787735*x**12 - 43004672372805*x**11 + 499715692908355*x**10 + 941257760948230*x**9 - 980246329776120*x**8 - 4900353094449120*x**7 - 4199988771359568*x**6 + 4393889017933536*x**5 + 10963666518168320*x**4 + 6884702818142720*x**3 - 274958162583552*x**2 - 1830317979303936*x - 494848416153600)/419175,
x*(x - 1)*(18225*x**20 - 1518750*x**19 + 52275375*x**18 - 948295350*x**17 + 9408866850*x**16 - 44343247500*x**15 + 9427037310*x**14 + 641645263620*x**13 - 447605674155*x**12 - 7877833056390*x**11 - 2612282626445*x**10 + 66847492971410*x**9 + 124334097217800*x**8 - 196009642217040*x**7 - 960588819266640*x**6 - 959311986464736*x**5 + 1149446789922560*x**4 + 3966495998195200*x**3 + 4390910478213120*x**2 + 2325166395457536*x + 494848416153600)/18225,
(24877125*x**23 - 2288695500*x**22 + 88114776750*x**21 - 1824954931800*x**20 + 21485319730875*x**19 - 133668717682500*x**18 + 255035307126600*x**17 + 1437449827413600*x**16 - 5122164887965125*x**15 - 18529819783593300*x**14 + 48526662875458950*x**13 + 237035731839870600*x**12 - 98512043511756875*x**11 - 1838250323611201500*x**10 - 2374142765585691100*x**9 + 4697043482211640560*x**8 + 16010920027770748080*x**7 + 11039542774237897920*x**6 - 16696843230055573312*x**5 - 35073522879588560640*x**4 - 20648254237703705600*x**3 + 1381755542608097280*x**2 + 5695207005856038912*x + 1505662706987827200)/24877125,
x*(x - 1)*(995085*x**22 - 98513415*x**21 + 4097428335*x**20 - 92129502465*x**19 + 1185534760410*x**18 - 8160226164090*x**17 + 18251082559710*x**16 + 99873152288910*x**15 - 443502438794415*x**14 - 1470049880468715*x**13 + 5381635434464835*x**12 + 23705094984146835*x**11 - 22051201628809640*x**10 - 247274724342790340*x**9 - 291837479763073440*x**8 + 934371764632396752*x**7 + 3206509975113244032*x**6 + 2501512611484011072*x**5 - 4720667009902685440*x**4 - 13325188056144550912*x**3 - 13986369959849275392*x**2 - 7200869712843866112*x - 1505662706987827200)/995085,
(229635*x**25 - 24877125*x**24 + 1144347750*x**23 - 28913853150*x**22 + 429804299925*x**21 - 3640818656475*x**20 + 13722967358100*x**19 + 20019304305000*x**18 - 285619666407075*x**17 - 143972324516475*x**16 + 4322271624553350*x**15 + 5264094852974250*x**14 - 44549389382230005*x**13 - 118623461247842005*x**12 + 182614724762389920*x**11 + 1154375511094074412*x**10 + 997803145263656160*x**9 - 3540174527751267120*x**8 - 9447857339480990976*x**7 - 5162980746530909120*x**6 + 11136138290551662336*x**5 + 20550727063862727680*x**4 + 11417155818079850496*x**3 - 1059540213464727552*x**2 - 3261358271400247296*x - 844922884529848320)/229635,
x*(x - 1)*(8505*x**24 - 986580*x**23 + 48767670*x**22 - 1329977880*x**21 + 21467972295*x**20 - 199458351180*x**19 + 849154113720*x**18 + 1032283660320*x**17 - 20458350930105*x**16 - 1677383250540*x**15 + 366105719775630*x**14 + 293735863466760*x**13 - 4768341165411095*x**12 - 11083743238331700*x**11 + 29353648989238820*x**10 + 154529387798173296*x**9 + 101845523695214064*x**8 - 707391745584459456*x**7 - 1919487239553533248*x**6 - 1131496875451798272*x**5 + 3332176288909720576*x**4 + 8150404977002704896*x**3 + 8177146783370477568*x**2 + 4106281155930095616*x + 844922884529848320)/8505,
(528525*x**27 - 66594150*x**26 + 3607183125*x**25 - 109177409250*x**24 + 1996696099125*x**23 - 21912824436750*x**22 + 126294070327425*x**21 - 120781861650450*x**20 - 2450810180944125*x**19 + 6033172821571350*x**18 + 44946091695290175*x**17 - 87947753866082550*x**16 - 778166607849945225*x**15 + 153836941141255350*x**14 + 9362590063910594875*x**13 + 15196345888505301130*x**12 - 49881606093339857980*x**11 - 201305872661822071000*x**10 - 101423983847909895120*x**9 + 718438577064670731360*x**8 + 1601223786929520628160*x**7 + 669444462441756290432*x**6 - 2097837138619575269888*x**5 - 3493575407452805335040*x**4 - 1841029409126184591360*x**3 + 216944887100074426368*x**2 + 543855095595477762048*x + 138319015041155727360)/528525,
x*(x - 1)*(18225*x**26 - 2448225*x**25 + 141839100*x**24 - 4610023470*x**23 + 91020409155*x**22 - 1087440592095*x**21 + 6954601269330*x**20 - 9280909329120*x**19 - 148857279887745*x**18 + 486715431754305*x**17 + 3035711807361480*x**16 - 9030575033694870*x**15 - 63045253471042395*x**14 + 57581239256935855*x**13 + 975901270448473130*x**12 + 1201406477354538500*x**11 - 7478041753750291640*x**10 - 26567487494190651600*x**9 - 4865401017445981344*x**8 + 144430823139104689856*x**7 + 328187339218809341056*x**6 + 135486297420511502848*x**5 - 656573063533770889216*x**4 - 1439732659049978781696*x**3 - 1389174270764019941376*x**2 - 682174110636633489408*x - 138319015041155727360)/18225,
(26101845*x**29 - 3784767525*x**28 + 238440354075*x**27 - 8514969977745*x**26 + 187705545402375*x**25 - 2578429647919125*x**24 + 20450217126113775*x**23 - 62488332310929525*x**22 - 289458444606806475*x**21 + 2264271669519985125*x**20 + 4478520375190686825*x**19 - 49972002644928931875*x**18 - 117326505751367479875*x**17 + 749283434585712682425*x**16 + 2924347758231003783525*x**15 - 4988468744307594042343*x**14 - 43494889142812770572910*x**13 - 39000941876020639655140*x**12 + 278795330556727876707816*x**11 + 840533747334984658683728*x**10 + 139058793531011522968800*x**9 - 3447516676342825262880704*x**8 - 6653879340306662926906752*x**7 - 1985257381788268765151744*x**6 + 9588473814959490760759296*x**5 + 14675285020950139779702784*x**4 + 7365893093469576167817216*x**3 - 1047600979177756948955136*x**2 - 2247511941596311764074496*x - 562009739464769840087040)/26101845
]
'''


'''
from Pascal_numbers_like_table import _big_primes
print(_big_primes(_Stirling_poly_LC1_table(30)))
n = 8:
    Stirling_poly_LC1 101



0 []
1 [3]
2 []
3 [5]
4 [5]
5 [7, 13]
6 [7]
7 [67, 101]
8 [19, 101]
9 [11, 13, 19, 47, 67, 149]
10 [11, 13, 17, 29]
11 [13, 19, 37, 61, 311, 421, 691, 1151]
12 [13, 19, 47, 389, 421, 541, 691, 829]
13 [17, 23, 31, 59, 937, 2357, 8689, 22271, 24151]
14 [37, 67, 89, 103, 107, 257, 389, 1093, 1259, 2357, 7699]
15 [17, 23, 37, 59, 89, 127, 149, 1423, 2207, 2837, 3061, 3539, 3617, 5281]
16 [17, 29, 31, 53, 73, 131, 439, 1061, 1481, 2903, 3061, 3511, 3617, 21487]
17 [19, 23, 43, 59, 199, 263, 281, 757, 839, 1163, 1201, 1319, 1741, 6133, 8999, 9473, 11003, 43867, 119237, 1295681]
18 [19, 31, 53, 73, 79, 101, 383, 631, 821, 1319, 1601, 11131, 43867, 170827, 1019281, 1295681, 1391087]
19 [59, 97, 149, 193, 283, 359, 383, 401, 617, 751, 3389, 3779, 5639, 8317, 81457, 82483, 417371, 4609333, 5523097, 24989087, 152388293, 513310799]
20 [53, 73, 79, 89, 101, 151, 157, 283, 313, 331, 617, 757, 1747, 1999, 4099, 5851, 70039, 100237, 125221, 133979, 3118319, 6516997, 46865639, 152388293, 368150801]
21 [23, 37, 41, 47, 83, 131, 593, 599, 1277, 1949, 3967, 4591, 9157, 17053, 29453, 68669, 156899, 225943, 290351, 2698721, 6856723, 7601791, 23163719, 99961079, 174715687, 269839961]
22 [23, 29, 31, 67, 109, 113, 131, 241, 251, 337, 373, 541, 593, 1283, 1669, 1931, 2437, 5647, 8677, 60383, 132947, 1002523, 1360769, 4336889, 5533739, 269839961, 1029732337, 1869962999]
23 [29, 31, 37, 43, 53, 59, 71, 73, 83, 103, 127, 157, 233, 503, 887, 1093, 3877, 5233, 7937, 30869, 34313, 61169, 63299, 129341, 2294797, 12270233, 27827329, 30454883, 164796869, 281384843, 339872327, 410787841, 502749889, 1480649647, 33844137307]
24 [29, 37, 43, 53, 103, 257, 283, 439, 443, 751, 757, 887, 1483, 2711, 3449, 3727, 6571, 15187, 21347, 238897, 554663, 623881, 1687193, 2294797, 58725649, 59924939, 97205287, 410787841, 535327549, 548293331, 2707316981, 4698796337, 6034630207]
25 [31, 43, 47, 67, 79, 101, 113, 131, 223, 277, 379, 439, 593, 739, 1291, 1459, 2297, 2467, 3217, 3727, 4027, 6163, 8677, 14983, 21019, 23053, 23063, 24697, 101833, 103349, 108677, 193393, 657931, 669481, 24145861, 42494429, 129505699, 171559939, 947700731, 4136643227, 7186017611, 194994212579]
26 [29, 37, 43, 53, 149, 163, 179, 181, 191, 239, 263, 337, 491, 593, 661, 1061, 1459, 5059, 5623, 8087, 11057, 12347, 20551, 23549, 36997, 82531, 378509, 598007, 657931, 953651, 1075007, 3581717, 6514769, 129505699, 213625631, 1271370719, 1428741571, 2781200551, 65947084043, 58315128087917]
27 [29, 37, 53, 71, 89, 97, 107, 137, 227, 307, 349, 353, 367, 461, 709, 1031, 1301, 1753, 2447, 2749, 3181, 3469, 4229, 5333, 9349, 19081, 25867, 63389, 136999, 151337, 308107, 362903, 1185497, 1828829, 4601897, 6145159, 124208107, 177783439, 202935373, 677919937, 3820465189, 21313158833, 2110544790491, 5462076112643, 1261161047221177, 11764464599450449]
28 [29, 31, 41, 53, 61, 97, 251, 331, 367, 701, 733, 1031, 1193, 1559, 1877, 2221, 3623, 3671, 4637, 5333, 9349, 10477, 11617, 13879, 21649, 22039, 53189, 65011, 71947, 362903, 3242377, 3545567, 3685879, 5255053, 9650681, 36612269, 124208107, 302262073, 489538501, 2038275553, 40015254707, 1289796919031, 1682013093697, 3626982196193, 55038189771769]
29 [31, 47, 59, 61, 71, 89, 109, 113, 223, 271, 431, 577, 643, 733, 1069, 1409, 1429, 1607, 1721, 2441, 3229, 4271, 36899, 55219, 59707, 60493, 108457, 114661, 119923, 162641, 309493, 351469, 804943, 3573239, 16871573, 53474171, 56537191, 66405473, 304419637, 1001259881, 1549410739, 5032190257, 203662941239, 277341640141, 2994601939151, 31053604565369, 111056470564951, 129962833517849, 164905599070493]

'''


