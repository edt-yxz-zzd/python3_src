#__all__:goto
r'''[[[
e ../../python3_src/nn_ns/CJK/unicode/ucd_unihan/xml/resource_loader.py


nn_ns.CJK.unicode.ucd_unihan.xml.resource_loader
py -m nn_ns.app.debug_cmd   nn_ns.CJK.unicode.ucd_unihan.xml.resource_loader -x
[[[
py -m nn_ns.app.doctest_cmd nn_ns.CJK.unicode.ucd_unihan.xml.resource_loader:__doc__ -ht
change:
    seed.pkg_tools.load_data5attr._DEBUGGING_VERBOSE_ = True
        to print_err...
===
ls ../../python3_src/nn_ns/CJK/unicode/ucd_unihan/xml/__pycache__/
rm ../../python3_src/nn_ns/CJK/unicode/ucd_unihan/xml/__pycache__/*.dump
    EOFError: Ran out of input
        <<== if prev dump fail:leaving the dump file in broken state
    or:to test "dump@no_dump_file"
===
ls ../../python3_src/nn_ns/CJK/unicode/ucd_unihan/xml/__pycache__/ver14_0_0.version.pickle.dump
touch ../../python3_src/nn_ns/CJK/unicode/ucd_unihan/xml/ver14_0_0/version._.ver14_0_0.xml.out.txt
    to test "remove_then_redump@dump_file_outdated"
===
]]]




>>> ver1___data_loader4depth2__literal_eval__u8
nn_ns.CJK.unicode.ucd_unihan.xml.resource_loader.ver1___data_loader4depth2__literal_eval__u8
>>> ver1___data_loader4depth2__literal_eval__u8.ver14_0_0
nn_ns.CJK.unicode.ucd_unihan.xml.resource_loader.ver1___data_loader4depth2__literal_eval__u8.ver14_0_0
>>> ver1___data_loader4depth2__literal_eval__u8.ver14_0_0.version
RecurView4Seq(None, ({'3.2.0': {63825: 1}, '4.0.0': {194664: 1, 194676: 1, 194847: 1, 194911: 1, 195007: 1}}, TouchRangeBasedIntMapping((((63825, 63826), (194664, 194665), (194676, 194677), (194847, 194848), (194911, 194912), (195007, 195008)), ('3.2.0', '4.0.0', '4.0.0', '4.0.0', '4.0.0', '4.0.0')))))
>>> ver1___data_loader4depth2__literal_eval__u8.ver14_0_0.version[1]
RecurView4IRangeBasedIntMapping(None, TouchRangeBasedIntMapping((((63825, 63826), (194664, 194665), (194676, 194677), (194847, 194848), (194911, 194912), (195007, 195008)), ('3.2.0', '4.0.0', '4.0.0', '4.0.0', '4.0.0', '4.0.0'))))
>>> ver1___data_loader4depth2__literal_eval__u8.ver14_0_0.version[1][194911]
'4.0.0'
>>> ver1___data_loader4depth2__literal_eval__u8.ver14_0_0.version[0]
RecurView4Mapping(None, {'3.2.0': {63825: 1}, '4.0.0': {194664: 1, 194676: 1, 194847: 1, 194911: 1, 195007: 1}})
>>> ver1___data_loader4depth2__literal_eval__u8.ver14_0_0.type
RecurView4Seq(None, ({'abbreviation': {0: 33, 127: 34, 173: 1, 847: 1, 1564: 1, 6155: 5, 8203: 5, 8234: 6, 8287: 2, 8294: 4, 65024: 16, 65279: 1, 917760: 240}, 'alternate': {65279: 1}, 'control': {0: 32, 127: 1, 130: 23, 154: 6}, 'correction': {418: 2, 1801: 1, 3294: 1, 3741: 1, 3743: 1, 3747: 1, 3749: 1, 4048: 1, 4588: 4, 8472: 1, 9288: 2, 11130: 1, 11132: 1, 40981: 1, 43630: 1, 65048: 1, 74452: 2, 93782: 2, 93814: 2, 110593: 1, 118981: 1}, 'figment': {128: 2, 153: 1}}, None))

"type":_add_i2v
Traceback (most recent call last):
    ...
KeyError: 'stack_styple-int-mapping: __setitem__(i, v) but i < end'

>>> ver1___data_loader4depth2__literal_eval__u8.ver14_0_0.version is ver1___data_loader4depth2__literal_eval__u8.ver14_0_0.version
True
>>> ver1___data_loader4depth2__literal_eval__u8.ver14_0_0.type is ver1___data_loader4depth2__literal_eval__u8.ver14_0_0.type
True
>>> ver1___data_loader4depth2__literal_eval__u8.ver14_0_0.type is ver1___data_loader4depth2__literal_eval__u8.ver14_0_0.version
False






######################
#ver1:above:
######################
######################
######################
######################
######################
#ver2:below:
######################


>>> ver2___data_loader4depth2__literal_eval__u8
nn_ns.CJK.unicode.ucd_unihan.xml.resource_loader.ver2___data_loader4depth2__literal_eval__u8
>>> ver2___data_loader4depth2__literal_eval__u8.ver14_0_0
nn_ns.CJK.unicode.ucd_unihan.xml.resource_loader.ver2___data_loader4depth2__literal_eval__u8.ver14_0_0
>>> ver2___data_loader4depth2__literal_eval__u8.ver14_0_0.version
RecurView4Seq(None, ({'3.2.0': {63825: 1}, '4.0.0': {194664: 1, 194676: 1, 194847: 1, 194911: 1, 195007: 1}}, TouchRangeBasedIntMapping((((63825, 63826), (194664, 194665), (194676, 194677), (194847, 194848), (194911, 194912), (195007, 195008)), ('3.2.0', '4.0.0', '4.0.0', '4.0.0', '4.0.0', '4.0.0')))))
>>> ver2___data_loader4depth2__literal_eval__u8.ver14_0_0.version[1]
RecurView4IRangeBasedIntMapping(None, TouchRangeBasedIntMapping((((63825, 63826), (194664, 194665), (194676, 194677), (194847, 194848), (194911, 194912), (195007, 195008)), ('3.2.0', '4.0.0', '4.0.0', '4.0.0', '4.0.0', '4.0.0'))))
>>> ver2___data_loader4depth2__literal_eval__u8.ver14_0_0.version[1][194911]
'4.0.0'
>>> ver2___data_loader4depth2__literal_eval__u8.ver14_0_0.version[0]
RecurView4Mapping(None, {'3.2.0': {63825: 1}, '4.0.0': {194664: 1, 194676: 1, 194847: 1, 194911: 1, 195007: 1}})
>>> ver2___data_loader4depth2__literal_eval__u8.ver14_0_0.type
RecurView4Seq(None, ({'abbreviation': {0: 33, 127: 34, 173: 1, 847: 1, 1564: 1, 6155: 5, 8203: 5, 8234: 6, 8287: 2, 8294: 4, 65024: 16, 65279: 1, 917760: 240}, 'alternate': {65279: 1}, 'control': {0: 32, 127: 1, 130: 23, 154: 6}, 'correction': {418: 2, 1801: 1, 3294: 1, 3741: 1, 3743: 1, 3747: 1, 3749: 1, 4048: 1, 4588: 4, 8472: 1, 9288: 2, 11130: 1, 11132: 1, 40981: 1, 43630: 1, 65048: 1, 74452: 2, 93782: 2, 93814: 2, 110593: 1, 118981: 1}, 'figment': {128: 2, 153: 1}}, None))

"type":_add_i2v
Traceback (most recent call last):
    ...
KeyError: 'stack_styple-int-mapping: __setitem__(i, v) but i < end'

>>> ver2___data_loader4depth2__literal_eval__u8.ver14_0_0.version is ver2___data_loader4depth2__literal_eval__u8.ver14_0_0.version
True
>>> ver2___data_loader4depth2__literal_eval__u8.ver14_0_0.type is ver2___data_loader4depth2__literal_eval__u8.ver14_0_0.type
True
>>> ver2___data_loader4depth2__literal_eval__u8.ver14_0_0.type is ver2___data_loader4depth2__literal_eval__u8.ver14_0_0.version
False





#]]]'''
__all__ = r'''
data_loader4depth2__literal_eval__u8

ver1___data_loader4depth2__literal_eval__u8
ver2___data_loader4depth2__literal_eval__u8
'''.split()#'''
__all__
from ast import literal_eval
from pathlib import Path
from seed.pkg_tools.load_data5attr import mk_data_loader5attr__ver1_params
from seed.pkg_tools.load_data5attr import rootdir_5or_qnm4pkg, dir5qnm4pkg
from seed.pkg_tools.load_data5attr import mk_data_loader5attr__ver2_IDataLoaderMaker
from seed.pkg_tools.load_data5attr import Maker4DataLoader__details__mixins__fmtr, Formatter__glob

from seed.data_funcs.rngs import TouchRangeBasedIntMapping
    #TouchRangeBasedIntMapping.from_value2begin2sz/.from_rng_value_pairs/.from_clone_of_rngs_with_default
from seed.tiny import print_err

def _property_alias2basename4file(qnm4pkg, ver_pa, /):
    '!!+extended'
    ver, _, pa = ver_pa.rpartition('.')
    #fail:paths = [*_dir.glob(ver_pa.replace('.', '_')+'.*.out.txt')]
    paths = [*(_dir/ver).glob(pa+'.*.out.txt')]
    if not paths:raise LookupError(ver_pa)
    if not len(paths) == 1:raise LookupError(ver_pa, paths)
    [path4datafile] = paths
    basename4datafile = path4datafile.name
    qnm4new_pkg = '.'.join([qnm4pkg, ver])
    return (qnm4new_pkg, basename4datafile)

def _v2i2sz__Z__i2v_(v2i2sz, /):
    i2v = TouchRangeBasedIntMapping.from_value2begin2sz(v2i2sz)
    return i2v
def _add_i2v(v2i2sz, /):
    i2v = _v2i2sz__Z__i2v_(v2i2sz)
    return (v2i2sz, i2v)
#++kw:extended_transformer=True
def _add_may_i2v(qnm4pkg, qattr, qnm4new_pkg, bnm, v2i2sz, /):
    '-> (v2i2sz, may_i2v)'
    try:
        i2v = _v2i2sz__Z__i2v_(v2i2sz)
    except KeyError:
        #KeyError: 'stack_styple-int-mapping: __setitem__(i, v) but i < end'
        #print_err(__name__, (qnm4pkg, qattr, qnm4new_pkg, bnm))
        assert qattr.removeprefix('ver14_0_0.') in 'alias;type', qattr
        _skip_qattrs.append(qattr)
        return (v2i2sz, None)
    return (v2i2sz, i2v)
_skip_qattrs = []

_dir = dir5qnm4pkg(__package__)
ver1___data_loader4depth2__literal_eval__u8 = mk_data_loader5attr__ver1_params('nn_ns.CJK.unicode.ucd_unihan.xml.resource_loader.ver1___data_loader4depth2__literal_eval__u8', __package__, _property_alias2basename4file, xencoding='u8', extended=True, extended_transformer=True, parser='literal_eval', imay_max_depth=2, transformer=_add_may_i2v)



######################
#ver1:above:
######################
######################
######################
######################
######################
#ver2:below:
######################

def _mk__fmtr4relpath4data_file(sf, /):
    qnm4pkg4root = sf.qnm4pkg4root
    qattr4data = sf.qattr4data
    def fmt_args5arg(qattr4data, /):
        return [qattr4data.replace('.', '/')]

    rootdir = rootdir_5or_qnm4pkg(qnm4pkg4root)
    fmt4glob_pattern = '{}.*.out.txt'
    fmtr = Formatter__glob(rootdir, fmt4glob_pattern, fmt_args5arg)
    return fmtr
def _mk__fmtr4smay_relpath4dump_file(sf, /):
    fmtr4smay_relpath4dump_file = '__pycache__/{}.pickle.dump'
    return fmtr4smay_relpath4dump_file
    #bug:
    #   when dump data:ofile not exist:hence ^FileNotFoundError
    #
    qnm4pkg4root = sf.qnm4pkg4root
    qattr4data = sf.qattr4data
    def fmt_args5arg(qattr4data, /):
        return [qattr4data]
        return ('__pycache__', qattr4data.replace('.', '/'))

    rootdir = rootdir_5or_qnm4pkg(qnm4pkg4root)
    fmt4glob_pattern = '__pycache__/{}.pickle.dump'
    fmtr = Formatter__glob(rootdir, fmt4glob_pattern, fmt_args5arg)
    return fmtr
def _transformer(sf, raw_data, /):
    #_add_may_i2v
    '-> (v2i2sz, may_i2v)'
    '-> data'
    v2i2sz = raw_data
    qattr = sf.qattr4data
    (v2i2sz, may_i2v) = _add_may_i2v(qnm4pkg:=None, qattr, qnm4new_pkg:=None, bnm:=None, v2i2sz)
    data = (v2i2sz, may_i2v)
    return data


#def mk_data_loader5attr__ver2_IDataLoaderMaker(qnm4data_loader, qnm4pkg4root, mkr4data_loader:IDataLoaderMaker, /, *, viewer=None, no_cache=False, imay_max_depth=-1):
#class Maker4DataLoader__details__mixins__fmtr(IDataLoaderMaker):
#   def __init__(sf, /, *, mk__fmtr4relpath4data_file, mk__fmtr4smay_relpath4dump_file, source_parser_, transformer_, xencoding4data_file):
_mkr4data_loader = Maker4DataLoader__details__mixins__fmtr(
mk__fmtr4relpath4data_file
=_mk__fmtr4relpath4data_file
, mk__fmtr4smay_relpath4dump_file
=_mk__fmtr4smay_relpath4dump_file
, source_parser_
=lambda sf, ifile4data, /:literal_eval(ifile4data.read())
, transformer_
=_transformer
, xencoding4data_file
='u8'
)
ver2___data_loader4depth2__literal_eval__u8 = mk_data_loader5attr__ver2_IDataLoaderMaker('nn_ns.CJK.unicode.ucd_unihan.xml.resource_loader.ver2___data_loader4depth2__literal_eval__u8', __package__, _mkr4data_loader, imay_max_depth=2)




data_loader4depth2__literal_eval__u8 = ver1___data_loader4depth2__literal_eval__u8
data_loader4depth2__literal_eval__u8 = ver2___data_loader4depth2__literal_eval__u8

def __(ver, /):
    from seed.pkg_tools.load_resource import sorted_potential_basenames_under_pkg_
    x = getattr(data_loader4depth2__literal_eval__u8, ver)
    ls = []
    for bnm in sorted_potential_basenames_under_pkg_(f'{__package__}.{ver}'):
        attr, _, _ = bnm.partition('.')
        (v2i2sz, may_i2v) = getattr(x, attr)
        if may_i2v is None:
            ls.append(attr)
    for attr in ls:
        print_err(attr)
if 0b0000:
    __('ver14_0_0')
    r'''[[[
alias
    #qattr==ver14_0_0.alias
type
    #qattr==ver14_0_0.type



nn_ns.CJK.unicode.ucd_unihan.xml.resource_loader ('nn_ns.CJK.unicode.ucd_unihan.xml', 'ver14_0_0.alias', 'nn_ns.CJK.unicode.ucd_unihan.xml.ver14_0_0', 'alias._.ver14_0_0.xml.out.txt')
nn_ns.CJK.unicode.ucd_unihan.xml.resource_loader ('nn_ns.CJK.unicode.ucd_unihan.xml', 'ver14_0_0.type', 'nn_ns.CJK.unicode.ucd_unihan.xml.ver14_0_0', 'type._.ver14_0_0.xml.out.txt')
    #]]]'''#'''

__all__
from nn_ns.CJK.unicode.ucd_unihan.xml.resource_loader import data_loader4depth2__literal_eval__u8
from nn_ns.CJK.unicode.ucd_unihan.xml.resource_loader import *
