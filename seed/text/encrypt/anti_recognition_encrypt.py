#__all__:goto
#TODO:goto
#[:__cmds__]:goto
r'''[[[
e ../../python3_src/seed/text/encrypt/anti_recognition_encrypt.py

åŠ å¯†ç›®çš„:é˜²æœç´¢ï¼Œé˜²è¯†åˆ«
    ==>>è‡ªè§£å¯†#æ— éœ€è®°å¿†:åè®®+å¯†é’¥

[[
DONE:åŒºå†…å˜æ¢:å¢åŠ å…¶ä»–å…¨è§’å­—ç¬¦:
++å¢åŠ å…¨è§’æ ‡ç‚¹ç¬¦å·ä½œä¸ºä¸åŠ¨åŒº
    ++å¢åŠ asciiæ‹¬å·ä½œä¸åŠ¨åŒº
++å¢åŠ å…¨è§’æ•°å­—å¤§å†™å­—æ¯åŒº#ä¸‹åˆ’çº¿ï¼Ÿ
++å¢åŠ å…¨è§’å°å†™å­—æ¯åŒº
view /sdcard/0my_files/git_repos/python3_src/nn_ns/CJK/CJK_data/raw/U+FF00å…¨è§’å­—ç¬¦.txt
  # [:å…¨è§’å­—ç¬¦ç‰œæ•°å­—è¾»è‹±æ–‡å­—æ¯è¾»æ ‡ç‚¹ç¬¦å·åªä¿ç•™éƒ¨åˆ†]:goto
    #å…±225å­—ç¬¦:éƒ¨åˆ†æ ‡ç‚¹ç¬¦åˆ162+å…¨è§’ç©ºæ ¼1+å…¨è§’æ•°å­—10+å…¨è§’å¤§å°å†™å­—æ¯26*2
    #å”¯ä¸€ä¸€ä¸ªé«˜ä½é¢å­—ç¬¦ã€W.Po@0x16FE2:ğ–¿¢:OLD CHINESE HOOK MARKã€
    #ä¸å«ã€ã€‡ã€
    r'ï¼ï¼‚ï¼ƒï¼„ï¼…ï¼†ï¼‡ï¼ˆï¼‰ï¼Šï¼‹ï¼Œï¼ï¼ï¼ï¼šï¼›ï¼œï¼ï¼ï¼Ÿï¼ ï¼»ï¼¼ï¼½ï¼¾ï¼¿ï½€ï½›ï½œï½ï½ï½Ÿï½ ï¿ ï¿¡ï¿¢ï¿£ï¿¤ï¿¥ï¿¦âŒ©âŒªâ¿°â¿±â¿²â¿³â¿´â¿µâ¿¶â¿·â¿¸â¿¹â¿ºâ¿»ã€ã€‚ã€ƒã€„ã€ˆã€‰ã€Šã€‹ã€Œã€ã€ã€ã€ã€‘ã€’ã€“ã€”ã€•ã€–ã€—ã€˜ã€™ã€šã€›ã€œã€ã€ã€Ÿã€ ã€°ã€¶ã€·ã€½ã€¾ã‚›ã‚œã‚ ãƒ»ï¸ï¸‘ï¸’ï¸“ï¸”ï¸•ï¸–ï¸—ï¸˜ï¸™ï¸°ï¸±ï¸²ï¸³ï¸´ï¸µï¸¶ï¸·ï¸¸ï¸¹ï¸ºï¸»ï¸¼ï¸½ï¸¾ï¸¿ï¹€ï¹ï¹‚ï¹ƒï¹„ï¹…ï¹†ï¹‡ï¹ˆï¹‰ï¹Šï¹‹ï¹Œï¹ï¹ï¹ï¹ï¹‘ï¹’ï¹”ï¹•ï¹–ï¹—ï¹˜ï¹™ï¹šï¹›ï¹œï¹ï¹ï¹Ÿï¹ ï¹¡ï¹¢ï¹£ï¹¤ï¹¥ï¹¦ï¹¨ï¹©ï¹ªï¹«ğ–¿¢ã€€ï¼ï¼‘ï¼’ï¼“ï¼”ï¼•ï¼–ï¼—ï¼˜ï¼™ï¼¡ï¼¢ï¼£ï¼¤ï¼¥ï¼¦ï¼§ï¼¨ï¼©ï¼ªï¼«ï¼¬ï¼­ï¼®ï¼¯ï¼°ï¼±ï¼²ï¼³ï¼´ï¼µï¼¶ï¼·ï¼¸ï¼¹ï¼ºï½ï½‚ï½ƒï½„ï½…ï½†ï½‡ï½ˆï½‰ï½Šï½‹ï½Œï½ï½ï½ï½ï½‘ï½’ï½“ï½”ï½•ï½–ï½—ï½˜ï½™ï½š'

==>>:
g_encrypt_decrypt_  :+ :'``1.618_""ï¼Œã€‚ã€  ã€‘ã€‡ã€ã€€ã€ã€ï¼ï¼Ÿï¹ç”Ÿä¹Ÿæ— çŸ¥'"''"
'mod_add:19:``U.0W4f""ï¼Œã€‚ã€  ã€‘ã€‡ã€\u3000ã€ã€ï¼ï¼Ÿï½‡ç•‚äºƒæ˜…ç ‹\'\''

g_encrypt_decrypt_  :- :$'mod_add:19:``U.0W4f""ï¼Œã€‚ã€  ã€‘ã€‡ã€\u3000ã€ã€ï¼ï¼Ÿï½‡ç•‚äºƒæ˜…ç ‹\'\''
'``1.618_""ï¼Œã€‚ã€  ã€‘ã€‡ã€\u3000ã€ã€ï¼ï¼Ÿï¹ç”Ÿä¹Ÿæ— çŸ¥\'\''

g_encrypt_decrypt_  :+ :$'``1.618_""ï¼Œã€‚ã€  ã€‘ã€‡ã€\u3000ã€ã€ï¼ï¼Ÿï¹ç”Ÿä¹Ÿæ— çŸ¥\'\''
'mod_add:19:``U.0W4f""ï¼Œã€‚ã€  ã€‘ã€‡ã€\u3000ã€ã€ï¼ï¼Ÿï½‡ç•‚äºƒæ˜…ç ‹\'\''

]]
[[
DONE:åŒºå†…å˜æ¢:å¢åŠ æ±‰å­—åŒº:
view others/app/gvim/regex_cjk.txt
[ã€‡\uE600-\uE6CF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF\U00020000-\U0003FFFF]
\uE600-\uE6CF:ç§ç”¨åŒº
\uF900-\uFAFF:å…¼å®¹åŒº
\U00020000-\U0003FFFF:é«˜ä½é¢
\u3400-\u4DBF:æ‰©å±•A
ã€‡:ç¬¦å·è€Œéæ±‰å­—ï¼Ÿ
\u4E00-\u9FFF:æœ€åˆæ±‰å­—åŒº


view ../lots/NOTE/unicode/cjk/æ±‰å­—åŒº.txt
  [ä¸€-é¾¥]

ä¸­é€‰æ–¹æ¡ˆ:
  æ‰€é€‰ç”¨ç¨³å®šæ±‰å­—åŒº := [ä¸€-é¾¥] #ä¸€yi1 #é¾¥yu4
  <<==:
  ######################
  [gb2312 < [ä¸€-é¾ ] < [ä¸€-é¾¥]]
  ######################
  ç»Ÿåˆç ç‰œæœ€åˆç‰ˆ:V1_1:åªå«ä¸¤ä¸ªæ±‰å­—åŒº:[ä¸€-é¾¥][ï¤€-ï¨­]
      ######################
      # Age=V1_1
      4E00..9FA5
      F900..FA2D
  ######################


==>>:
xxx:g_encrypt_decrypt_  :+ :'``1.618"" ç”Ÿä¹Ÿæ— çŸ¥'"''"
    KeyError: "'`'"
        ???æ€ä¹ˆå›äº‹:æ–°ç‰ˆpyæ˜¾ç¤ºå¼‚å¸¸å‚æ•°ä½¿ç”¨repr???

g_encrypt_decrypt_  :+ :'_ 1.618 ç”Ÿä¹Ÿæ— çŸ¥'
'mod_add:19:a U.0W4 ç•€äºæ˜ƒç ‰'

g_encrypt_decrypt_  :- :'mod_add:19:a U.0W4 ç•€äºæ˜ƒç ‰'
'_ 1.618 ç”Ÿä¹Ÿæ— çŸ¥'

]]
[[
DONE:åŠ å¯†-å…¬å¼€-é˜²æœç´¢-åŒºé—´å¾ªç¯:
  æ˜æ–‡->'åŠ å¯†åè®®-åŒºé—´è¡¨-å¯†ç -ç›-å¯†æ–‡'
  æ¯”å¦‚:ä¿å­˜ ç”µè¯
  view ../../python3_src/nn_ns/app/register_xor.py
  [:ç¿»è¯‘å‰ç¼€å†«é˜²]:goto
  anti_recognition_encrypt

]]


[validate :: int|bool]
    æ·±åº¦çºŸæ ¡éªŒ
    è´Ÿæ•°<==>+oo
    mk_validate4sub_call_







???æ˜æ–‡-->åŸæ–‡
???å¯†æ–‡-->çŸ«æ–‡

è£¸vsè£¹
å‡½-->åœ…-->è£¹
.+1,$s/å‡½/åœ…/g
.+1,$s/åœ…/è£¹/g

å¯†é’¥çºŸåŠ å¯†-->é¡ºé’¥
å¯†é’¥çºŸè§£å¯†-->é€†é’¥
æ˜æ–‡æ–‡æœ¬ç‰œå¤–èµ‹åè®®é¡ºé’¥-->æ˜æ–‡æ–‡æœ¬ç‰œè£¸
å¯†æ–‡æ–‡æœ¬ç‰œå¤–èµ‹åè®®å†…ç¦€é€†é’¥-->å¯†æ–‡æ–‡æœ¬ç‰œè£¹
å¯†æ–‡æ–‡æœ¬ç‰œå†…ç¦€åè®®é€†é’¥-->å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹
.+1,$s/ç‰œå¤–èµ‹åè®®é¡ºé’¥/ç‰œè£¸/g
.+1,$s/ç‰œå†…ç¦€åè®®é€†é’¥/ç‰œè£¹/g


[[[
:read !grep 'def .*validate' ../../python3_src/seed/text/encrypt/anti_recognition_encrypt.py | sort -u
.,.+18s/.*def \(\S*\)(.*):/\1
    #è¡¥å¿:(:
%s/\([.]\(åŠ å¯†å†«æ˜æ–‡æ•°æ®ç‰œè£¸æ‰Œ\|åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸æ‰Œ\|åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸è£¸æ‰Œ\|åŠ å¯†ç‰œåŒºå†…åŠ å¯†æ‰Œ\|åŒºå†…åŠ å¯†ä¹Šå­¤ç æ‰Œ\|æ˜“ä½æ‰Œ\|ç¼–ç å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ\|ç¼–ç å†«å¯†æ–‡ç‰œè£¸æ‰Œ\|ç¼–ç å†«å¯†æ–‡ç‰œè£¹æ‰Œ\|ç¼–ç å†«å¯†æ–‡ç‰œè£¹ç‰œç¬æ‰Œ\|å°è£…å†«è´Ÿè½½æ‰Œ\|ç¼–ç å†«é€†é’¥æ‰Œ\|è„±æ°´ç¼–ç å†«çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´æ‰Œ\|è§£ç å†«æ˜æ–‡ç‰œè£¸æ‰Œ\|è§£ç å†«é¡ºé’¥æ‰Œ\|è½¬ä¹‰å†«æ–‡æœ¬æ‰Œ\)[(].*\)[)]/\1, validate=_validate)
/def \(åŠ å¯†å†«æ˜æ–‡æ•°æ®ç‰œè£¸æ‰Œ\|åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸æ‰Œ\|åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸è£¸æ‰Œ\|åŠ å¯†ç‰œåŒºå†…åŠ å¯†æ‰Œ\|åŒºå†…åŠ å¯†ä¹Šå­¤ç æ‰Œ\|æ˜“ä½æ‰Œ\|ç¼–ç å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ\|ç¼–ç å†«å¯†æ–‡ç‰œè£¸æ‰Œ\|ç¼–ç å†«å¯†æ–‡ç‰œè£¹æ‰Œ\|ç¼–ç å†«å¯†æ–‡ç‰œè£¹ç‰œç¬æ‰Œ\|å°è£…å†«è´Ÿè½½æ‰Œ\|ç¼–ç å†«é€†é’¥æ‰Œ\|è„±æ°´ç¼–ç å†«çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´æ‰Œ\|è§£ç å†«æ˜æ–‡ç‰œè£¸æ‰Œ\|è§£ç å†«é¡ºé’¥æ‰Œ\|è½¬ä¹‰å†«æ–‡æœ¬æ‰Œ\)
===
    def åŠ å¯†å†«æ˜æ–‡æ•°æ®ç‰œè£¸æ‰Œ(sf, é¡ºé’¥æ•°æ®, æ˜æ–‡æ•°æ®ç‰œè£¸, /, *, validate):
    def åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸æ‰Œ(sf, é¡ºé’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸, /, *, validate):
    def åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸è£¸æ‰Œ(sf, åŒ¾åè®®, é¡ºé’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸, /, *, validate):
    def åŠ å¯†ç‰œåŒºå†…åŠ å¯†æ‰Œ(sf, çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ, /, *, validate):
    def åŒºå†…åŠ å¯†ä¹Šå­¤ç æ‰Œ(sf, åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡, çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·, /, *, validate):
    def æ˜“ä½æ‰Œ(sf, çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, /, *, validate):
    def ç¼–ç å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ(sf, åŒ¾åè®®, å¯†æ–‡æ–‡æœ¬ç‰œè£¹, /, *, validate):
    def ç¼–ç å†«å¯†æ–‡ç‰œè£¸æ‰Œ(sf, å¯†æ–‡æ•°æ®ç‰œè£¸, /, *, validate):
    def ç¼–ç å†«å¯†æ–‡ç‰œè£¹æ‰Œ(sf, å¯†æ–‡æ•°æ®ç‰œè£¹, /, *, validate):
    def ç¼–ç å†«å¯†æ–‡ç‰œè£¹ç‰œç¬æ‰Œ(sf, é€†é’¥æ–‡æœ¬, å¯†æ–‡æ–‡æœ¬ç‰œè£¸, /, *, validate):
    def å°è£…å†«è´Ÿè½½æ‰Œ(sf, è´Ÿè½½, /, *, validate):
    def ç¼–ç å†«é€†é’¥æ‰Œ(sf, é€†é’¥æ•°æ®, /, *, validate):
    def è„±æ°´ç¼–ç å†«çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´æ‰Œ(sf, çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´, /, *, validate):
    def è§£ç å†«æ˜æ–‡ç‰œè£¸æ‰Œ(sf, æ˜æ–‡æ–‡æœ¬ç‰œè£¸, /, *, validate):
    def è§£ç å†«é¡ºé’¥æ‰Œ(sf, é¡ºé’¥æ–‡æœ¬, /, *, validate):
    def è½¬ä¹‰å†«æ–‡æœ¬æ‰Œ(sf, æ–‡æœ¬ä¹Šè½¬ä¹‰å‰, /, *, validate):
]]]






[:__cmds__]:here
py -m seed.text.encrypt.anti_recognition_encrypt
py -m nn_ns.app.debug_cmd   seed.text.encrypt.anti_recognition_encrypt -x
py -m nn_ns.app.doctest_cmd seed.text.encrypt.anti_recognition_encrypt:__doc__ -ht
from seed.text.encrypt.anti_recognition_encrypt import *



py_adhoc_call   seed.text.encrypt.anti_recognition_encrypt   @ç¬åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸è£¸æ‰Œ  --validate=1 :mod_add :19 :6180339887498948482045868343656381177203091798
'mod_add:19:ZV3W0188997DDFBGDIDCHJNMPLNNRRTRXRSZ0WVZX707AA'

py_adhoc_call   seed.text.encrypt.anti_recognition_encrypt   @ç¬ç®€è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ :mod_add:19:ZV3W0188997DDFBGDIDCHJNMPLNNRRTRXRSZ0WVZX707AA
'6180339887498948482045868343656381177203091798'

py_adhoc_call   seed.text.encrypt.anti_recognition_encrypt   @g_encrypt_  --validate=1 :mod_add :19 :'110 119 114'
'mod_add:19:TUU WX6 Z04'
py_adhoc_call   seed.text.encrypt.anti_recognition_encrypt   @g_self_decrypt__brief_ :'mod_add:19:TUU WX6 Z04'
'110 119 114'

py_adhoc_call   seed.text.encrypt.anti_recognition_encrypt   @g_encrypt_decrypt_  :+ :'110 119 120'
'mod_add:19:TUU WX6 Z10'
py_adhoc_call   seed.text.encrypt.anti_recognition_encrypt   @g_encrypt_decrypt_  :-  :'mod_add:19:TUU WX6 Z10'
'110 119 120'

echo 'py_adhoc_call   seed.text.encrypt.anti_recognition_encrypt   @g_encrypt_decrypt_   "$@"' >>  ../../python3_src/bash_script/app/g_encrypt_decrypt_

g_encrypt_decrypt_  :+ :'110 119 120'
'mod_add:19:TUU WX6 Z10'
g_encrypt_decrypt_  :-  :'mod_add:19:TUU WX6 Z10'
'110 119 120'




ç¬åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸è£¸æ‰Œ
ç¬è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ
ç¬ç®€è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ
>>> _validate = -1
>>> åŒ¾åè®® = 'mod_add'
>>> é¡ºé’¥æ–‡æœ¬ = str(2**61 -1)
>>> æ˜æ–‡æ–‡æœ¬ç‰œè£¸ = '244:1341 - 0484$#'
>>> å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹ = ç¬åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸è£¸æ‰Œ(åŒ¾åè®®, é¡ºé’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸, validate=_validate)
>>> (_åŒ¾åè®®, é€†é’¥æ–‡æœ¬, _æ˜æ–‡æ–‡æœ¬ç‰œè£¸) = ç¬è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ(å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹)
>>> _åŒ¾åè®® == åŒ¾åè®®
True
>>> _æ˜æ–‡æ–‡æœ¬ç‰œè£¸ == æ˜æ–‡æ–‡æœ¬ç‰œè£¸
True
>>> é€†é’¥æ–‡æœ¬ == é¡ºé’¥æ–‡æœ¬
True
>>> å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹
'mod_add:2305843009213693951:WZ0:Y131 - 16B8$#'
>>> é¡ºé’¥æ–‡æœ¬
'2305843009213693951'
>>> ç¬è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ('mod_add:2305843009213693951:WZ0:Y131 - 16B8$#')
('mod_add', '2305843009213693951', '244:1341 - 0484$#')
>>> ç¬ç®€è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ('mod_add:2305843009213693951:WZ0:Y131 - 16B8$#')
'244:1341 - 0484$#'


>>> é¡ºé’¥æ–‡æœ¬ = '19'
>>> å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹ = ç¬åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸è£¸æ‰Œ(åŒ¾åè®®, é¡ºé’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸, validate=_validate)
>>> å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹
'mod_add:19:WZ0:Y131 - 16B8$#'

>>> é¡ºé’¥æ–‡æœ¬ = '1'
>>> å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹ = ç¬åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸è£¸æ‰Œ(åŒ¾åè®®, é¡ºé’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸, validate=_validate)
>>> å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹
'mod_add:1:EHI:GJLJ - JOTQ$#'

>>> åŒ´åŠ å¯† = ç¬æŸ¥æ‰¾æ‰Œ(åŒ¾åè®®)
>>> æ˜æ–‡æœ‰æ•ˆé•¿åº¦ = åŒ´åŠ å¯†.ç»Ÿè®¡å†«æ˜æ–‡æœ‰æ•ˆé•¿åº¦ç‰œæ–‡æœ¬æ‰Œ(æ˜æ–‡æ–‡æœ¬ç‰œè£¸)

>>> é¡ºé’¥æ–‡æœ¬ = str(-æ˜æ–‡æœ‰æ•ˆé•¿åº¦)
>>> å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹ = ç¬åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸è£¸æ‰Œ(åŒ¾åè®®, é¡ºé’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸, validate=_validate)
>>> å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹
'mod_add:-11:256:4797 - 7CHE$#'



åŒ´è½¬ä¹‰å†«æ–‡æœ¬ç‰œæç®€å…·ç°
åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°
abfnrtv0
>>> åŒ´è½¬ä¹‰å†«æ–‡æœ¬ç‰œæç®€å…·ç°.è½¬ä¹‰å†«æ–‡æœ¬æ‰Œ('', validate=-1)
''
>>> åŒ´è½¬ä¹‰å†«æ–‡æœ¬ç‰œæç®€å…·ç°.è½¬ä¹‰å†«æ–‡æœ¬æ‰Œ('abcd \u3000\a\b\f\n\r\t\v\0!?', validate=-1)
'abcd!?-!?=!?a!?b!?f!?n!?r!?t!?v!?0!?.'


>>> åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°.è½¬ä¹‰å†«è¶…æ–‡æœ¬æ‰Œ([], validate=-1)
''

#>>> åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°.è½¬ä¹‰å†«è¶…æ–‡æœ¬æ‰Œ([''], validate=-1)
#''
#>>> åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°.è½¬ä¹‰å†«è¶…æ–‡æœ¬æ‰Œ(['', ()], validate=-1)
#''
#>>> åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°.è½¬ä¹‰å†«è¶…æ–‡æœ¬æ‰Œ(['', ('',)], validate=-1)
#>>> åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°.è½¬ä¹‰å†«è¶…æ–‡æœ¬æ‰Œ(['', ('','')], validate=-1)
#>>> åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°.è½¬ä¹‰å†«è¶…æ–‡æœ¬æ‰Œ(['', ('','','?!x')], validate=-1)
>>> åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°.è½¬ä¹‰å†«è¶…æ–‡æœ¬æ‰Œ(['', ('a',)], validate=-1)
'!?^a'
>>> åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°.è½¬ä¹‰å†«è¶…æ–‡æœ¬æ‰Œ(['', ('aa',)], validate=-1)
'!?^(aa)'
>>> åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°.è½¬ä¹‰å†«è¶…æ–‡æœ¬æ‰Œ(['', ('a','b')], validate=-1)
'!?^(a,b)'
>>> åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°.è½¬ä¹‰å†«è¶…æ–‡æœ¬æ‰Œ(['', ('a','b','?!x')], validate=-1)
'!?^(a,b,?!x)'
>>> åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°.è½¬ä¹‰å†«è¶…æ–‡æœ¬æ‰Œ(['abcd \u3000\a\b\f\n\r\t\v\0!?'], validate=-1)
'abcd!?-!?=!?a!?b!?f!?n!?r!?t!?v!?0!?.'
>>> åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°.è½¬ä¹‰å†«è¶…æ–‡æœ¬æ‰Œ(['abcd \u3000\a\b\f\n\r\t\v\0!?', ('a','b','?!x'), '!?', ('yyy',), '\0', ('zzz','aaa')], validate=-1)
'abcd!?-!?=!?a!?b!?f!?n!?r!?t!?v!?0!?.!?^(a,b,?!x)!?.!?^(yyy)!?0!?^(zzz,aaa)'






>>> 'abcd \u3000\x07\x08\x0c\n\r\t\x0b\x00!?' == 'abcd \u3000\a\b\f\n\r\t\v\0!?'
True
>>> åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°.è¿˜åŸå†«è¶…æ–‡æœ¬æ‰Œ('abcd!?-!?=!?a!?b!?f!?n!?r!?t!?v!?0!?.!?^(a,b,?!x)!?.!?^(yyy)!?0!?^(zzz,aaa)')
('abcd \u3000\x07\x08\x0c\n\r\t\x0b\x00!?', ('a', 'b', '?!x'), '!?', ('yyy',), '\x00', ('zzz', 'aaa'))
>>> åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°.è¿˜åŸå†«è¶…æ–‡æœ¬æ‰Œ('abcd!?-!?=!?a!?b!?f!?n!?r!?t!?v!?0!?.')
('abcd \u3000\x07\x08\x0c\n\r\t\x0b\x00!?',)
>>> åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°.è¿˜åŸå†«è¶…æ–‡æœ¬æ‰Œ('!?^a')
('', ('a',))
>>> åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°.è¿˜åŸå†«è¶…æ–‡æœ¬æ‰Œ('!?^(aa)')
('', ('aa',))
>>> åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°.è¿˜åŸå†«è¶…æ–‡æœ¬æ‰Œ('!?^(a,b)')
('', ('a', 'b'))
>>> åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°.è¿˜åŸå†«è¶…æ–‡æœ¬æ‰Œ('!?^(a,b,?!x)')
('', ('a', 'b', '?!x'))





#]]]'''
__all__ = r'''
g_encrypt_decrypt_
æ³¨å†Œå¤„çºŸåŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬
    ç¬æ³¨å†Œæ‰Œ
    ç¬æŸ¥æ‰¾æ‰Œ
    ç¬æšä¸¾å†«åŒ¾åè®®ä¹Šå·²æ³¨å†Œæ‰Œ
    ç¬åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸è£¸æ‰Œ
    ç¬è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ
    ç¬ç®€è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ
    g_register_
    g_lookup_
    g_iter_nms4protocol_
    g_encrypt_
    g_self_decrypt__verbose_
    g_self_decrypt__brief_

åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬æ°ºè‡ªå®šä¹‰æ•°æ®ç‰œåŒºå†…å˜æ¢ä¹Šå­¤ç ç‰œæ’çŠ¶æ€ç‰œæ¨¡åŠ 
ä¹¸åŒºä½é…ç½®ç‰œç å…ƒä¸ºå­—ç¬¦ç¼–ç ç‚¹

ä¹¸åŒ´è½¬ä¹‰å†«æ–‡æœ¬ç‰œæç®€å…·ç°
ä¹¸åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°
















é­–æ³¨å†Œå¤„çºŸåŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬
    ä¹¸æ³¨å†Œå¤„çºŸåŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬
        æ³¨å†Œå¤„çºŸåŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬

é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œè‡ªå®šä¹‰æ•°æ®
    é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œè‡ªå®šä¹‰æ•°æ®ç‰œåŒºå†…å˜æ¢
        é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œè‡ªå®šä¹‰æ•°æ®ç‰œåŒºå†…å˜æ¢ä¹Šå­¤ç 

é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬
    é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬æ°ºè‡ªå®šä¹‰æ•°æ®
        é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬æ°ºè‡ªå®šä¹‰æ•°æ®ç‰œåŒºå†…å˜æ¢
            é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬æ°ºè‡ªå®šä¹‰æ•°æ®ç‰œåŒºå†…å˜æ¢ä¹Šå­¤ç 
                ä¹¸åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬æ°ºè‡ªå®šä¹‰æ•°æ®ç‰œåŒºå†…å˜æ¢ä¹Šå­¤ç ç‰œæ’çŠ¶æ€ç‰œæ¨¡åŠ 
                    åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬æ°ºè‡ªå®šä¹‰æ•°æ®ç‰œåŒºå†…å˜æ¢ä¹Šå­¤ç ç‰œæ’çŠ¶æ€ç‰œæ¨¡åŠ 


ç½®æ¢æ‰Œ
mk_validate4sub_call_

é­–åŒºä½é…ç½®
    ä¹¸åŒºä½é…ç½®ç‰œç å…ƒä¸ºå­—ç¬¦ç¼–ç ç‚¹
é­–åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬
    ä¹¸åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°
        åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°
é­–åŒ´è½¬ä¹‰å†«æ–‡æœ¬
    ä¹¸åŒ´è½¬ä¹‰å†«æ–‡æœ¬ç‰œæç®€å…·ç°
        åŒ´è½¬ä¹‰å†«æ–‡æœ¬ç‰œæç®€å…·ç°
        åŒ´è½¬ä¹‰å†«ç”¨äºåˆ†éš”åŒ¾åè®®

'''.split()#'''
__all__
from itertools import cycle as cycle_

from seed.abc.abc__ver1 import abstractmethod, override, ABC, ABC__no_slots
from seed.tiny import fst, snd, print_err# echo, chains
from seed.seq_tools.split_tuples import unzip_pairs
from seed.seq_tools.inverse_uint_bijection_array import inverse_uint_bijection_array
from seed.tiny_.check import check_type_is, check_type_le, check_int_ge
#from seed.iters.group_by import group_by

from seed.helper.repr_input import repr_helper
from seed.text.mk_char_pt_ranges5predicator import punctuation_ascii_sorted_chars #punctuation_ascii_char_pt_ranges

def mk_validate4sub_call_(validate, /):
    r'''[[[
[validate :: int|bool]
    æ·±åº¦çºŸæ ¡éªŒ
    è´Ÿæ•°<==>+oo
    #]]]'''#'''
    check_type_le(int, validate)
    _validate = validate and (-1 if validate < 0 else validate-1)

    return _validate
assert 1 == mk_validate4sub_call_(2)
assert 0 == mk_validate4sub_call_(1)
assert 0 == mk_validate4sub_call_(0)
assert -1 == mk_validate4sub_call_(-1)
assert -1 == mk_validate4sub_call_(-2)

class é­–æ³¨å†Œå¤„çºŸåŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬(ABC):
    __slots__ = ()
    @abstractmethod
    def æšä¸¾å†«åŒ¾åè®®ä¹Šå·²æ³¨å†Œæ‰Œ(sf, /):
        '-> Iter åŒ¾åè®®/str'
    @abstractmethod
    def æŸ¥æ‰¾æ‰Œ(sf, åŒ¾åè®®, /):
        'åŒ¾åè®®/str -> åŒ´åŠ å¯†/é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬ | ^LookupError'
    @abstractmethod
    def æ³¨å†Œæ‰Œ(sf, åŒ´åŠ å¯†, /):
        'åŒ´åŠ å¯†/é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬ -> None'
        åŒ´åŠ å¯†.åŒ¾åè®®
    @abstractmethod
    def ç¼–ç å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ(sf, åŒ¾åè®®, å¯†æ–‡æ–‡æœ¬ç‰œè£¹, /, *, validate):
        'åŒ¾åè®® -> å¯†æ–‡æ–‡æœ¬ç‰œè£¹ -> å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹'
        #æ ¼å¼åŒ–
    @abstractmethod
    def è§£ç å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ(sf, å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹, /):
        'å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹ -> (åŒ¾åè®®, å¯†æ–‡æ–‡æœ¬ç‰œè£¹)'
        #è§£æ

    def åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸è£¸æ‰Œ(sf, åŒ¾åè®®, é¡ºé’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸, /, *, validate):
        'åŒ¾åè®®/str -> é¡ºé’¥æ–‡æœ¬/str -> æ˜æ–‡æ–‡æœ¬ç‰œè£¸/str -> å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹/str'
        _validate = mk_validate4sub_call_(validate)
        åŒ´åŠ å¯† = sf.æŸ¥æ‰¾æ‰Œ(åŒ¾åè®®)
        å¯†æ–‡æ–‡æœ¬ç‰œè£¹ = åŒ´åŠ å¯†.åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸æ‰Œ(é¡ºé’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸, validate=_validate)
        å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹ = sf.ç¼–ç å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ(åŒ¾åè®®, å¯†æ–‡æ–‡æœ¬ç‰œè£¹, validate=_validate)
        if validate:
            #if not sf.è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ(å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹) == (åŒ¾åè®®, é€†é’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸):raise Exception((sf, (åŒ¾åè®®, é¡ºé’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸), '??é€†é’¥æ–‡æœ¬', (å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹)))
            if not sf.è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ(å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹)[0::2] == (åŒ¾åè®®, æ˜æ–‡æ–‡æœ¬ç‰œè£¸):raise Exception((sf, (åŒ¾åè®®, é¡ºé’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸), (å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹)))
        return å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹
    def è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ(sf, å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹, /):
        'å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹/str -> (åŒ¾åè®®, é€†é’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸)/(str,str,str)'
        #xxx:ä¸ä¸€å®šæœ‰:é¡ºé’¥æ–‡æœ¬
        (åŒ¾åè®®, å¯†æ–‡æ–‡æœ¬ç‰œè£¹) = sf.è§£ç å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ(å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹)
        åŒ´åŠ å¯† = sf.æŸ¥æ‰¾æ‰Œ(åŒ¾åè®®)
        (é€†é’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸) = åŒ´åŠ å¯†.è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹æ‰Œ(å¯†æ–‡æ–‡æœ¬ç‰œè£¹)
        return (åŒ¾åè®®, é€†é’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸)
    def ç®€è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ(sf, å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹, /):
        'å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹/str -> æ˜æ–‡æ–‡æœ¬ç‰œè£¸/str'
        (åŒ¾åè®®, é€†é’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸) = sf.è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ(å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹)
        return æ˜æ–‡æ–‡æœ¬ç‰œè£¸

class é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œè‡ªå®šä¹‰æ•°æ®(ABC):
    __slots__ = ()
    @abstractmethod
    def åŠ å¯†å†«æ˜æ–‡æ•°æ®ç‰œè£¸æ‰Œ(sf, é¡ºé’¥æ•°æ®, æ˜æ–‡æ•°æ®ç‰œè£¸, /, *, validate):
        'é¡ºé’¥æ•°æ®/? -> æ˜æ–‡æ•°æ®ç‰œè£¸/? -> å¯†æ–‡æ•°æ®ç‰œè£¹/(é€†é’¥æ•°æ®,å¯†æ–‡æ•°æ®ç‰œè£¸)/(?,?)'
    @abstractmethod
    def è‡ªè§£å¯†å†«å¯†æ–‡æ•°æ®ç‰œè£¹æ‰Œ(sf, å¯†æ–‡æ•°æ®ç‰œè£¹, /):
        'å¯†æ–‡æ•°æ®ç‰œè£¹/(é€†é’¥æ•°æ®,å¯†æ–‡æ•°æ®ç‰œè£¸)/(?,?) -> (é€†é’¥æ•°æ®, æ˜æ–‡æ•°æ®ç‰œè£¸)/(?,?)'
        #xxx:ä¸ä¸€å®šæœ‰:é¡ºé’¥æ•°æ®

class é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬(ABC):
    __slots__ = ()
    @property
    @abstractmethod
    def åŒ¾åè®®(sf, /):
        '-> åŒ¾åè®®/str'
    @abstractmethod
    def åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸æ‰Œ(sf, é¡ºé’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸, /, *, validate):
        'é¡ºé’¥æ–‡æœ¬/str -> æ˜æ–‡æ–‡æœ¬ç‰œè£¸/str -> å¯†æ–‡æ–‡æœ¬ç‰œè£¹/str'
    @abstractmethod
    def è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹æ‰Œ(sf, å¯†æ–‡æ–‡æœ¬ç‰œè£¹, /):
        'å¯†æ–‡æ–‡æœ¬ç‰œè£¹/str -> (é€†é’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸)/(str,str)'
        #xxx:ä¸ä¸€å®šæœ‰:é¡ºé’¥æ–‡æœ¬

class é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬æ°ºè‡ªå®šä¹‰æ•°æ®(é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬, é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œè‡ªå®šä¹‰æ•°æ®):
    __slots__ = ()
    ######################
    @abstractmethod
    def è§£ç å†«é¡ºé’¥æ‰Œ(sf, é¡ºé’¥æ–‡æœ¬, /, *, validate):
        'é¡ºé’¥æ–‡æœ¬ -> é¡ºé’¥æ•°æ®'
        #validate@è§£ç å‘  <<== æ­¤ä¹ƒåŠ å¯†å‘
    @abstractmethod
    def ç¼–ç å†«é¡ºé’¥æ‰Œ(sf, é¡ºé’¥æ•°æ®, /):
        'é¡ºé’¥æ•°æ® -> é¡ºé’¥æ–‡æœ¬'
    ######################
    @abstractmethod
    def è§£ç å†«é€†é’¥æ‰Œ(sf, é€†é’¥æ–‡æœ¬, /):
        'é€†é’¥æ–‡æœ¬ -> é€†é’¥æ•°æ®'
    @abstractmethod
    def ç¼–ç å†«é€†é’¥æ‰Œ(sf, é€†é’¥æ•°æ®, /, *, validate):
        'é€†é’¥æ•°æ® -> é€†é’¥æ–‡æœ¬'
    ######################
    ######################
    #æœ‰:å¯†æ–‡æ–‡æœ¬ç‰œè£¸,å¯†æ–‡æ–‡æœ¬ç‰œè£¹
    #æœ‰:å¯†æ–‡æ•°æ®ç‰œè£¸,å¯†æ–‡æ•°æ®ç‰œè£¹
    #æœ‰:æ˜æ–‡æ–‡æœ¬ç‰œè£¸,ä½†æ— :æ˜æ–‡æ–‡æœ¬ç‰œè£¹
    #æœ‰:æ˜æ–‡æ•°æ®ç‰œè£¸,ä½†æ— :æ˜æ–‡æ•°æ®ç‰œè£¹å›—å›—å›—ä¸å­˜åœ¨
    ######################
    ######################
    @abstractmethod
    def è§£ç å†«æ˜æ–‡ç‰œè£¸æ‰Œ(sf, æ˜æ–‡æ–‡æœ¬ç‰œè£¸, /, *, validate):
        'æ˜æ–‡æ–‡æœ¬ç‰œè£¸ -> æ˜æ–‡æ•°æ®ç‰œè£¸'
        #validate@è§£ç å‘  <<== æ­¤ä¹ƒåŠ å¯†å‘
    @abstractmethod
    def ç¼–ç å†«æ˜æ–‡ç‰œè£¸æ‰Œ(sf, æ˜æ–‡æ•°æ®ç‰œè£¸, /):
        'æ˜æ–‡æ•°æ®ç‰œè£¸ -> æ˜æ–‡æ–‡æœ¬ç‰œè£¸'
    ######################
    @abstractmethod
    def è§£ç å†«å¯†æ–‡ç‰œè£¸æ‰Œ(sf, å¯†æ–‡æ–‡æœ¬ç‰œè£¸, /):
        'å¯†æ–‡æ–‡æœ¬ç‰œè£¸ -> å¯†æ–‡æ•°æ®ç‰œè£¸'
    @abstractmethod
    def ç¼–ç å†«å¯†æ–‡ç‰œè£¸æ‰Œ(sf, å¯†æ–‡æ•°æ®ç‰œè£¸, /, *, validate):
        'å¯†æ–‡æ•°æ®ç‰œè£¸ -> å¯†æ–‡æ–‡æœ¬ç‰œè£¸'
    ######################
    @abstractmethod
    def è§£ç å†«å¯†æ–‡ç‰œè£¹ç‰œç¬æ‰Œ(sf, å¯†æ–‡æ–‡æœ¬ç‰œè£¹, /):
        'å¯†æ–‡æ–‡æœ¬ç‰œè£¹ -> (é€†é’¥æ–‡æœ¬, å¯†æ–‡æ–‡æœ¬ç‰œè£¸)'
        #è§£æ/parse
    @abstractmethod
    def ç¼–ç å†«å¯†æ–‡ç‰œè£¹ç‰œç¬æ‰Œ(sf, é€†é’¥æ–‡æœ¬, å¯†æ–‡æ–‡æœ¬ç‰œè£¸, /, *, validate):
        'é€†é’¥æ–‡æœ¬ -> å¯†æ–‡æ–‡æœ¬ç‰œè£¸ -> å¯†æ–‡æ–‡æœ¬ç‰œè£¹'
        #æ ¼å¼åŒ–/format
    ######################
    def è§£ç å†«å¯†æ–‡ç‰œè£¹æ‰Œ(sf, å¯†æ–‡æ–‡æœ¬ç‰œè£¹, /):
        'å¯†æ–‡æ–‡æœ¬ç‰œè£¹ -> å¯†æ–‡æ•°æ®ç‰œè£¹'
        (é€†é’¥æ–‡æœ¬, å¯†æ–‡æ–‡æœ¬ç‰œè£¸) = sf.è§£ç å†«å¯†æ–‡ç‰œè£¹ç‰œç¬æ‰Œ(å¯†æ–‡æ–‡æœ¬ç‰œè£¹)
        å¯†æ–‡æ•°æ®ç‰œè£¸ = sf.è§£ç å†«å¯†æ–‡ç‰œè£¸æ‰Œ(å¯†æ–‡æ–‡æœ¬ç‰œè£¸)
        é€†é’¥æ•°æ® = sf.è§£ç å†«é€†é’¥æ‰Œ(é€†é’¥æ–‡æœ¬)
        å¯†æ–‡æ•°æ®ç‰œè£¹ = (é€†é’¥æ•°æ®,å¯†æ–‡æ•°æ®ç‰œè£¸)
        return å¯†æ–‡æ•°æ®ç‰œè£¹
    def ç¼–ç å†«å¯†æ–‡ç‰œè£¹æ‰Œ(sf, å¯†æ–‡æ•°æ®ç‰œè£¹, /, *, validate):
        'å¯†æ–‡æ•°æ®ç‰œè£¹ -> å¯†æ–‡æ–‡æœ¬ç‰œè£¹'
        _validate = mk_validate4sub_call_(validate)
        (é€†é’¥æ•°æ®,å¯†æ–‡æ•°æ®ç‰œè£¸) = å¯†æ–‡æ•°æ®ç‰œè£¹
        é€†é’¥æ–‡æœ¬ = sf.ç¼–ç å†«é€†é’¥æ‰Œ(é€†é’¥æ•°æ®, validate=_validate)
        å¯†æ–‡æ–‡æœ¬ç‰œè£¸ = sf.ç¼–ç å†«å¯†æ–‡ç‰œè£¸æ‰Œ(å¯†æ–‡æ•°æ®ç‰œè£¸, validate=_validate)
        å¯†æ–‡æ–‡æœ¬ç‰œè£¹ = sf.ç¼–ç å†«å¯†æ–‡ç‰œè£¹ç‰œç¬æ‰Œ(é€†é’¥æ–‡æœ¬, å¯†æ–‡æ–‡æœ¬ç‰œè£¸, validate=_validate)
        if validate:
            if not sf.è§£ç å†«å¯†æ–‡ç‰œè£¹æ‰Œ(å¯†æ–‡æ–‡æœ¬ç‰œè£¹) == (å¯†æ–‡æ•°æ®ç‰œè£¹):raise Exception((sf, (å¯†æ–‡æ•°æ®ç‰œè£¹), (å¯†æ–‡æ–‡æœ¬ç‰œè£¹)))
        return å¯†æ–‡æ–‡æœ¬ç‰œè£¹
    ######################
    @override
    def åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸æ‰Œ(sf, é¡ºé’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸, /, *, validate):
        'é¡ºé’¥æ–‡æœ¬/str -> æ˜æ–‡æ–‡æœ¬ç‰œè£¸/str -> å¯†æ–‡æ–‡æœ¬ç‰œè£¹/str'
        _validate = mk_validate4sub_call_(validate)
        é¡ºé’¥æ•°æ® = sf.è§£ç å†«é¡ºé’¥æ‰Œ(é¡ºé’¥æ–‡æœ¬, validate=_validate)
        æ˜æ–‡æ•°æ®ç‰œè£¸ = sf.è§£ç å†«æ˜æ–‡ç‰œè£¸æ‰Œ(æ˜æ–‡æ–‡æœ¬ç‰œè£¸, validate=_validate)
        å¯†æ–‡æ•°æ®ç‰œè£¹ = sf.åŠ å¯†å†«æ˜æ–‡æ•°æ®ç‰œè£¸æ‰Œ(é¡ºé’¥æ•°æ®, æ˜æ–‡æ•°æ®ç‰œè£¸, validate=_validate)
        å¯†æ–‡æ–‡æœ¬ç‰œè£¹ = sf.ç¼–ç å†«å¯†æ–‡ç‰œè£¹æ‰Œ(å¯†æ–‡æ•°æ®ç‰œè£¹, validate=_validate)
        if validate:
            #if not sf.è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹æ‰Œ(å¯†æ–‡æ–‡æœ¬ç‰œè£¹) == (é€†é’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸):raise Exception((sf, (é¡ºé’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸), '??é€†é’¥æ–‡æœ¬', (å¯†æ–‡æ–‡æœ¬ç‰œè£¹)))
            if not sf.è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹æ‰Œ(å¯†æ–‡æ–‡æœ¬ç‰œè£¹)[1] == æ˜æ–‡æ–‡æœ¬ç‰œè£¸:raise Exception((sf, (é¡ºé’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸), (å¯†æ–‡æ–‡æœ¬ç‰œè£¹)))
        return å¯†æ–‡æ–‡æœ¬ç‰œè£¹
    @override
    def è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹æ‰Œ(sf, å¯†æ–‡æ–‡æœ¬ç‰œè£¹, /):
        'å¯†æ–‡æ–‡æœ¬ç‰œè£¹/str -> (é€†é’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸)/(str,str)'
        _validate = False
        å¯†æ–‡æ•°æ®ç‰œè£¹ = sf.è§£ç å†«å¯†æ–‡ç‰œè£¹æ‰Œ(å¯†æ–‡æ–‡æœ¬ç‰œè£¹)
        (é€†é’¥æ•°æ®, æ˜æ–‡æ•°æ®ç‰œè£¸) = sf.è‡ªè§£å¯†å†«å¯†æ–‡æ•°æ®ç‰œè£¹æ‰Œ(å¯†æ–‡æ•°æ®ç‰œè£¹)
        é€†é’¥æ–‡æœ¬ = sf.ç¼–ç å†«é€†é’¥æ‰Œ(é€†é’¥æ•°æ®, validate=_validate)
        æ˜æ–‡æ–‡æœ¬ç‰œè£¸ = sf.ç¼–ç å†«æ˜æ–‡ç‰œè£¸æ‰Œ(æ˜æ–‡æ•°æ®ç‰œè£¸)
        return (é€†é’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸)
    ######################
    ######################
    ######################
    ######################
    ######################
    ######################
    ######################
    ######################
    ######################
class é­–åŒºä½é…ç½®(ABC):
    __slots__ = ()
    @property
    @abstractmethod
    def åŒºæ•°(sf, /):
        '-> åŒºæ•°/uint # [0 ~==~ +oo]'
    @abstractmethod
    def åŒºå·è® ä½æ•°æ‰Œ(sf, åŒºå·, /):
        'åŒºå·/uint%åŒºæ•° -> ä½æ•°ä¹ŠåŒºå·/uint # [0 ~==~ +oo]'
    @abstractmethod
    def ç å…ƒè® é¬½åŒºä½å·æ‰Œ(sf, ç å…ƒ, /):
        'ç å…ƒ -> may åŒºä½å·/(åŒºå·/uint%åŒºæ•°,ä½å·/uint%ä½æ•°ä¹ŠåŒºå·) | ^LookupError'
    @abstractmethod
    def ç å…ƒå·›åŒºä½å·æ‰Œ(sf, åŒºä½å·, /):
        'åŒºä½å·/(åŒºå·/uint%åŒºæ•°,ä½å·/uint%ä½æ•°ä¹ŠåŒºå·) -> ç å…ƒ'


class é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œè‡ªå®šä¹‰æ•°æ®ç‰œåŒºå†…å˜æ¢(é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œè‡ªå®šä¹‰æ•°æ®):
    r'''[[[
åŒºå†…å˜æ¢:å„åŒºä¸ç›¸äº¤ï¼Œå„åŒºç å…ƒå˜æ¢ä¸çªœåŒº
    æ˜æ–‡æ•°æ®ç‰œè£¸ :: [ç å…ƒ]
    å¯†æ–‡æ•°æ®ç‰œè£¸ :: [ç å…ƒ]

åŒºä½é…ç½®:
    åŒºå·è® ä½æ•°æ‰Œ :: åŒºå· -> ä½æ•°ä¹ŠåŒºå·
    ç å…ƒè® é¬½åŒºä½å·æ‰Œ :: ç å…ƒ -> may åŒºä½å· | ^LookupError
        åŒºä½å·=>æœ‰æ•ˆç å…ƒ
        None=>æ— å…³ç å…ƒ/ä¸åŠ¨ç‚¹
        LookupError=>ç¦ç”¨ç å…ƒ
    ç å…ƒå·›åŒºä½å·æ‰Œ :: åŒºä½å· -> ç å…ƒ


ç å…ƒä¸²è® æœ‰æ•ˆåŒºä½å·ä¸²è¾»åºå·ä¸²æ‰Œ :: [ç å…ƒ] -> (åŒºä½å·ä¸²,åºå·ä¸²çºŸæœ‰æ•ˆç å…ƒåŒ•æ•´ä½“æ˜æ–‡)/([åŒºä½å·],[uint%æ˜æ–‡æ•´ä½“é•¿åº¦)
    è¿‡æ»¤æ‰:æ— å…³ç å…ƒ
æœ‰æ•ˆç å…ƒä¸²å·›åŒºä½å·ä¸²æ‰Œ :: [åŒºä½å·] -> [ç å…ƒ]
ç å…ƒä¸²å·›æœ‰æ•ˆç å…ƒä¸²è¾»åºå·ä¸²è¾»ç å…ƒä¸²ä¹Šå¼‚ç«¯æ‰Œ :: æœ‰æ•ˆç å…ƒä¸²/[ç å…ƒ] -> åºå·ä¸²çºŸæœ‰æ•ˆç å…ƒåŒ•æ•´ä½“æ˜æ–‡/[uint%æ˜æ–‡æ•´ä½“é•¿åº¦] -> ç å…ƒä¸²ä¹Šå¼‚ç«¯/[ç å…ƒ] -> ç å…ƒä¸²/[ç å…ƒ]

æ³¨æ°´è§£ç å†«çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒæ‰Œ/æ³¨æ°´æ‰Œ/åŠ ç›æ‰Œ :: é¡ºé’¥æ•°æ® -> åŒºå·ä¸²ä¹Šä½æ¬¡ä¿æŒ/[åŒºå·] -> çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ
å²›é“¾ï¼Œå­¤å²›ï¼Œå­¤ç 
åºå·ç›¸å…³ :: ((åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡,åºå·çºŸç å…ƒåŒ•å²›é“¾,åºå·çºŸç å…ƒåŒ•å­¤å²›),(åºå·çºŸå­¤å²›åŒ•æœ‰æ•ˆæ˜æ–‡,åºå·çºŸå­¤å²›åŒ•å²›é“¾),(åºå·çºŸå²›é“¾åŒ•æœ‰æ•ˆæ˜æ–‡,))
    çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ:å¯èƒ½åŒ…å«:
        æ˜æ–‡æœ‰æ•ˆé•¿åº¦/æ•°é‡çºŸæœ‰æ•ˆç å…ƒ
            [å›œæ–‡ == (æ˜æ–‡|å¯†æ–‡)]
        åºå·çºŸå²›é“¾åŒ•æœ‰æ•ˆæ˜æ–‡ -> [åºå·çºŸå­¤å²›åŒ•æœ‰æ•ˆæ˜æ–‡]
        åºå·çºŸå­¤å²›åŒ•æœ‰æ•ˆæ˜æ–‡ -> (é¦–åºå·,å°¾åºå·)/(åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡,åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡)
        åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡ -> (åŒºå·,åºå·ç›¸å…³)
            <<==åŒºå·ä¸²ä¹Šä½æ¬¡ä¿æŒ
    çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´:å¯èƒ½åŒ…å«:
        åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆå¯†æ–‡ -> (åŒºå·,åºå·ç›¸å…³)
        æ˜æ–‡æœ‰æ•ˆé•¿åº¦/æ•°é‡çºŸæœ‰æ•ˆç å…ƒ
æ˜æ–‡æ•´ä½“é•¿åº¦==å¯†æ–‡æ•´ä½“é•¿åº¦
æ˜æ–‡æœ‰æ•ˆé•¿åº¦==å¯†æ–‡æœ‰æ•ˆé•¿åº¦
æ˜æ–‡æœ‰æ•ˆé•¿åº¦==æ•°é‡çºŸæœ‰æ•ˆç å…ƒ==æ˜æ–‡æ•´ä½“é•¿åº¦-æ•°é‡çºŸæ— å…³ç å…ƒ

åŠ å¯†ç‰œåŒºå†…åŠ å¯†æ‰Œ :: çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ -> ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ/[ä½å·] -> (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ/[ä½å·])
*åŒºå†…åŠ å¯†ä¹Šå­¤ç æ‰Œ :: åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡ -> çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ -> ä½å· -> (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·)
*åŒºå†…åŠ å¯†ä¹Šå­¤å²›æ‰Œ :: åºå·çºŸå­¤å²›åŒ•æœ‰æ•ˆæ˜æ–‡ -> çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ -> ä½å·ä¸²çºŸå­¤å²›/[ä½å·] -> (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²çºŸå­¤å²›/[ä½å·])
*åŒºå†…åŠ å¯†ä¹Šå²›é“¾æ‰Œ :: åºå·çºŸå²›é“¾åŒ•æœ‰æ•ˆæ˜æ–‡ -> çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ -> ä½å·ä¸²çºŸå²›é“¾/[ä½å·] -> (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²çºŸå²›é“¾/[ä½å·])

ç´¢å¼•ç½®æ¢ç‰œé¡ºå‘ :: [uint%æ˜æ–‡æœ‰æ•ˆé•¿åº¦]
ç´¢å¼•ç½®æ¢ç‰œé€†å‘ :: [uint%æ˜æ–‡æœ‰æ•ˆé•¿åº¦]
ç´¢å¼•ç½®æ¢ç‰œé¡ºå‘==æ—§å€è® æ–°å€å†ƒç½®æ¢æ˜ å°„
ç´¢å¼•ç½®æ¢ç‰œé€†å‘==æ–°å€è® æ—§å€å†ƒç½®æ¢æ˜ å°„
ç´¢å¼•ç½®æ¢ç‰œé€†å‘==inv(ç´¢å¼•ç½®æ¢ç‰œé¡ºå‘)

æ˜“ä½æ‰Œ/æ´—ç‰Œæ‰Œ :: çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ -> (çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´, ç´¢å¼•ç½®æ¢ç‰œé¡ºå‘/[uint%æ˜æ–‡æœ‰æ•ˆé•¿åº¦])
    shuffle/permutation
è„±æ°´ç¼–ç å†«çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´æ‰Œ :: çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´ -> é€†é’¥æ•°æ®
æ³¨æ°´è§£ç å†«çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´æ‰Œ :: åŒºå·ä¸²ä¹Šä½æ¬¡å˜æ›´/[åŒºå·] -> é€†é’¥æ•°æ® -> çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´
å¤ä½æ‰Œ/è¿˜åŸæ‰Œ :: çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´ -> (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ç´¢å¼•ç½®æ¢ç‰œé€†å‘/[uint%æ˜æ–‡æœ‰æ•ˆé•¿åº¦])


è§£å¯†ç‰œåŒºå†…è§£å¯†æ‰Œ :: çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ -> ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ/[ä½å·] -> (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ/[ä½å·])
*åŒºå†…è§£å¯†ä¹Šå­¤ç æ‰Œ :: åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡ -> çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ -> ä½å· -> (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·)
*åŒºå†…è§£å¯†ä¹Šå­¤å²›æ‰Œ :: åºå·çºŸå­¤å²›åŒ•æœ‰æ•ˆæ˜æ–‡ -> çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ -> ä½å·ä¸²çºŸå­¤å²›/[ä½å·] -> (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²çºŸå­¤å²›/[ä½å·])
*åŒºå†…è§£å¯†ä¹Šå²›é“¾æ‰Œ :: åºå·çºŸå²›é“¾åŒ•æœ‰æ•ˆæ˜æ–‡ -> çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ -> ä½å·ä¸²çºŸå²›é“¾/[ä½å·] -> (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²çºŸå²›é“¾/[ä½å·])

    #]]]'''#'''
    __slots__ = ()

    @property
    @abstractmethod
    def åŒºä½é…ç½®(sf, /):
        '-> é­–åŒºä½é…ç½®'

    def ç»Ÿè®¡å†«æ˜æ–‡æœ‰æ•ˆé•¿åº¦ç‰œè‡ªå®šä¹‰æ•°æ®æ‰Œ(sf, å›œæ–‡æ•°æ®ç‰œè£¸, /):
        'å›œæ–‡æ•°æ®ç‰œè£¸/[ç å…ƒ] -> æ˜æ–‡æœ‰æ•ˆé•¿åº¦/uint'
        æ˜æ–‡æœ‰æ•ˆé•¿åº¦ = sum(map(bool, map(sf.åŒºä½é…ç½®.ç å…ƒè® é¬½åŒºä½å·æ‰Œ, å›œæ–‡æ•°æ®ç‰œè£¸)))
        return æ˜æ–‡æœ‰æ•ˆé•¿åº¦

    @abstractmethod
    def æ˜“ä½æ‰Œ(sf, çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, /, *, validate):
        'çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ -> (çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´, ç´¢å¼•ç½®æ¢ç‰œé¡ºå‘/[uint%æ˜æ–‡æœ‰æ•ˆé•¿åº¦])'
    @abstractmethod
    def å¤ä½æ‰Œ(sf, çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´, /):
        'çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´ -> (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ç´¢å¼•ç½®æ¢ç‰œé€†å‘/[uint%æ˜æ–‡æœ‰æ•ˆé•¿åº¦])'
    @abstractmethod
    def è„±æ°´ç¼–ç å†«çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´æ‰Œ(sf, çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´, /, *, validate):
        'çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´ -> é€†é’¥æ•°æ®'
    @abstractmethod
    def æ³¨æ°´è§£ç å†«çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´æ‰Œ(sf, åŒºå·ä¸²ä¹Šä½æ¬¡å˜æ›´, é€†é’¥æ•°æ®, /):
        'åŒºå·ä¸²ä¹Šä½æ¬¡å˜æ›´/[åŒºå·] -> é€†é’¥æ•°æ® -> çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´'
    @abstractmethod
    def æ³¨æ°´è§£ç å†«çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒæ‰Œ(sf, é¡ºé’¥æ•°æ®, åŒºå·ä¸²ä¹Šä½æ¬¡ä¿æŒ, /):
        'é¡ºé’¥æ•°æ® -> åŒºå·ä¸²ä¹Šä½æ¬¡ä¿æŒ/[åŒºå·] -> çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ'
        #æœ¬è¯¥:validate@è§£ç å‘  <<== æ­¤ä¹ƒåŠ å¯†å‘
        #   ä½†:æ²¡æœ‰ç›¸åº”çš„ç¼–ç ç‰ˆï¼

    @abstractmethod
    def åŠ å¯†ç‰œåŒºå†…åŠ å¯†æ‰Œ(sf, çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ, /, *, validate):
        'çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ -> ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ/[ä½å·] -> (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ/[ä½å·])'
    @abstractmethod
    def è§£å¯†ç‰œåŒºå†…è§£å¯†æ‰Œ(sf, çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ, /):
        'çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ -> ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ/[ä½å·] -> (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ/[ä½å·])'


    @override
    def åŠ å¯†å†«æ˜æ–‡æ•°æ®ç‰œè£¸æ‰Œ(sf, é¡ºé’¥æ•°æ®, æ˜æ–‡æ•°æ®ç‰œè£¸, /, *, validate):
        'é¡ºé’¥æ•°æ®/? -> æ˜æ–‡æ•°æ®ç‰œè£¸/? -> å¯†æ–‡æ•°æ®ç‰œè£¹/(é€†é’¥æ•°æ®,å¯†æ–‡æ•°æ®ç‰œè£¸)/(?,?)'
        _validate = mk_validate4sub_call_(validate)
        (åŒºä½å·ä¸²,åºå·ä¸²çºŸæœ‰æ•ˆç å…ƒåŒ•æ•´ä½“æ˜æ–‡) = sf.ç å…ƒä¸²è® æœ‰æ•ˆåŒºä½å·ä¸²è¾»åºå·ä¸²æ‰Œ(æ˜æ–‡æ•°æ®ç‰œè£¸)
        (åŒºå·ä¸²ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ) = map(tuple, unzip_pairs(åŒºä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ:=åŒºä½å·ä¸²))
        çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ = sf.æ³¨æ°´è§£ç å†«çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒæ‰Œ(é¡ºé’¥æ•°æ®, åŒºå·ä¸²ä¹Šä½æ¬¡ä¿æŒ)
        (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ) = sf.åŠ å¯†ç‰œåŒºå†…åŠ å¯†æ‰Œ(çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ, validate=_validate)
        (çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´, ç´¢å¼•ç½®æ¢ç‰œé¡ºå‘) = sf.æ˜“ä½æ‰Œ(çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, validate=_validate)
        åŒºä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ = tuple(zip(åŒºå·ä¸²ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ))
        æœ‰æ•ˆç å…ƒä¸²ä¹Šä½æ¬¡ä¿æŒ = sf.æœ‰æ•ˆç å…ƒä¸²å·›åŒºä½å·ä¸²æ‰Œ(åŒºä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ)
        æœ‰æ•ˆç å…ƒä¸²ä¹Šä½æ¬¡å˜æ›´ = ç½®æ¢æ‰Œ(ç´¢å¼•ç½®æ¢ç‰œé¡ºå‘, æœ‰æ•ˆç å…ƒä¸²ä¹Šä½æ¬¡ä¿æŒ)
        ç å…ƒä¸²ä¹Šä½æ¬¡å˜æ›´ = sf.ç å…ƒä¸²å·›æœ‰æ•ˆç å…ƒä¸²è¾»åºå·ä¸²è¾»ç å…ƒä¸²ä¹Šå¼‚ç«¯æ‰Œ(æœ‰æ•ˆç å…ƒä¸²ä¹Šä½æ¬¡å˜æ›´, åºå·ä¸²çºŸæœ‰æ•ˆç å…ƒåŒ•æ•´ä½“æ˜æ–‡, æ˜æ–‡æ•°æ®ç‰œè£¸)
        å¯†æ–‡æ•°æ®ç‰œè£¸ = ç å…ƒä¸²ä¹Šä½æ¬¡å˜æ›´
        é€†é’¥æ•°æ® = sf.è„±æ°´ç¼–ç å†«çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´æ‰Œ(çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´, validate=_validate)
        å¯†æ–‡æ•°æ®ç‰œè£¹ = (é€†é’¥æ•°æ®,å¯†æ–‡æ•°æ®ç‰œè£¸)
        if validate:
            if not sf.è‡ªè§£å¯†å†«å¯†æ–‡æ•°æ®ç‰œè£¹æ‰Œ(å¯†æ–‡æ•°æ®ç‰œè£¹) == (é€†é’¥æ•°æ®, æ˜æ–‡æ•°æ®ç‰œè£¸):raise Exception((sf, (é¡ºé’¥æ•°æ®, æ˜æ–‡æ•°æ®ç‰œè£¸), é€†é’¥æ•°æ®, (å¯†æ–‡æ•°æ®ç‰œè£¹)))
        return å¯†æ–‡æ•°æ®ç‰œè£¹
    @override
    def è‡ªè§£å¯†å†«å¯†æ–‡æ•°æ®ç‰œè£¹æ‰Œ(sf, å¯†æ–‡æ•°æ®ç‰œè£¹, /):
        'å¯†æ–‡æ•°æ®ç‰œè£¹/(é€†é’¥æ•°æ®,å¯†æ–‡æ•°æ®ç‰œè£¸)/(?,?) -> (é€†é’¥æ•°æ®, æ˜æ–‡æ•°æ®ç‰œè£¸)/(?,?)'
        (é€†é’¥æ•°æ®,å¯†æ–‡æ•°æ®ç‰œè£¸) = å¯†æ–‡æ•°æ®ç‰œè£¹
        (åŒºä½å·ä¸²,åºå·ä¸²çºŸæœ‰æ•ˆç å…ƒåŒ•æ•´ä½“å¯†æ–‡) = sf.ç å…ƒä¸²è® æœ‰æ•ˆåŒºä½å·ä¸²è¾»åºå·ä¸²æ‰Œ(å¯†æ–‡æ•°æ®ç‰œè£¸)
        åºå·ä¸²çºŸæœ‰æ•ˆç å…ƒåŒ•æ•´ä½“æ˜æ–‡ = åºå·ä¸²çºŸæœ‰æ•ˆç å…ƒåŒ•æ•´ä½“å¯†æ–‡
        åŒºå·ä¸²ä¹Šä½æ¬¡å˜æ›´ = tuple(map(fst, åŒºä½å·ä¸²ä¹Šä½æ¬¡å˜æ›´:=åŒºä½å·ä¸²))
        çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´ = sf.æ³¨æ°´è§£ç å†«çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´æ‰Œ(åŒºå·ä¸²ä¹Šä½æ¬¡å˜æ›´, é€†é’¥æ•°æ®)
        (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ç´¢å¼•ç½®æ¢ç‰œé€†å‘) = sf.å¤ä½æ‰Œ(çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´)
        åŒºä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ = ç½®æ¢æ‰Œ(ç´¢å¼•ç½®æ¢ç‰œé€†å‘, åŒºä½å·ä¸²ä¹Šä½æ¬¡å˜æ›´:=åŒºä½å·ä¸²)
        (åŒºå·ä¸²ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ) = map(tuple, unzip_pairs(åŒºä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ))

        (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ) = sf.è§£å¯†ç‰œåŒºå†…è§£å¯†æ‰Œ(çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ)
        åŒºä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ = tuple(zip(åŒºå·ä¸²ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ))
        æœ‰æ•ˆç å…ƒä¸²ä¹Šä½æ¬¡ä¿æŒ = sf.æœ‰æ•ˆç å…ƒä¸²å·›åŒºä½å·ä¸²æ‰Œ(åŒºä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ)
        ç å…ƒä¸²ä¹Šä½æ¬¡ä¿æŒ = sf.ç å…ƒä¸²å·›æœ‰æ•ˆç å…ƒä¸²è¾»åºå·ä¸²è¾»ç å…ƒä¸²ä¹Šå¼‚ç«¯æ‰Œ(æœ‰æ•ˆç å…ƒä¸²ä¹Šä½æ¬¡ä¿æŒ, åºå·ä¸²çºŸæœ‰æ•ˆç å…ƒåŒ•æ•´ä½“æ˜æ–‡, å¯†æ–‡æ•°æ®ç‰œè£¸)
        æ˜æ–‡æ•°æ®ç‰œè£¸ = ç å…ƒä¸²ä¹Šä½æ¬¡ä¿æŒ
        #xxx:ä¸ä¸€å®šæœ‰:é¡ºé’¥æ•°æ®
        return (é€†é’¥æ•°æ®,æ˜æ–‡æ•°æ®ç‰œè£¸)
    def ç å…ƒä¸²è® æœ‰æ•ˆåŒºä½å·ä¸²è¾»åºå·ä¸²æ‰Œ(sf, ç å…ƒä¸², /):
        '[ç å…ƒ] -> (åŒºä½å·ä¸²,åºå·ä¸²çºŸæœ‰æ•ˆç å…ƒåŒ•æ•´ä½“æ˜æ–‡)/([åŒºä½å·],[uint%æ˜æ–‡æ•´ä½“é•¿åº¦)'
        #è¿‡æ»¤æ‰:æ— å…³ç å…ƒ
        (åŒºä½å·ä¸²,åºå·ä¸²çºŸæœ‰æ•ˆç å…ƒåŒ•æ•´ä½“æ˜æ–‡) = map(tuple, unzip_pairs((åŒºä½å·,åºå·) for åºå·,é¬½åŒºä½å· in enumerate(map(sf.åŒºä½é…ç½®.ç å…ƒè® é¬½åŒºä½å·æ‰Œ, ç å…ƒä¸²)) if not (åŒºä½å·:=é¬½åŒºä½å·) is None))
        return (åŒºä½å·ä¸²,åºå·ä¸²çºŸæœ‰æ•ˆç å…ƒåŒ•æ•´ä½“æ˜æ–‡)
    def æœ‰æ•ˆç å…ƒä¸²å·›åŒºä½å·ä¸²æ‰Œ(sf, åŒºä½å·ä¸², /):
        '[åŒºä½å·] -> [ç å…ƒ]'
        æœ‰æ•ˆç å…ƒä¸² = tuple(map(sf.åŒºä½é…ç½®.ç å…ƒå·›åŒºä½å·æ‰Œ, åŒºä½å·ä¸²))
        return æœ‰æ•ˆç å…ƒä¸²
    def ç å…ƒä¸²å·›æœ‰æ•ˆç å…ƒä¸²è¾»åºå·ä¸²è¾»ç å…ƒä¸²ä¹Šå¼‚ç«¯æ‰Œ(sf, æœ‰æ•ˆç å…ƒä¸², åºå·ä¸²çºŸæœ‰æ•ˆç å…ƒåŒ•æ•´ä½“æ˜æ–‡, ç å…ƒä¸²ä¹Šå¼‚ç«¯, /):
        'æœ‰æ•ˆç å…ƒä¸²/[ç å…ƒ] -> åºå·ä¸²çºŸæœ‰æ•ˆç å…ƒåŒ•æ•´ä½“æ˜æ–‡/[uint%æ˜æ–‡æ•´ä½“é•¿åº¦] -> ç å…ƒä¸²ä¹Šå¼‚ç«¯/[ç å…ƒ] -> ç å…ƒä¸²/[ç å…ƒ]'
        if not len(æœ‰æ•ˆç å…ƒä¸²) == len(åºå·ä¸²çºŸæœ‰æ•ˆç å…ƒåŒ•æ•´ä½“æ˜æ–‡) <= len(ç å…ƒä¸²ä¹Šå¼‚ç«¯):raise TypeError
        def __():
            prev_j = -1
            it = iter(æœ‰æ•ˆç å…ƒä¸²)
            for j in åºå·ä¸²çºŸæœ‰æ•ˆç å…ƒåŒ•æ•´ä½“æ˜æ–‡:
                yield from ç å…ƒä¸²ä¹Šå¼‚ç«¯[prev_j+1:j]
                    #ä¸åŠ¨ç‚¹@gap
                    #===åƒçºŸä¸åŠ¨ç‚¹@gap
                yield next(it)
                    #åƒçºŸåŠ¨ç‚¹@j
                prev_j = j
            else:
                j = æ˜æ–‡æ•´ä½“é•¿åº¦ = len(ç å…ƒä¸²ä¹Šå¼‚ç«¯)
                yield from ç å…ƒä¸²ä¹Šå¼‚ç«¯[prev_j+1:j]
                    #ä¸åŠ¨ç‚¹@gap
                    #===åƒçºŸä¸åŠ¨ç‚¹@gap
        ç å…ƒä¸² = tuple(__())
        return ç å…ƒä¸²

def ç½®æ¢æ‰Œ(æ—§å€è® æ–°å€å†ƒç½®æ¢æ˜ å°„, è¾“å…¥ä¸², /):
    'j_new5j_old/[uint%L]{len=L} -> [c]{len=L} -> [c]{len=L}'
    j_new5j_old = æ—§å€è® æ–°å€å†ƒç½®æ¢æ˜ å°„
    j_new2j_old = inverse_uint_bijection_array(j_new5j_old)
    L = len(j_new2j_old)
    if not len(è¾“å…¥ä¸²) == L:raise TypeError
    è¾“å‡ºä¸² = tuple(è¾“å…¥ä¸²[j_new2j_old[j]] for j in range(L))
    return è¾“å‡ºä¸²

class é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œè‡ªå®šä¹‰æ•°æ®ç‰œåŒºå†…å˜æ¢ä¹Šå­¤ç (é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œè‡ªå®šä¹‰æ•°æ®ç‰œåŒºå†…å˜æ¢):
    __slots__ = ()
    @abstractmethod
    def åŒºå†…åŠ å¯†ä¹Šå­¤ç æ‰Œ(sf, åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡, çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·, /, *, validate):
        'åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡ -> çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ -> ä½å· -> (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·)'
    @abstractmethod
    def åŒºå†…è§£å¯†ä¹Šå­¤ç æ‰Œ(sf, åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡, çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·, /):
        'åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡ -> çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ -> ä½å· -> (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·)'

    @override
    def åŠ å¯†ç‰œåŒºå†…åŠ å¯†æ‰Œ(sf, çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ, /, *, validate):
        'çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ -> ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ/[ä½å·] -> (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ/[ä½å·])'
        _validate = mk_validate4sub_call_(validate)
        (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ_, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ_) = (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ)
        ls = []
        for (åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡, ä½å·) in enumerate(ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ):
            (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·) = sf.åŒºå†…åŠ å¯†ä¹Šå­¤ç æ‰Œ(åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡, çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·, validate=_validate)
            ls.append(ä½å·)
        çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ
        ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ = tuple(ls)
        (_çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, _ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ) = (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ)
        if validate:
            if not sf.è§£å¯†ç‰œåŒºå†…è§£å¯†æ‰Œ(_çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, _ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ) == (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ_, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ_):raise Exception((sf, (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ_, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ_), (_çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, _ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ)))
        return (_çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, _ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ)

    @override
    def è§£å¯†ç‰œåŒºå†…è§£å¯†æ‰Œ(sf, çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ, /):
        'çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ -> ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ/[ä½å·] -> (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ/[ä½å·])'
        ls = []
        for (åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡, ä½å·) in zip(range(len(ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ))[::-1], reversed(ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ)):
            (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·) = sf.åŒºå†…è§£å¯†ä¹Šå­¤ç æ‰Œ(åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡, çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·)
            ls.append(ä½å·)
        ls.reverse() #bug:once miss this line
        çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ
        ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ = tuple(ls)
        return (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·ä¸²ä¹Šä½æ¬¡ä¿æŒ)


class é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬æ°ºè‡ªå®šä¹‰æ•°æ®ç‰œåŒºå†…å˜æ¢(é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œè‡ªå®šä¹‰æ•°æ®ç‰œåŒºå†…å˜æ¢, é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬æ°ºè‡ªå®šä¹‰æ•°æ®):
    __slots__ = ()
    @abstractmethod
    def ç»Ÿè®¡å†«æ˜æ–‡æœ‰æ•ˆé•¿åº¦ç‰œæ–‡æœ¬æ‰Œ(sf, å›œæ–‡æ–‡æœ¬ç‰œè£¸, /):
        'å›œæ–‡æ–‡æœ¬ç‰œè£¸/str -> æ˜æ–‡æœ‰æ•ˆé•¿åº¦/uint'
        # æœªçŸ¥:å…³ç³»(ç å…ƒ,å­—ç¬¦)
        #å›œæ–‡æ•°æ®ç‰œè£¸ = sf.???(å›œæ–‡æ–‡æœ¬ç‰œè£¸)
        #æ˜æ–‡æœ‰æ•ˆé•¿åº¦ = sf.ç»Ÿè®¡å†«æ˜æ–‡æœ‰æ•ˆé•¿åº¦ç‰œè‡ªå®šä¹‰æ•°æ®æ‰Œ(å›œæ–‡æ•°æ®ç‰œè£¸)
        #return æ˜æ–‡æœ‰æ•ˆé•¿åº¦
    pass
class é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬æ°ºè‡ªå®šä¹‰æ•°æ®ç‰œåŒºå†…å˜æ¢ä¹Šå­¤ç (é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œè‡ªå®šä¹‰æ•°æ®ç‰œåŒºå†…å˜æ¢ä¹Šå­¤ç , é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬æ°ºè‡ªå®šä¹‰æ•°æ®ç‰œåŒºå†…å˜æ¢):
    __slots__ = ()
    pass





class é­–åŒ´è½¬ä¹‰å†«æ–‡æœ¬(ABC):
    r'''[[[
    'æ— :å¸¦å¤–ç¬¦å·/è¶…ç¬¦'
        è§:é­–åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬
    ===
    é¿å…:ç±»ä¼¼c/pyçš„ç¼–ç æ–¹æ¡ˆ:
        å› ä¸º:å¯¼è‡´å¤šæ¬¡è½¬ä¹‰åé•¿åº¦æŒ‡æ•°å‹çˆ†ç‚¸ï¼
        ã€\ã€-->ã€\\ã€-->ã€\\\\ã€-->ã€\\\\\\\\ã€-->ã€\\\\\\\\\\\\\\\\ã€
    ç®€å•çš„é¿å…æ–¹æ¡ˆ:
        ã€!?ã€-->ã€!?.ã€-->ã€!?..ã€-->ã€!?...ã€-->ã€!?....ã€
    #]]]'''#'''
    __slots__ = ()
    @abstractmethod
    def è½¬ä¹‰å†«æ–‡æœ¬æ‰Œ(sf, æ–‡æœ¬ä¹Šè½¬ä¹‰å‰, /):
        'æ–‡æœ¬ä¹Šè½¬ä¹‰å‰/str -> æ–‡æœ¬ä¹Šè½¬ä¹‰å/str'
    @abstractmethod
    def è¿˜åŸå†«æ–‡æœ¬æ‰Œ(sf, æ–‡æœ¬ä¹Šè½¬ä¹‰å, /):
        'æ–‡æœ¬ä¹Šè½¬ä¹‰å/str -> æ–‡æœ¬ä¹Šè½¬ä¹‰å‰/str'
class é­–åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬(ABC):
    r'''[[[
    'å…è®¸å«:å¸¦å¤–ç¬¦å·/è¶…ç¬¦'
        è§:é­–åŒ´è½¬ä¹‰å†«æ–‡æœ¬
    [è¶…ç¬¦ may be str]
    [è¶…æ–‡æœ¬ :: [æ–‡æœ¬{éç©ºunless[ç´¢å¼•==0]} if ç´¢å¼•%2==0 else éç©ºè¶…ç¬¦ä¸²]]
    [éæ ‡å‡†å‹è¶…æ–‡æœ¬ :: [(æ¬¤è¶…ç¬¦ä¸², (æ–‡æœ¬|è¶…ç¬¦ä¸²))]/[(bool,(str|[è¶…ç¬¦]))]]
        # [è´Ÿè½½ç‰œè£¹è£¹çºŸæ–‡æœ¬ == '!?{è´Ÿè½½ç‰œè£¹çºŸæ–‡æœ¬}' == '!?[^(^]' | '!?(.*)']
        # [è´Ÿè½½ç‰œè£¹çºŸæ–‡æœ¬ == (å•å­—ç¬¦/è´Ÿè½½ç‰œè£¸çºŸæ–‡æœ¬ | '({è´Ÿè½½ç‰œè£¸çºŸæ–‡æœ¬})') == (å•å­—ç¬¦/'[^(^]' | '(.*)')]
        # [è´Ÿè½½ç‰œè£¹è£¹çºŸè¶…ç¬¦ä¸² == '!?^{è´Ÿè½½ç‰œè£¹çºŸè¶…ç¬¦ä¸²}' == '!?^[:all:]' | '!?^(.*)']
        # [è´Ÿè½½ç‰œè£¹çºŸè¶…ç¬¦ä¸² == (å•å­—ç¬¦/è´Ÿè½½ç‰œè£¸çºŸè¶…ç¬¦ä¸² | '({è´Ÿè½½ç‰œè£¸çºŸè¶…ç¬¦ä¸²})') == (å•å­—ç¬¦/'[[:all:]]' | '(.*)')]
    ===
    é¿å…:ç±»ä¼¼c/pyçš„ç¼–ç æ–¹æ¡ˆ:
        å› ä¸º:å¯¼è‡´å¤šæ¬¡è½¬ä¹‰åé•¿åº¦æŒ‡æ•°å‹çˆ†ç‚¸ï¼
        ã€\ã€-->ã€\\ã€-->ã€\\\\ã€-->ã€\\\\\\\\ã€-->ã€\\\\\\\\\\\\\\\\ã€
    ç®€å•çš„é¿å…æ–¹æ¡ˆ:
        ã€!?ã€-->ã€!?.ã€-->ã€!?..ã€-->ã€!?...ã€-->ã€!?....ã€
    #]]]'''#'''
    #å‰ç¼€çºŸè¶…ç¬¦:ç‰¹æ®Šè´Ÿè½½å‰ç¼€:å˜é•¿è´Ÿè½½orå®šé•¿è´Ÿè½½
    __slots__ = ()
    @abstractmethod
    def è½¬ä¹‰å†«è¶…æ–‡æœ¬æ‰Œ(sf, è¶…æ–‡æœ¬ä¹Šè½¬ä¹‰å‰, /):
        'è¶…æ–‡æœ¬ -> æ–‡æœ¬/str'
    @abstractmethod
    def è¿˜åŸå†«è¶…æ–‡æœ¬æ‰Œ(sf, è¶…æ–‡æœ¬ä¹Šè½¬ä¹‰å, /):
        'æ–‡æœ¬/str -> è¶…æ–‡æœ¬'
class ä¹¸åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°(é­–åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬):
    'æç®€ç‰ˆ:[è¶…ç¬¦ :: str]'
    ___no_slots_ok___ = True
    ######################
    ######################
    ######################
    def __init__(sf, /, *
        , å­—ç¬¦ä¸²å†ƒè½¬ä¹‰åºåˆ—å‰ç¼€='!?'
        , èµ·å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½='('
        , è®«å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½=')'
        , å¤´å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½çºŸè¶…ç¬¦ä¸²='^'
        , éš”å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½çºŸè¶…ç¬¦ä¸²=','
        , ç¼–ç å‘å†«è´Ÿè½½å­—ç¬¦ä¸²çºŸè½¬ä¹‰åºåˆ—å‰ç¼€='.'
        , ç¼–ç å‘å†«åŸå­—ç¬¦è® è´Ÿè½½å­—ç¬¦ä¸²={'\a':'a','\b':'b','\f':'f','\n':'n','\r':'r','\t':'t','\v':'v','\0':'0',' ':'-','ã€€':'='}
        , è§£ç å‘å†«è´Ÿè½½å­—ç¬¦ä¸²è® åŸå­—ç¬¦={'a':'\a','b':'\b','f':'\f','n':'\n','r':'\r','t':'\t','v':'\v','0':'\0','-':' ','=':'ã€€'}
        , è§£ç å‘å†«é¬½åå¤‡è§£ç å™¨çºŸè´Ÿè½½å­—ç¬¦ä¸²=None
        #, è§£ç å‘å†«è¶…ç¬¦å·›è´Ÿè½½å­—ç¬¦ä¸²æ‰Œ=echo
        ):
        'æç®€:è´Ÿè½½ä¸ºå•å­—ç¬¦æˆ–å˜é•¿è´Ÿè½½ï¼›é™¤äº†ã€è½¬ä¹‰åºåˆ—å‰ç¼€ã€å¤–ï¼Œåªè½¬ä¹‰å•å­—ç¬¦(ç¼–ç æ—¶ä¸å†ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼)'
        # abfnrtv0:\n... + 2 spaces
        # ã€\ã€-->ã€!?ã€-->ã€!?.ã€
        # ã€\xhhã€-->ã€!?(xhh)ã€-->è§£ç å‘å†«é¬½åå¤‡è§£ç å™¨çºŸè´Ÿè½½å­—ç¬¦ä¸²('xhh')
        d = dict(locals())
        del d['sf']
        sf.__dict__.update(d)
        sf._kwds = d
        assert å­—ç¬¦ä¸²å†ƒè½¬ä¹‰åºåˆ—å‰ç¼€
        #assert ç¼–ç å‘å†«è´Ÿè½½å­—ç¬¦ä¸²çºŸè½¬ä¹‰åºåˆ—å‰ç¼€
        assert èµ·å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½
        assert è®«å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½
        assert å¤´å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½çºŸè¶…ç¬¦ä¸²
        assert éš”å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½çºŸè¶…ç¬¦ä¸²
        assert all(len(ch)==1 for ch in ç¼–ç å‘å†«åŸå­—ç¬¦è® è´Ÿè½½å­—ç¬¦ä¸²)
        ...
    def __repr__(sf, /):
        args = ()
        kwargs = sf._kwds
        return repr_helper(sf, *args, **kwargs)

    def è¿˜åŸå†«è´Ÿè½½çºŸè¶…ç¬¦ä¸²æ‰Œ(sf, è´Ÿè½½ç‰œè£¸çºŸè¶…ç¬¦ä¸², /):
        'è´Ÿè½½ç‰œè£¸çºŸè¶…ç¬¦ä¸² -> è¶…ç¬¦ä¸²'
        è¶…ç¬¦ä¸² = tuple(è´Ÿè½½ç‰œè£¸çºŸè¶…ç¬¦ä¸².split(sf.éš”å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½çºŸè¶…ç¬¦ä¸²))
        return è¶…ç¬¦ä¸²
    def è¿˜åŸå†«è´Ÿè½½çºŸæ–‡æœ¬æ‰Œ(sf, è´Ÿè½½ç‰œè£¸çºŸæ–‡æœ¬, /):
        'è´Ÿè½½ç‰œè£¸çºŸæ–‡æœ¬ -> åŸå­—ç¬¦ä¸²'
        if è´Ÿè½½ç‰œè£¸çºŸæ–‡æœ¬ == sf.ç¼–ç å‘å†«è´Ÿè½½å­—ç¬¦ä¸²çºŸè½¬ä¹‰åºåˆ—å‰ç¼€:
            m = sf.å­—ç¬¦ä¸²å†ƒè½¬ä¹‰åºåˆ—å‰ç¼€
        else:
            m = sf.è§£ç å‘å†«è´Ÿè½½å­—ç¬¦ä¸²è® åŸå­—ç¬¦.get(è´Ÿè½½ç‰œè£¸çºŸæ–‡æœ¬)
        m
        if m is None:
            if None is sf.è§£ç å‘å†«é¬½åå¤‡è§£ç å™¨çºŸè´Ÿè½½å­—ç¬¦ä¸²:
                raise Exception(f'è§£ç å¤±è´¥:è´Ÿè½½ç‰œè£¸çºŸæ–‡æœ¬={è´Ÿè½½ç‰œè£¸çºŸæ–‡æœ¬!r}')
            åŸå­—ç¬¦ä¸² = sf.è§£ç å‘å†«é¬½åå¤‡è§£ç å™¨çºŸè´Ÿè½½å­—ç¬¦ä¸²(è´Ÿè½½ç‰œè£¸çºŸæ–‡æœ¬)
        else:
            åŸå­—ç¬¦ä¸² = m
        return åŸå­—ç¬¦ä¸²
    def å°è£…å†«è´Ÿè½½å·›è¶…ç¬¦ä¸²æ‰Œ(sf, è¶…ç¬¦ä¸², /, *, validate):
        'è¶…ç¬¦ä¸² -> è´Ÿè½½ç‰œè£¹è£¹çºŸè¶…ç¬¦ä¸²'
        _validate = mk_validate4sub_call_(validate)
        #xxx:if not è¶…ç¬¦ä¸²
        è´Ÿè½½ç‰œè£¸çºŸè¶…ç¬¦ä¸² = sf.éš”å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½çºŸè¶…ç¬¦ä¸².join(è¶…ç¬¦ä¸²)
        è´Ÿè½½ç‰œè£¹è£¹çºŸè¶…ç¬¦ä¸² = sf.å°è£…å†«è´Ÿè½½çºŸæ–‡æœ¬æ‰Œ(è´Ÿè½½ç‰œè£¸çºŸè¶…ç¬¦ä¸², head=sf.å¤´å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½çºŸè¶…ç¬¦ä¸², validate=_validate)
        if validate:
            #xxx:if not sf.è¿˜åŸå†«è´Ÿè½½çºŸæ–‡æœ¬æ‰Œ(è´Ÿè½½) == ():raise Exception((sf, (), ()))
            #æ²¡æœ‰ç›¸åº”çš„è§£ç ç‰ˆï¼
            pass
        return è´Ÿè½½ç‰œè£¹è£¹çºŸè¶…ç¬¦ä¸²
    def å°è£…å†«è´Ÿè½½çºŸæ–‡æœ¬æ‰Œ(sf, è´Ÿè½½ç‰œè£¸çºŸæ–‡æœ¬, /, *, validate, head=''):
        'è´Ÿè½½ç‰œè£¸çºŸæ–‡æœ¬ -> è´Ÿè½½ç‰œè£¹è£¹çºŸæ–‡æœ¬'
        _validate = mk_validate4sub_call_(validate)
        if len(è´Ÿè½½ç‰œè£¸çºŸæ–‡æœ¬) == 1:
            assert not è´Ÿè½½ç‰œè£¸çºŸæ–‡æœ¬ == sf.èµ·å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½[0]
            è´Ÿè½½ç‰œè£¹çºŸæ–‡æœ¬ = å•å­—ç¬¦è´Ÿè½½ = è´Ÿè½½ç‰œè£¸çºŸæ–‡æœ¬
        else:
            è´Ÿè½½ç‰œè£¹çºŸæ–‡æœ¬ = f'{sf.èµ·å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½}{è´Ÿè½½ç‰œè£¸çºŸæ–‡æœ¬}{sf.è®«å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½}'
        è´Ÿè½½ç‰œè£¹çºŸæ–‡æœ¬
        è´Ÿè½½ç‰œè£¹è£¹çºŸæ–‡æœ¬ = f'{sf.å­—ç¬¦ä¸²å†ƒè½¬ä¹‰åºåˆ—å‰ç¼€}{head}{è´Ÿè½½ç‰œè£¹çºŸæ–‡æœ¬}'
        if validate:
            #xxx:if not sf.è¿˜åŸå†«è´Ÿè½½çºŸæ–‡æœ¬æ‰Œ(è´Ÿè½½?) == ():raise Exception((sf, (), ()))
            #æ²¡æœ‰ç›¸åº”çš„è§£ç ç‰ˆï¼
            pass
        return è´Ÿè½½ç‰œè£¹è£¹çºŸæ–‡æœ¬
    def æ£€æŸ¥å†«è¶…æ–‡æœ¬æ‰Œ(sf, è¶…æ–‡æœ¬, /):
        'æ ‡å‡†å‹#å¹¶æœ€å°‘ç©ºä¸²'
        ######################
        è¶…æ–‡æœ¬[:0] # seq?
        ######################
        for x in è¶…æ–‡æœ¬[0::2]:
            check_type_is(str, x)
        for x in è¶…æ–‡æœ¬[1::2]:
            check_type_is(tuple, x)
            for y in x:
                check_type_is(str, y)
        ######################
        for è¶…ç¬¦ä¸² in è¶…æ–‡æœ¬[1::2]:
            for è¶…ç¬¦ in è¶…ç¬¦ä¸²:
                if not è¶…ç¬¦:raise Exception #å°è£…æ—¶ä¼šäº§ç”Ÿæ­§ä¹‰ï¼
        ######################
        ss = (sf.å­—ç¬¦ä¸²å†ƒè½¬ä¹‰åºåˆ—å‰ç¼€, sf.éš”å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½çºŸè¶…ç¬¦ä¸², sf.è®«å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½)
        for è¶…ç¬¦ä¸² in è¶…æ–‡æœ¬[1::2]:
            for è¶…ç¬¦ in è¶…ç¬¦ä¸²:
                for s in ss:
                    if s in è¶…ç¬¦:raise Exception(è¶…ç¬¦)
        ######################
        if len(è¶…æ–‡æœ¬) == 1 and not è¶…æ–‡æœ¬[0]:raise Exception((0, è¶…æ–‡æœ¬))
        it = iter(è¶…æ–‡æœ¬)
        _ = next(it, 000)
        for j, x in enumerate(it, 1):
            if not x:raise Exception((j, è¶…æ–‡æœ¬))
        ######################

    @override
    def è½¬ä¹‰å†«è¶…æ–‡æœ¬æ‰Œ(sf, è¶…æ–‡æœ¬, /, *, validate):
        'è¶…æ–‡æœ¬ -> æ–‡æœ¬/str'
        sf.æ£€æŸ¥å†«è¶…æ–‡æœ¬æ‰Œ(è¶…æ–‡æœ¬)
        _validate = mk_validate4sub_call_(validate)
        z = sf.å°è£…å†«è´Ÿè½½çºŸæ–‡æœ¬æ‰Œ(sf.ç¼–ç å‘å†«è´Ÿè½½å­—ç¬¦ä¸²çºŸè½¬ä¹‰åºåˆ—å‰ç¼€, validate=_validate)
        def _h():
            #return z.join(s for j,x in enumerate(è¶…æ–‡æœ¬) for s in (_f1 if (æ¬¤è¶…ç¬¦ä¸²:=j&1) else _f0)(x))
                #SyntaxError: assignment expression cannot be used in a comprehension iterable expression
            return ''.join(f(x) for f,x in zip(cycle_([_f0, _f1]), è¶…æ–‡æœ¬))
            return ''.join(s for j,x in enumerate(è¶…æ–‡æœ¬) for s in (_f1 if (j&1) else _f0)(x)) # (æ¬¤è¶…ç¬¦ä¸²:=j&1)
        def _f1(è¶…ç¬¦ä¸², /):
            '-> éƒ¨åˆ†æ–‡æœ¬ä¹Šè½¬ä¹‰å'
            éƒ¨åˆ†æ–‡æœ¬ä¹Šè½¬ä¹‰å = sf.å°è£…å†«è´Ÿè½½å·›è¶…ç¬¦ä¸²æ‰Œ(è¶…ç¬¦ä¸², validate=_validate)
            #if 0b0000:print_err(repr(éƒ¨åˆ†æ–‡æœ¬ä¹Šè½¬ä¹‰å))
            return éƒ¨åˆ†æ–‡æœ¬ä¹Šè½¬ä¹‰å
        def _f0(æ–‡æœ¬ä¹Šè½¬ä¹‰å‰, /):
            '-> éƒ¨åˆ†æ–‡æœ¬ä¹Šè½¬ä¹‰å'
            éƒ¨åˆ†æ–‡æœ¬ä¹Šè½¬ä¹‰å = z.join(_f00(æ–‡æœ¬ä¹Šè½¬ä¹‰å‰))
            return éƒ¨åˆ†æ–‡æœ¬ä¹Šè½¬ä¹‰å
        def _f00(æ–‡æœ¬ä¹Šè½¬ä¹‰å‰, /):
            '-> Iter éƒ¨åˆ†æ–‡æœ¬ä¹Šè½¬ä¹‰å'
            for s in æ–‡æœ¬ä¹Šè½¬ä¹‰å‰.split(sf.å­—ç¬¦ä¸²å†ƒè½¬ä¹‰åºåˆ—å‰ç¼€):
                éƒ¨åˆ†æ–‡æœ¬ä¹Šè½¬ä¹‰å = ''.join(_g(s))
                #if 0b0000:print_err(repr(éƒ¨åˆ†æ–‡æœ¬ä¹Šè½¬ä¹‰å))
                yield éƒ¨åˆ†æ–‡æœ¬ä¹Šè½¬ä¹‰å
        def _g(s, /):
            '-> Iter (è½¬ä¹‰åºåˆ—|åŸå­—ç¬¦)'
            for ch in s:
                m = sf.ç¼–ç å‘å†«åŸå­—ç¬¦è® è´Ÿè½½å­—ç¬¦ä¸².get(ch)
                t = ch if m is None else sf.å°è£…å†«è´Ÿè½½çºŸæ–‡æœ¬æ‰Œ(è´Ÿè½½:=m, validate=_validate)
                yield t
        #if 0b0000:print_err(æ–‡æœ¬ä¹Šè½¬ä¹‰å‰)
        #if 0b0000:print_err(æ–‡æœ¬ä¹Šè½¬ä¹‰å‰.split(sf.å­—ç¬¦ä¸²å†ƒè½¬ä¹‰åºåˆ—å‰ç¼€))
        æ–‡æœ¬ä¹Šè½¬ä¹‰å = _h()
        #if 0b0000:print_err(æ–‡æœ¬ä¹Šè½¬ä¹‰å)
        if validate:
            è¶…æ–‡æœ¬ç‰œå»é™¤å°¾é›¶ = [*è¶…æ–‡æœ¬]
            while è¶…æ–‡æœ¬ç‰œå»é™¤å°¾é›¶ and not è¶…æ–‡æœ¬ç‰œå»é™¤å°¾é›¶[-1]:
                è¶…æ–‡æœ¬ç‰œå»é™¤å°¾é›¶.pop()
            if not (r:=[*sf.è¿˜åŸå†«è¶…æ–‡æœ¬æ‰Œ(æ–‡æœ¬ä¹Šè½¬ä¹‰å)]) == è¶…æ–‡æœ¬ç‰œå»é™¤å°¾é›¶:raise Exception((sf, è¶…æ–‡æœ¬, æ–‡æœ¬ä¹Šè½¬ä¹‰å, (è¶…æ–‡æœ¬ç‰œå»é™¤å°¾é›¶,r)))
        return æ–‡æœ¬ä¹Šè½¬ä¹‰å
    @override
    def è¿˜åŸå†«è¶…æ–‡æœ¬æ‰Œ(sf, æ–‡æœ¬, /):
        'æ–‡æœ¬/str -> è¶…æ–‡æœ¬'
        check_type_is(str, æ–‡æœ¬)
        def _h():
            '-> è¶…æ–‡æœ¬'
            lsls = [['']]
            def put_meta_(è¶…ç¬¦ä¸², /):
                if len(lsls)&1:
                    lsls.append([])
                lsls[-1].extend(è¶…ç¬¦ä¸²)
            def put_str_(æ–‡æœ¬, /):
                if not len(lsls)&1:
                    lsls.append([])
                lsls[-1].append(æ–‡æœ¬)
            def _fill_lsls():
                #for æ¬¤è¶…ç¬¦ä¸², it in group_by(_f(), key=fst, container=iter):
                for æ¬¤è¶…ç¬¦ä¸², x in _f():
                    if not x:
                        pass
                    elif æ¬¤è¶…ç¬¦ä¸²:
                        è¶…ç¬¦ä¸² = x
                        put_meta_(è¶…ç¬¦ä¸²)
                    else:
                        æ–‡æœ¬ = x
                        put_str_(æ–‡æœ¬)
            _fill_lsls()
            lsls
            è¶…æ–‡æœ¬ = tuple(f(ls) for ls, f in zip(lsls, cycle_([''.join, tuple])))
            if è¶…æ–‡æœ¬ == ('',):
                è¶…æ–‡æœ¬ = ()
            return è¶…æ–‡æœ¬
        def _f():
            '-> Iter (æ¬¤è¶…ç¬¦ä¸², (æ–‡æœ¬|è¶…ç¬¦ä¸²))'
            first = True
            for s in æ–‡æœ¬.split(sf.å­—ç¬¦ä¸²å†ƒè½¬ä¹‰åºåˆ—å‰ç¼€):
                if first:
                    first = False
                    yield (æ¬¤è¶…ç¬¦ä¸²:=False,s)
                else:
                    yield from _g(s)
        def _g(s, /):
            '-> Iter (æ¬¤è¶…ç¬¦ä¸², (æ–‡æœ¬|è¶…ç¬¦ä¸²))'
            h0 = 0
            if s.startswith(sf.å¤´å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½çºŸè¶…ç¬¦ä¸²):
                h0 = len(sf.å¤´å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½çºŸè¶…ç¬¦ä¸²)

            if h0==0 and s.startswith(sf.ç¼–ç å‘å†«è´Ÿè½½å­—ç¬¦ä¸²çºŸè½¬ä¹‰åºåˆ—å‰ç¼€):
                i = h0
                j = len(sf.ç¼–ç å‘å†«è´Ÿè½½å­—ç¬¦ä¸²çºŸè½¬ä¹‰åºåˆ—å‰ç¼€)
                end = j+0
            elif s.startswith(sf.èµ·å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½, h0):
                i = h0+len(sf.èµ·å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½)
                j = s.index(sf.è®«å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½, i)
                end = j + len(sf.è®«å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½)
            else:
                i = h0
                j = i+1
                end = j+0
            h0, i, j, end
            æ¬¤è¶…ç¬¦ä¸² = bool(h0)
            è´Ÿè½½ç‰œè£¸çºŸå›œå›œå›œ = s[i:j]
            å…¶ä½™çºŸä¸åŠ¨ä¸² = s[end:]

            if æ¬¤è¶…ç¬¦ä¸²:
                è¶…ç¬¦ä¸² = sf.è¿˜åŸå†«è´Ÿè½½çºŸè¶…ç¬¦ä¸²æ‰Œ(è´Ÿè½½ç‰œè£¸çºŸè¶…ç¬¦ä¸²:=è´Ÿè½½ç‰œè£¸çºŸå›œå›œå›œ)
                yield (æ¬¤è¶…ç¬¦ä¸², è¶…ç¬¦ä¸²)
            else:
                åŸå­—ç¬¦ä¸² = sf.è¿˜åŸå†«è´Ÿè½½çºŸæ–‡æœ¬æ‰Œ(è´Ÿè½½ç‰œè£¸çºŸæ–‡æœ¬:=è´Ÿè½½ç‰œè£¸çºŸå›œå›œå›œ)
                yield (æ¬¤è¶…ç¬¦ä¸², åŸå­—ç¬¦ä¸²)
            yield (æ¬¤è¶…ç¬¦ä¸²:=False,å…¶ä½™çºŸä¸åŠ¨ä¸²)
        try:
            è¶…æ–‡æœ¬ = _h()
        except:
            raise Exception(æ–‡æœ¬)
        return è¶…æ–‡æœ¬
#class ä¹¸åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°(é­–åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬):
åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç° = ä¹¸åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°()






class ä¹¸åŒ´è½¬ä¹‰å†«æ–‡æœ¬ç‰œæç®€å…·ç°(é­–åŒ´è½¬ä¹‰å†«æ–‡æœ¬):
    'æç®€ç‰ˆ'
    ___no_slots_ok___ = True
    ######################
    ######################
    ######################
    r'''[[[
    def __init__(sf, /, *, å­—ç¬¦ä¸²çºŸè½¬ä¹‰='!', è´Ÿè½½å­—ç¬¦å†ƒè½¬ä¹‰='.', è´Ÿè½½å­—ç¬¦å†ƒç©ºæ ¼='_', è´Ÿè½½å­—ç¬¦å†ƒæ¢è¡Œ='n', è´Ÿè½½å­—ç¬¦å†ƒåˆ¶è¡¨='t', èµ·å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½='(', è®«å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½=')'):
        ...
    def __init__(sf, /, *, å­—ç¬¦ä¸²å†ƒè½¬ä¹‰åºåˆ—å‰ç¼€='!', ç¼–ç å‘å†«åŸä¸²è® è´Ÿè½½å­—ç¬¦ä¸²={}, ç¼–ç å‘å†«æ­£åˆ™è¡¨è¾¾å¼çºŸå‰ç¼€è® æ­£åˆ™è¡¨è¾¾å¼çºŸåŸä¸²è® ç¼–ç å™¨={}, è§£ç å‘å†«è´Ÿè½½å­—ç¬¦ä¸²è® åŸä¸²={}, è§£ç å‘å†«æ­£åˆ™è¡¨è¾¾å¼çºŸå‰ç¼€è® æ­£åˆ™è¡¨è¾¾å¼çºŸè´Ÿè½½å­—ç¬¦ä¸²è® è§£ç å™¨={}):
        #å˜é•¿è´Ÿè½½vså®šé•¿è´Ÿè½½
        #   !(...)
        #   !â‘·xxxx
        ...
    def __init__(sf, /, *, å­—ç¬¦ä¸²å†ƒè½¬ä¹‰åºåˆ—å‰ç¼€='!', èµ·å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½='(', è®«å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½=')', ç¼–ç å‘å†«åŸå­—ç¬¦è® è´Ÿè½½å­—ç¬¦ä¸²={'!':'.'}, ç¼–ç å‘å†«æ­£åˆ™è¡¨è¾¾å¼çºŸè½¬ä¹‰åºåˆ—å‰ç¼€ç›¸å…³åŸä¸²è¾»ç¼–ç å™¨=('!', '!.'), è§£ç å‘å†«è´Ÿè½½å­—ç¬¦ä¸²è® åŸå­—ç¬¦={'.':'!'}, è§£ç å‘å†«æ­£åˆ™è¡¨è¾¾å¼çºŸå‰ç¼€è® æ­£åˆ™è¡¨è¾¾å¼çºŸè´Ÿè½½å­—ç¬¦ä¸²è® è§£ç å™¨={}):
        'ç®€åŒ–:è´Ÿè½½ä¸ºå•å­—ç¬¦æˆ–å˜é•¿è´Ÿè½½ï¼›é™¤äº†ã€è½¬ä¹‰åºåˆ—å‰ç¼€ã€ç›¸å…³å¤–ï¼Œåªè½¬ä¹‰å•å­—ç¬¦(ç¼–ç æ—¶åªä½¿ç”¨ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼)'
        ...
    #]]]'''#'''
    ######################
    ######################
    ######################
    def __init__(sf, /, *
        , å­—ç¬¦ä¸²å†ƒè½¬ä¹‰åºåˆ—å‰ç¼€='!?'
        , èµ·å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½='('
        , è®«å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½=')'
        , ç¼–ç å‘å†«è´Ÿè½½å­—ç¬¦ä¸²çºŸè½¬ä¹‰åºåˆ—å‰ç¼€='.'
        , ç¼–ç å‘å†«åŸå­—ç¬¦è® è´Ÿè½½å­—ç¬¦ä¸²={'\a':'a','\b':'b','\f':'f','\n':'n','\r':'r','\t':'t','\v':'v','\0':'0',' ':'-','ã€€':'='}
        , è§£ç å‘å†«è´Ÿè½½å­—ç¬¦ä¸²è® åŸå­—ç¬¦={'a':'\a','b':'\b','f':'\f','n':'\n','r':'\r','t':'\t','v':'\v','0':'\0','-':' ','=':'ã€€'}
        , è§£ç å‘å†«é¬½åå¤‡è§£ç å™¨çºŸè´Ÿè½½å­—ç¬¦ä¸²=None
        ):
        'æç®€:è´Ÿè½½ä¸ºå•å­—ç¬¦æˆ–å˜é•¿è´Ÿè½½ï¼›é™¤äº†ã€è½¬ä¹‰åºåˆ—å‰ç¼€ã€å¤–ï¼Œåªè½¬ä¹‰å•å­—ç¬¦(ç¼–ç æ—¶ä¸å†ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼)'
        # abfnrtv0:\n... + 2 spaces
        # ã€\ã€-->ã€!?ã€-->ã€!?.ã€
        # ã€\xhhã€-->ã€!?(xhh)ã€-->è§£ç å‘å†«é¬½åå¤‡è§£ç å™¨çºŸè´Ÿè½½å­—ç¬¦ä¸²('xhh')
        d = dict(locals())
        del d['sf']
        sf.__dict__.update(d)
        sf._kwds = d
        assert å­—ç¬¦ä¸²å†ƒè½¬ä¹‰åºåˆ—å‰ç¼€
        #assert ç¼–ç å‘å†«è´Ÿè½½å­—ç¬¦ä¸²çºŸè½¬ä¹‰åºåˆ—å‰ç¼€
        assert èµ·å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½
        assert è®«å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½
        assert all(len(ch)==1 for ch in ç¼–ç å‘å†«åŸå­—ç¬¦è® è´Ÿè½½å­—ç¬¦ä¸²)
        ...
    def __repr__(sf, /):
        args = ()
        kwargs = sf._kwds
        return repr_helper(sf, *args, **kwargs)
    def è¿˜åŸå†«è´Ÿè½½æ‰Œ(sf, è´Ÿè½½, /):
        if è´Ÿè½½ == sf.ç¼–ç å‘å†«è´Ÿè½½å­—ç¬¦ä¸²çºŸè½¬ä¹‰åºåˆ—å‰ç¼€:
            m = sf.å­—ç¬¦ä¸²å†ƒè½¬ä¹‰åºåˆ—å‰ç¼€
        else:
            m = sf.è§£ç å‘å†«è´Ÿè½½å­—ç¬¦ä¸²è® åŸå­—ç¬¦.get(è´Ÿè½½)
        m
        if m is None:
            if None is sf.è§£ç å‘å†«é¬½åå¤‡è§£ç å™¨çºŸè´Ÿè½½å­—ç¬¦ä¸²:
                raise Exception(f'è§£ç å¤±è´¥:è´Ÿè½½={è´Ÿè½½!r}')
            åŸå­—ç¬¦ä¸² = sf.è§£ç å‘å†«é¬½åå¤‡è§£ç å™¨çºŸè´Ÿè½½å­—ç¬¦ä¸²(è´Ÿè½½)
        else:
            åŸå­—ç¬¦ä¸² = m
        return åŸå­—ç¬¦ä¸²
    def å°è£…å†«è´Ÿè½½æ‰Œ(sf, è´Ÿè½½, /, *, validate):
        _validate = mk_validate4sub_call_(validate)
        if len(è´Ÿè½½) == 1:
            assert not è´Ÿè½½ == sf.èµ·å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½[0]
            pass
        else:
            è´Ÿè½½ = f'{sf.èµ·å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½}{è´Ÿè½½}{sf.è®«å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½}'
        if validate:
            #xxx:if not sf.è¿˜åŸå†«è´Ÿè½½æ‰Œ(è´Ÿè½½) == ():raise Exception((sf, (), ()))
            #æ²¡æœ‰ç›¸åº”çš„è§£ç ç‰ˆï¼
            pass
        return f'{sf.å­—ç¬¦ä¸²å†ƒè½¬ä¹‰åºåˆ—å‰ç¼€}{è´Ÿè½½}'
    @override
    def è½¬ä¹‰å†«æ–‡æœ¬æ‰Œ(sf, æ–‡æœ¬ä¹Šè½¬ä¹‰å‰, /, *, validate):
        'æ–‡æœ¬ä¹Šè½¬ä¹‰å‰/str -> æ–‡æœ¬ä¹Šè½¬ä¹‰å/str'
        _validate = mk_validate4sub_call_(validate)
        def _h():
            z = sf.å°è£…å†«è´Ÿè½½æ‰Œ(sf.ç¼–ç å‘å†«è´Ÿè½½å­—ç¬¦ä¸²çºŸè½¬ä¹‰åºåˆ—å‰ç¼€, validate=_validate)
            return z.join(_f())
        def _f():
            '-> Iter éƒ¨åˆ†æ–‡æœ¬ä¹Šè½¬ä¹‰å'
            for s in æ–‡æœ¬ä¹Šè½¬ä¹‰å‰.split(sf.å­—ç¬¦ä¸²å†ƒè½¬ä¹‰åºåˆ—å‰ç¼€):
                éƒ¨åˆ†æ–‡æœ¬ä¹Šè½¬ä¹‰å = ''.join(_g(s))
                yield éƒ¨åˆ†æ–‡æœ¬ä¹Šè½¬ä¹‰å
        def _g(s, /):
            '-> Iter (è½¬ä¹‰åºåˆ—|åŸå­—ç¬¦)'
            for ch in s:
                m = sf.ç¼–ç å‘å†«åŸå­—ç¬¦è® è´Ÿè½½å­—ç¬¦ä¸².get(ch)
                t = ch if m is None else sf.å°è£…å†«è´Ÿè½½æ‰Œ(è´Ÿè½½:=m, validate=_validate)
                yield t
        #if 0b0000:print_err(æ–‡æœ¬ä¹Šè½¬ä¹‰å‰)
        #if 0b0000:print_err(æ–‡æœ¬ä¹Šè½¬ä¹‰å‰.split(sf.å­—ç¬¦ä¸²å†ƒè½¬ä¹‰åºåˆ—å‰ç¼€))
        æ–‡æœ¬ä¹Šè½¬ä¹‰å = _h()
        #if 0b0000:print_err(æ–‡æœ¬ä¹Šè½¬ä¹‰å)
        if validate:
            if not sf.è¿˜åŸå†«æ–‡æœ¬æ‰Œ(æ–‡æœ¬ä¹Šè½¬ä¹‰å) == æ–‡æœ¬ä¹Šè½¬ä¹‰å‰:raise Exception((sf, æ–‡æœ¬ä¹Šè½¬ä¹‰å‰, æ–‡æœ¬ä¹Šè½¬ä¹‰å))
        return æ–‡æœ¬ä¹Šè½¬ä¹‰å
    @override
    def è¿˜åŸå†«æ–‡æœ¬æ‰Œ(sf, æ–‡æœ¬ä¹Šè½¬ä¹‰å, /):
        'æ–‡æœ¬ä¹Šè½¬ä¹‰å/str -> æ–‡æœ¬ä¹Šè½¬ä¹‰å‰/str'
        def _h():
            #z = sf.ç¼–ç å‘å†«è´Ÿè½½å­—ç¬¦ä¸²çºŸè½¬ä¹‰åºåˆ—å‰ç¼€
            z = ''
            return z.join(_f())
        def _f():
            first = True
            for s in æ–‡æœ¬ä¹Šè½¬ä¹‰å.split(sf.å­—ç¬¦ä¸²å†ƒè½¬ä¹‰åºåˆ—å‰ç¼€):
                if first:
                    first = False
                    yield s
                else:
                    yield from _g(s)
        def _g(s, /):
            if s.startswith(sf.ç¼–ç å‘å†«è´Ÿè½½å­—ç¬¦ä¸²çºŸè½¬ä¹‰åºåˆ—å‰ç¼€):
                i = 0
                j = len(sf.ç¼–ç å‘å†«è´Ÿè½½å­—ç¬¦ä¸²çºŸè½¬ä¹‰åºåˆ—å‰ç¼€)
                end = j+0
            elif s.startswith(sf.èµ·å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½):
                i = len(sf.èµ·å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½)
                j = s.index(sf.è®«å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½, i)
                end = j + len(sf.è®«å­—ç¬¦ä¸²çºŸå˜é•¿è´Ÿè½½)
            else:
                i = 0
                j = 1
                end = j+0
            i, j, end
            è´Ÿè½½ = s[i:j]
            å…¶ä½™çºŸä¸åŠ¨ä¸² = s[end:]

            åŸå­—ç¬¦ä¸² = sf.è¿˜åŸå†«è´Ÿè½½æ‰Œ(è´Ÿè½½)
            yield åŸå­—ç¬¦ä¸²
            yield å…¶ä½™çºŸä¸åŠ¨ä¸²
        try:
            æ–‡æœ¬ä¹Šè½¬ä¹‰å‰ = _h()
        except:
            raise Exception(æ–‡æœ¬ä¹Šè½¬ä¹‰å)
        return æ–‡æœ¬ä¹Šè½¬ä¹‰å‰
#class ä¹¸åŒ´è½¬ä¹‰å†«æ–‡æœ¬ç‰œæç®€å…·ç°(é­–åŒ´è½¬ä¹‰å†«æ–‡æœ¬):
åŒ´è½¬ä¹‰å†«æ–‡æœ¬ç‰œæç®€å…·ç° = ä¹¸åŒ´è½¬ä¹‰å†«æ–‡æœ¬ç‰œæç®€å…·ç°()
åŒ´è½¬ä¹‰å†«ç”¨äºåˆ†éš”åŒ¾åè®® = ä¹¸åŒ´è½¬ä¹‰å†«æ–‡æœ¬ç‰œæç®€å…·ç°(*''
    , ç¼–ç å‘å†«åŸå­—ç¬¦è® è´Ÿè½½å­—ç¬¦ä¸²={':':'='}
    , è§£ç å‘å†«è´Ÿè½½å­—ç¬¦ä¸²è® åŸå­—ç¬¦={'=':':'}
    )


class ä¹¸æ³¨å†Œå¤„çºŸåŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬(é­–æ³¨å†Œå¤„çºŸåŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬):
    'using:åŒ´è½¬ä¹‰å†«ç”¨äºåˆ†éš”åŒ¾åè®®'
    ___no_slots_ok___ = True
    def __init__(sf, d=None, /):
        sf._d = {} if d is None else d
    def __repr__(sf, /):
        return repr_helper(sf, sf._d)
    @override
    def æšä¸¾å†«åŒ¾åè®®ä¹Šå·²æ³¨å†Œæ‰Œ(sf, /):
        '-> Iter åŒ¾åè®®/str'
        return iter(sf._d)
    @override
    def æŸ¥æ‰¾æ‰Œ(sf, åŒ¾åè®®, /):
        'åŒ¾åè®®/str -> åŒ´åŠ å¯†/é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬ | ^LookupError'
        return sf._d[åŒ¾åè®®]
    @override
    def æ³¨å†Œæ‰Œ(sf, åŒ´åŠ å¯†, /):
        'åŒ´åŠ å¯†/é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬ -> None'
        åŒ¾åè®® = åŒ´åŠ å¯†.åŒ¾åè®®
        if åŒ¾åè®® in sf._d:raise KeyError(f'å·²æ³¨å†Œå†«åŒ¾åè®®:{åŒ¾åè®®}')
        sf._d[åŒ¾åè®®] = åŒ´åŠ å¯†
        return
    @override
    def ç¼–ç å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ(sf, åŒ¾åè®®, å¯†æ–‡æ–‡æœ¬ç‰œè£¹, /, *, validate):
        'åŒ¾åè®® -> å¯†æ–‡æ–‡æœ¬ç‰œè£¹ -> å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹'
        #æ ¼å¼åŒ–
        _validate = mk_validate4sub_call_(validate)
        nm4protocol = åŒ´è½¬ä¹‰å†«ç”¨äºåˆ†éš”åŒ¾åè®®.è½¬ä¹‰å†«æ–‡æœ¬æ‰Œ(åŒ¾åè®®, validate=_validate)
        å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹ = f'{nm4protocol}:{å¯†æ–‡æ–‡æœ¬ç‰œè£¹}'
        if validate:
            if not sf.è§£ç å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ(å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹) == (åŒ¾åè®®, å¯†æ–‡æ–‡æœ¬ç‰œè£¹):raise Exception((sf, (åŒ¾åè®®, å¯†æ–‡æ–‡æœ¬ç‰œè£¹), å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹))
        return å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹
    @override
    def è§£ç å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ(sf, å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹, /):
        'å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹ -> (åŒ¾åè®®, å¯†æ–‡æ–‡æœ¬ç‰œè£¹)'
        #è§£æ
        (nm4protocol, sep, å¯†æ–‡æ–‡æœ¬ç‰œè£¹) = å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹.partition(':')
        if not sep:raise Exception((å¯†æ–‡æ–‡æœ¬ç‰œè£¹, ':'))
        åŒ¾åè®® = åŒ´è½¬ä¹‰å†«ç”¨äºåˆ†éš”åŒ¾åè®®.è¿˜åŸå†«æ–‡æœ¬æ‰Œ(nm4protocol)
        return (åŒ¾åè®®, å¯†æ–‡æ–‡æœ¬ç‰œè£¹)

import re

from seed.data_funcs.rngs import StackStyleSimpleIntMapping #make_Ranges, sorted_ints_to_iter_nontouch_ranges, detect_iter_ranges, StackStyleSimpleIntSet, , TouchRangeBasedIntMapping
from seed.text.unicode.constant import CHAR_ORD_UPPER# MAX_CHAR_ORD


class ä¹¸åŒºä½é…ç½®ç‰œç å…ƒä¸ºå­—ç¬¦ç¼–ç ç‚¹(é­–åŒºä½é…ç½®):
    r'''[[[
[ç å…ƒ == å­—ç¬¦ç¼–ç ç‚¹/unicode_ordinal]
[ä½ç§»é‡è‡«ä½å·è‡¸å­—ç¬¦ç¼–ç ç‚¹ =[def]= å­—ç¬¦ç¼–ç ç‚¹-ä½å·]

å¤šåŒºé…ç½®ç®€æ˜“è¡¨è¾¾ :: [å•åŒºé…ç½®ç®€æ˜“è¡¨è¾¾] or '::;'.join(iterå•åŒºé…ç½®ç®€æ˜“è¡¨è¾¾)
å•åŒºé…ç½®ç®€æ˜“è¡¨è¾¾ :: [å•å—é…ç½®ç®€æ˜“è¡¨è¾¾] or '::,'.join(iterå•å—é…ç½®ç®€æ˜“è¡¨è¾¾)
å•å—é…ç½®ç®€æ˜“è¡¨è¾¾:
    # ä½å·<<==æ¬¡åºæ•æ„Ÿ,ç¦æ­¢é‡å¤ç å…ƒ
    * è¿ç»­å¼/range:
        A..<Z => [A-Y]
        A..=Z => [A-Z]
            #ååŒç¼€<<==æ·»åŠ ã€<ã€ã€=ã€
            #åŒºåˆ«äºã€ç›´åˆ—å¼/listã€<<=ã€..ã€é‡å¤å­—ç¬¦
    * ç›´åˆ—å¼/list:
        ^ax-0.6 => [ax06.^-]
     ###listXrange:
        ^ax-0.6::,A..=Z
        ######################
        åˆ†åŒºç¬¦:ã€::;ã€
        åˆ†å—ç¬¦:ã€::,ã€#éå¿…éœ€
        è¿ç»­ç¬¦çºŸå·¦æ— ç©·å³æ— ç©·åŒºé—´:ã€..__ã€#ã€..__ã€ç”¨äºè¡¨è¾¾[..]
        è¿ç»­ç¬¦çºŸå·¦æ— ç©·å³å¼€åŒºé—´:ã€..^^<ã€#ã€..^^<xã€ç”¨äºè¡¨è¾¾[..<x]
        è¿ç»­ç¬¦çºŸå·¦æ— ç©·å³é—­åŒºé—´:ã€..^^=ã€#ã€..^^=xã€ç”¨äºè¡¨è¾¾[..=x]
        è¿ç»­ç¬¦çºŸå·¦é—­å³æ— ç©·åŒºé—´:ã€..$$ã€#ã€a..$$ã€ç”¨äºè¡¨è¾¾[a..]
        è¿ç»­ç¬¦çºŸå·¦é—­å³å¼€åŒºé—´:ã€..<ã€
        è¿ç»­ç¬¦çºŸé—­åŒºé—´:ã€..=ã€
        <<==:
        è¦æ±‚:å¸¦å¤–ç¼–ç é›†:ååŒç¼€&&å«é‡å¤å­—ç¬¦
        <<==:
        #æ­§ä¹‰:a...x
        a;;...x
        a...;;x
        #æ­§ä¹‰:a;;;x
        a;,,x
        a,,;x
        #æ­§ä¹‰:a,;;;x
        #æ­§ä¹‰:a,,,;x
        a;,;x
        #æ­§ä¹‰:a;,;,;x

    #]]]'''#'''
    ___no_slots_ok___ = True
    åˆ†åŒºç¬¦ = '::;'#éå¿…éœ€
    åˆ†å—ç¬¦ = '::,'#éå¿…éœ€
    è¿ç»­ç¬¦çºŸå·¦æ— ç©·å³æ— ç©·åŒºé—´ = '..__' #ã€..__ã€ç”¨äºè¡¨è¾¾[..]
    è¿ç»­ç¬¦çºŸå·¦æ— ç©·å³å¼€åŒºé—´ = '..^^<' #ã€..^^<xã€ç”¨äºè¡¨è¾¾[..<x]
    è¿ç»­ç¬¦çºŸå·¦æ— ç©·å³é—­åŒºé—´ = '..^^=' #ã€..^^=xã€ç”¨äºè¡¨è¾¾[..=x]
    è¿ç»­ç¬¦çºŸå·¦é—­å³æ— ç©·åŒºé—´ = '..$$' #ã€a..$$ã€ç”¨äºè¡¨è¾¾[a..]
    è¿ç»­ç¬¦çºŸå·¦é—­å³å¼€åŒºé—´ = '..<'
    è¿ç»­ç¬¦çºŸé—­åŒºé—´ = '..='
    @classmethod
    def æ„é€ å†«æ­£åˆ™è¡¨è¾¾å¼çºŸè¿ç»­ç¬¦æ‰Œ(cls, /):
        a00 = re.escape(cls.è¿ç»­ç¬¦çºŸå·¦æ— ç©·å³æ— ç©·åŒºé—´)
        b01 = re.escape(cls.è¿ç»­ç¬¦çºŸå·¦æ— ç©·å³å¼€åŒºé—´)
        c01 = re.escape(cls.è¿ç»­ç¬¦çºŸå·¦æ— ç©·å³é—­åŒºé—´)
        d10 = re.escape(cls.è¿ç»­ç¬¦çºŸå·¦é—­å³æ— ç©·åŒºé—´)
        e11 = re.escape(cls.è¿ç»­ç¬¦çºŸå·¦é—­å³å¼€åŒºé—´)
        f11 = re.escape(cls.è¿ç»­ç¬¦çºŸé—­åŒºé—´)

        #æ­£åˆ™è¡¨è¾¾å¼çºŸè¿ç»­ç¬¦ = re.compile(r'(?:[.][.]__|[.][.][^][^][<=].|.[.][.][$][$]|.[.][.][<=].)', re.DOTALL)
        return (æ­£åˆ™è¡¨è¾¾å¼çºŸè¿ç»­ç¬¦ := re.compile(fr'({a00}|{b01}.|{c01}.|.{d10}|.{e11}.|.{f11}.)', re.DOTALL))
            #capturing parentheses are used in pattern for "re.split()"

    def __init__(sf, /, *åŒºå·è® å•åŒºé…ç½®ç®€æ˜“è¡¨è¾¾, ä¸åŠ¨åŒºé…ç½®ç®€æ˜“è¡¨è¾¾=''):
        ######################
        cls = type(sf)
        rex4sep = cls.æ­£åˆ™è¡¨è¾¾å¼çºŸè¿ç»­ç¬¦
        ######################
        def f(ä¸‹ä¸€ä¸ªä½å·, å°å—, æ¬¤è¿ç»­å—):
            '-> (æ•°é‡, Iter (èµ·å§‹ä½å·, æ•°é‡, èµ·å§‹å­—ç¬¦ç¼–ç ç‚¹))'
            if not æ¬¤è¿ç»­å—:
                # ç›´åˆ—å—
                assert not '..' in å°å—
                it = ((èµ·å§‹ä½å·:=ä½å·, æ•°é‡:=1, èµ·å§‹å­—ç¬¦ç¼–ç ç‚¹:=code_pt) for ä½å·, code_pt in enumerate(map(ord, å°å—), ä¸‹ä¸€ä¸ªä½å·))
                æ•°é‡ = len(å°å—)
            else:
                # è¿ç»­å—
                assert '..' in å°å—
                if ((sep:=cls.è¿ç»­ç¬¦çºŸå·¦æ— ç©·å³æ— ç©·åŒºé—´) in å°å—):
                    assert sep == å°å—[:]
                    begin_pt = 0
                    end_pt = CHAR_ORD_UPPER
                elif ((sep:=cls.è¿ç»­ç¬¦çºŸå·¦æ— ç©·å³å¼€åŒºé—´) in å°å—):
                    assert sep == å°å—[:-1]
                    begin_pt = 0
                    end_pt = ord(å°å—[-1])
                elif ((sep:=cls.è¿ç»­ç¬¦çºŸå·¦æ— ç©·å³é—­åŒºé—´) in å°å—):
                    assert sep == å°å—[:-1]
                    begin_pt = 0
                    end_pt = 1+ord(å°å—[-1])
                elif ((sep:=cls.è¿ç»­ç¬¦çºŸå·¦é—­å³æ— ç©·åŒºé—´) in å°å—):
                    assert sep == å°å—[1:]
                    begin_pt = ord(å°å—[0])
                    end_pt = CHAR_ORD_UPPER
                elif ((sep:=cls.è¿ç»­ç¬¦çºŸå·¦é—­å³å¼€åŒºé—´) in å°å—):
                    assert sep == å°å—[1:-1]
                    begin_pt = ord(å°å—[0])
                    end_pt = ord(å°å—[-1])
                elif ((sep:=cls.è¿ç»­ç¬¦çºŸé—­åŒºé—´) in å°å—):
                    assert sep == å°å—[1:-1]
                    begin_pt = ord(å°å—[0])
                    end_pt = 1+ord(å°å—[-1])
                else:
                    raise 000
                begin_pt, end_pt
                èµ·å§‹ä½å· = ä¸‹ä¸€ä¸ªä½å·
                æ•°é‡ = end_pt-begin_pt
                if not æ•°é‡ >= 0:raise Exception(å°å—)
                it = iter([(èµ·å§‹ä½å·, æ•°é‡, èµ·å§‹å­—ç¬¦ç¼–ç ç‚¹:=begin_pt)])
            return (æ•°é‡, it)
        ######################
        def g(å•åŒºé…ç½®ç®€æ˜“è¡¨è¾¾, /):
            '-> Iter (èµ·å§‹ä½å·, æ•°é‡, èµ·å§‹å­—ç¬¦ç¼–ç ç‚¹)'
            ä¸‹ä¸€ä¸ªä½å· = 0
            for å•å—é…ç½®ç®€æ˜“è¡¨è¾¾ in å•åŒºé…ç½®ç®€æ˜“è¡¨è¾¾.split(cls.åˆ†å—ç¬¦):
                assert '::' not in å•å—é…ç½®ç®€æ˜“è¡¨è¾¾
                for j, å°å— in enumerate(rex4sep.split(å•å—é…ç½®ç®€æ˜“è¡¨è¾¾)):
                    æ¬¤è¿ç»­å— = bool(j&1)
                    (æ•°é‡, it) = f(ä¸‹ä¸€ä¸ªä½å·, å°å—, æ¬¤è¿ç»­å—)
                    yield from it
                    ä¸‹ä¸€ä¸ªä½å· += æ•°é‡
        ######################
        def mk_mapping_(begin_sz_v_triples, /):
            d = StackStyleSimpleIntMapping()
            begin_sz_v_triples.sort()
            for begin,sz,v in begin_sz_v_triples:
                end = begin+sz
                rng = begin, end
                #if 0b0000:print_err((rng, v))
                try:
                    d.push_rng_value(rng, v)
                except KeyError:
                    (rngs, vs) = d.rngs_values_pair
                    raise KeyError(rngs[-1:], vs[-1:], rng, v)
            d = d.to_TouchRangeBasedIntMapping()
            return d

        ######################
        ######################
        def main():
            # [ä½ç§»é‡è‡«ä½å·è‡¸å­—ç¬¦ç¼–ç ç‚¹ =[def]= å­—ç¬¦ç¼–ç ç‚¹-ä½å·]
            #   å› ä¸º å—çŠ¶æ˜ å°„ è¦æ±‚ åƒçºŸå— ä¸€è‡´
            åŒºå·è® ä½å·è® ä½ç§»é‡è‡¸å­—ç¬¦ç¼–ç ç‚¹ = []
                #ä¸å«ä¸åŠ¨åŒº
            åˆ—è¡¨çºŸå‚èµ·å§‹å­—ç¬¦ç¼–ç ç‚¹ä¸¶æ•°é‡ä¸¶å‚åŒºå·ä¸¶ä½ç§»é‡è‡«ä½å·åˆåˆ = []
                #å«ä¸åŠ¨åŒº
            for åŒºå·,å•åŒºé…ç½®ç®€æ˜“è¡¨è¾¾ in enumerate(åŒºå·è® å•åŒºé…ç½®ç®€æ˜“è¡¨è¾¾):
                åˆ—è¡¨çºŸå‚èµ·å§‹ä½å·ä¸¶æ•°é‡ä¸¶èµ·å§‹å­—ç¬¦ç¼–ç ç‚¹åˆ = [*g(å•åŒºé…ç½®ç®€æ˜“è¡¨è¾¾)]
                åˆ—è¡¨çºŸå‚èµ·å§‹ä½å·ä¸¶æ•°é‡ä¸¶ä½ç§»é‡è‡¸å­—ç¬¦ç¼–ç ç‚¹åˆ = [(j,sz,pt-j) for j,sz,pt in åˆ—è¡¨çºŸå‚èµ·å§‹ä½å·ä¸¶æ•°é‡ä¸¶èµ·å§‹å­—ç¬¦ç¼–ç ç‚¹åˆ]
                ä½å·è® ä½ç§»é‡è‡¸å­—ç¬¦ç¼–ç ç‚¹ = mk_mapping_(åˆ—è¡¨çºŸå‚èµ·å§‹ä½å·ä¸¶æ•°é‡ä¸¶ä½ç§»é‡è‡¸å­—ç¬¦ç¼–ç ç‚¹åˆ)
                åŒºå·è® ä½å·è® ä½ç§»é‡è‡¸å­—ç¬¦ç¼–ç ç‚¹.append(ä½å·è® ä½ç§»é‡è‡¸å­—ç¬¦ç¼–ç ç‚¹)
                åˆ—è¡¨çºŸå‚èµ·å§‹å­—ç¬¦ç¼–ç ç‚¹ä¸¶æ•°é‡ä¸¶å‚åŒºå·ä¸¶ä½ç§»é‡è‡«ä½å·åˆåˆ.extend((pt,sz,(åŒºå·,pt-j)) for j,sz,pt in åˆ—è¡¨çºŸå‚èµ·å§‹ä½å·ä¸¶æ•°é‡ä¸¶èµ·å§‹å­—ç¬¦ç¼–ç ç‚¹åˆ)
            else:
                #ä¸åŠ¨åŒº:
                å•åŒºé…ç½®ç®€æ˜“è¡¨è¾¾ = ä¸åŠ¨åŒºé…ç½®ç®€æ˜“è¡¨è¾¾
                åŒºå· = -1
                åˆ—è¡¨çºŸå‚èµ·å§‹ä½å·ä¸¶æ•°é‡ä¸¶èµ·å§‹å­—ç¬¦ç¼–ç ç‚¹åˆ = [*g(å•åŒºé…ç½®ç®€æ˜“è¡¨è¾¾)]
                ä½æ•°çºŸä¸åŠ¨åŒº = sum(map(snd, åˆ—è¡¨çºŸå‚èµ·å§‹ä½å·ä¸¶æ•°é‡ä¸¶èµ·å§‹å­—ç¬¦ç¼–ç ç‚¹åˆ))
                #åˆ—è¡¨çºŸå‚èµ·å§‹å­—ç¬¦ç¼–ç ç‚¹ä¸¶æ•°é‡ä¸¶å‚åŒºå·ä¸¶ä½ç§»é‡è‡«ä½å·åˆåˆ.extend((pt,sz,(åŒºå·,pt-j)) for j,sz,pt in åˆ—è¡¨çºŸå‚èµ·å§‹ä½å·ä¸¶æ•°é‡ä¸¶èµ·å§‹å­—ç¬¦ç¼–ç ç‚¹åˆ)
                    #ä½å·æ— ç”¨ï¼Œåº”è¯¥è‡ªåŠ¨æ’åº...
                def __():
                    åˆ—è¡¨çºŸå‚èµ·å§‹ä½å·ä¸¶æ•°é‡ä¸¶èµ·å§‹å­—ç¬¦ç¼–ç ç‚¹åˆ.sort(key=lambda t:t[-1])
                    j = 0
                    for _,sz,pt in åˆ—è¡¨çºŸå‚èµ·å§‹ä½å·ä¸¶æ•°é‡ä¸¶èµ·å§‹å­—ç¬¦ç¼–ç ç‚¹åˆ:
                        yield (pt,sz,(åŒºå·,pt-j))
                        j += sz
                åˆ—è¡¨çºŸå‚èµ·å§‹å­—ç¬¦ç¼–ç ç‚¹ä¸¶æ•°é‡ä¸¶å‚åŒºå·ä¸¶ä½ç§»é‡è‡«ä½å·åˆåˆ.extend(__())
            #==>>:
            åŒºå·è® ä½å·è® ä½ç§»é‡è‡¸å­—ç¬¦ç¼–ç ç‚¹#ä¸å«ä¸åŠ¨åŒº
            åˆ—è¡¨çºŸå‚èµ·å§‹å­—ç¬¦ç¼–ç ç‚¹ä¸¶æ•°é‡ä¸¶å‚åŒºå·ä¸¶ä½ç§»é‡è‡«ä½å·åˆåˆ#å«ä¸åŠ¨åŒº
            ä½æ•°çºŸä¸åŠ¨åŒº
            ######################
            åˆ—è¡¨çºŸå‚èµ·å§‹å­—ç¬¦ç¼–ç ç‚¹ä¸¶æ•°é‡ä¸¶å‚åŒºå·ä¸¶ä½ç§»é‡è‡«ä½å·åˆåˆ.sort()
            å­—ç¬¦ç¼–ç ç‚¹è® å‚åŒºå·ä¸¶ä½ç§»é‡è‡«ä½å·åˆ = mk_mapping_(åˆ—è¡¨çºŸå‚èµ·å§‹å­—ç¬¦ç¼–ç ç‚¹ä¸¶æ•°é‡ä¸¶å‚åŒºå·ä¸¶ä½ç§»é‡è‡«ä½å·åˆåˆ)

            sf._åŒºå·è® ä½å·è® ä½ç§»é‡è‡¸å­—ç¬¦ç¼–ç ç‚¹ = åŒºå·è® ä½å·è® ä½ç§»é‡è‡¸å­—ç¬¦ç¼–ç ç‚¹
                #to vivi:åŒºå·è® ä½å·è® å­—ç¬¦ç¼–ç ç‚¹
                #ä¸å«:æ— å…³ç å…ƒ#[åŒºå·>=0]
                #ä¸å«ä¸åŠ¨åŒº
            sf._å­—ç¬¦ç¼–ç ç‚¹è® å‚åŒºå·ä¸¶ä½ç§»é‡è‡«ä½å·åˆ = å­—ç¬¦ç¼–ç ç‚¹è® å‚åŒºå·ä¸¶ä½ç§»é‡è‡«ä½å·åˆ
                #to vivi:å­—ç¬¦ç¼–ç ç‚¹è® åŒºä½å·
                #å«:æ— å…³ç å…ƒ:[åŒºå·==-1]
                #å«ä¸åŠ¨åŒº
            sf._ä½æ•°çºŸä¸åŠ¨åŒº = ä½æ•°çºŸä¸åŠ¨åŒº
            ä½æ•°çºŸä¸åŠ¨åŒº
            sf._args = åŒºå·è® å•åŒºé…ç½®ç®€æ˜“è¡¨è¾¾
            sf._kwds = dict(ä¸åŠ¨åŒºé…ç½®ç®€æ˜“è¡¨è¾¾=ä¸åŠ¨åŒºé…ç½®ç®€æ˜“è¡¨è¾¾) if ä¸åŠ¨åŒºé…ç½®ç®€æ˜“è¡¨è¾¾ else {}
                #for:__repr__
            #if 0b0000:print_err(å­—ç¬¦ç¼–ç ç‚¹è® å‚åŒºå·ä¸¶ä½ç§»é‡è‡«ä½å·åˆ)

        main()
    def __repr__(sf, /):
        return repr_helper(sf, *sf._args, **sf._kwds)
    @classmethod
    def æ„é€ å†«åŒºä½é…ç½®å·›å¤šåŒºé…ç½®ç®€æ˜“è¡¨è¾¾æ‰Œ(cls, å¤šåŒºé…ç½®ç®€æ˜“è¡¨è¾¾, ä¸åŠ¨åŒºé…ç½®ç®€æ˜“è¡¨è¾¾, /):
        'å¤šåŒºé…ç½®ç®€æ˜“è¡¨è¾¾ -> ä¸åŠ¨åŒºé…ç½®ç®€æ˜“è¡¨è¾¾ -> ä¹¸åŒºä½é…ç½®ç‰œç å…ƒä¸ºå­—ç¬¦ç¼–ç ç‚¹'
        #d = StackStyleSimpleIntMapping()
        #d.push_rng_value(rng, åŒºå·)
        #d = d.to_TouchRangeBasedIntMapping()
        if type(å¤šåŒºé…ç½®ç®€æ˜“è¡¨è¾¾) is str:
            å¤šåŒºé…ç½®ç®€æ˜“è¡¨è¾¾ = å¤šåŒºé…ç½®ç®€æ˜“è¡¨è¾¾.split(cls.åˆ†åŒºç¬¦)
        åŒºå·è® å•åŒºé…ç½®ç®€æ˜“è¡¨è¾¾ = å¤šåŒºé…ç½®ç®€æ˜“è¡¨è¾¾
        return cls(*åŒºå·è® å•åŒºé…ç½®ç®€æ˜“è¡¨è¾¾, ä¸åŠ¨åŒºé…ç½®ç®€æ˜“è¡¨è¾¾=ä¸åŠ¨åŒºé…ç½®ç®€æ˜“è¡¨è¾¾)
    ######################
    @property
    def ä½æ•°çºŸä¸åŠ¨åŒº(sf, /):
        '-> ä½æ•°çºŸä¸åŠ¨åŒº/uint'
            # æ²¡æœ‰äº†: # [0 ~==~ +oo]
        return sf._ä½æ•°çºŸä¸åŠ¨åŒº
    ######################
    #åŒºå·è® ä½æ•°æ‰Œ, åŒºæ•°, ç å…ƒå·›åŒºä½å·æ‰Œ, ç å…ƒè® é¬½åŒºä½å·æ‰Œ
    @property
    @override
    def åŒºæ•°(sf, /):
        '-> åŒºæ•°/uint # [0 ~==~ +oo]'
        row2col2diff_by_pt = sf._åŒºå·è® ä½å·è® ä½ç§»é‡è‡¸å­—ç¬¦ç¼–ç ç‚¹
            #ä¸å«ä¸åŠ¨åŒº
        return len(row2col2diff_by_pt)
    @override
    def åŒºå·è® ä½æ•°æ‰Œ(sf, åŒºå·, /):
        'åŒºå·/uint%åŒºæ•° -> ä½æ•°ä¹ŠåŒºå·/uint # [0 ~==~ +oo]'
        check_int_ge(0, åŒºå·)
        row2col2diff_by_pt = sf._åŒºå·è® ä½å·è® ä½ç§»é‡è‡¸å­—ç¬¦ç¼–ç ç‚¹
            #ä¸å«ä¸åŠ¨åŒº
        return len(row2col2diff_by_pt[åŒºå·])
    @override
    def ç å…ƒè® é¬½åŒºä½å·æ‰Œ(sf, ç å…ƒ, /):
        'ç å…ƒ -> may åŒºä½å·/(åŒºå·/uint%åŒºæ•°,ä½å·/uint%ä½æ•°ä¹ŠåŒºå·) | ^LookupError'
        å­—ç¬¦ç¼–ç ç‚¹ = ç å…ƒ
        try:
            (åŒºå·,ä½ç§»é‡è‡«ä½å·) = sf._å­—ç¬¦ç¼–ç ç‚¹è® å‚åŒºå·ä¸¶ä½ç§»é‡è‡«ä½å·åˆ[å­—ç¬¦ç¼–ç ç‚¹]
                #^KeyError
        except KeyError:
            raise KeyError(repr(chr(å­—ç¬¦ç¼–ç ç‚¹)))
        if åŒºå· == -1:
            #ä¸åŠ¨åŒº
            #æ— å…³ç å…ƒ
            return None
        ä½å· = å­—ç¬¦ç¼–ç ç‚¹-ä½ç§»é‡è‡«ä½å·
        assert 0 <= ä½å· < sf.åŒºå·è® ä½æ•°æ‰Œ(åŒºå·)
        åŒºä½å· = (åŒºå·, ä½å·)
        return åŒºä½å·
    @override
    def ç å…ƒå·›åŒºä½å·æ‰Œ(sf, åŒºä½å·, /):
        'åŒºä½å·/(åŒºå·/uint%åŒºæ•°,ä½å·/uint%ä½æ•°ä¹ŠåŒºå·) -> ç å…ƒ'
        (åŒºå·, ä½å·) = åŒºä½å·
        check_int_ge(0, åŒºå·)
        check_int_ge(0, ä½å·)

        row2col2diff_by_pt = sf._åŒºå·è® ä½å·è® ä½ç§»é‡è‡¸å­—ç¬¦ç¼–ç ç‚¹
        ä½ç§»é‡è‡«ä½å·è‡¸å­—ç¬¦ç¼–ç ç‚¹ = row2col2diff_by_pt[åŒºå·][ä½å·]
        å­—ç¬¦ç¼–ç ç‚¹ = ä½å· + ä½ç§»é‡è‡«ä½å·è‡¸å­—ç¬¦ç¼–ç ç‚¹
        ç å…ƒ = å­—ç¬¦ç¼–ç ç‚¹
        return ç å…ƒ
ä¹¸åŒºä½é…ç½®ç‰œç å…ƒä¸ºå­—ç¬¦ç¼–ç ç‚¹.æ­£åˆ™è¡¨è¾¾å¼çºŸè¿ç»­ç¬¦ = ä¹¸åŒºä½é…ç½®ç‰œç å…ƒä¸ºå­—ç¬¦ç¼–ç ç‚¹.æ„é€ å†«æ­£åˆ™è¡¨è¾¾å¼çºŸè¿ç»­ç¬¦æ‰Œ()
#end-class ä¹¸åŒºä½é…ç½®ç‰œç å…ƒä¸ºå­—ç¬¦ç¼–ç ç‚¹(é­–åŒºä½é…ç½®):
if 1:
    ######################
    #ä¸å«ã€ã€‡ã€
    r'ï¼ï¼‚ï¼ƒï¼„ï¼…ï¼†ï¼‡ï¼ˆï¼‰ï¼Šï¼‹ï¼Œï¼ï¼ï¼ï¼šï¼›ï¼œï¼ï¼ï¼Ÿï¼ ï¼»ï¼¼ï¼½ï¼¾ï¼¿ï½€ï½›ï½œï½ï½ï½Ÿï½ ï¿ ï¿¡ï¿¢ï¿£ï¿¤ï¿¥ï¿¦âŒ©âŒªâ¿°â¿±â¿²â¿³â¿´â¿µâ¿¶â¿·â¿¸â¿¹â¿ºâ¿»ã€ã€‚ã€ƒã€„ã€ˆã€‰ã€Šã€‹ã€Œã€ã€ã€ã€ã€‘ã€’ã€“ã€”ã€•ã€–ã€—ã€˜ã€™ã€šã€›ã€œã€ã€ã€Ÿã€ ã€°ã€¶ã€·ã€½ã€¾ã‚›ã‚œã‚ ãƒ»ï¸ï¸‘ï¸’ï¸“ï¸”ï¸•ï¸–ï¸—ï¸˜ï¸™ï¸°ï¸±ï¸²ï¸³ï¸´ï¸µï¸¶ï¸·ï¸¸ï¸¹ï¸ºï¸»ï¸¼ï¸½ï¸¾ï¸¿ï¹€ï¹ï¹‚ï¹ƒï¹„ï¹…ï¹†ï¹‡ï¹ˆï¹‰ï¹Šï¹‹ï¹Œï¹ï¹ï¹ï¹ï¹‘ï¹’ï¹”ï¹•ï¹–ï¹—ï¹˜ï¹™ï¹šï¹›ï¹œï¹ï¹ï¹Ÿï¹ ï¹¡ï¹¢ï¹£ï¹¤ï¹¥ï¹¦ï¹¨ï¹©ï¹ªï¹«ğ–¿¢ã€€ï¼ï¼‘ï¼’ï¼“ï¼”ï¼•ï¼–ï¼—ï¼˜ï¼™ï¼¡ï¼¢ï¼£ï¼¤ï¼¥ï¼¦ï¼§ï¼¨ï¼©ï¼ªï¼«ï¼¬ï¼­ï¼®ï¼¯ï¼°ï¼±ï¼²ï¼³ï¼´ï¼µï¼¶ï¼·ï¼¸ï¼¹ï¼ºï½ï½‚ï½ƒï½„ï½…ï½†ï½‡ï½ˆï½‰ï½Šï½‹ï½Œï½ï½ï½ï½ï½‘ï½’ï½“ï½”ï½•ï½–ï½—ï½˜ï½™ï½š'
    #é™¤å»ã€ğ–¿¢ã€
    #ç§»åŠ¨ã€ï¹ã€
    #ï¼Ÿå…è®¸ã€ã€€ã€
    _punctuation_fullwidth_unsorted_chars = r'ï¼ï¼‚ï¼ƒï¼„ï¼…ï¼†ï¼‡ï¼ˆï¼‰ï¼Šï¼‹ï¼Œï¼ï¼ï¼ï¼šï¼›ï¼œï¼ï¼ï¼Ÿï¼ ï¼»ï¼¼ï¼½ï¼¾ï¼¿ï½€ï½›ï½œï½ï½ï½Ÿï½ ï¿ ï¿¡ï¿¢ï¿£ï¿¤ï¿¥ï¿¦âŒ©âŒªâ¿°â¿±â¿²â¿³â¿´â¿µâ¿¶â¿·â¿¸â¿¹â¿ºâ¿»ã€ã€‚ã€ƒã€„ã€ˆã€‰ã€Šã€‹ã€Œã€ã€ã€ã€ã€‘ã€’ã€“ã€”ã€•ã€–ã€—ã€˜ã€™ã€šã€›ã€œã€ã€ã€Ÿã€ ã€°ã€¶ã€·ã€½ã€¾ã‚›ã‚œã‚ ãƒ»ï¸ï¸‘ï¸’ï¸“ï¸”ï¸•ï¸–ï¸—ï¸˜ï¸™ï¸°ï¸±ï¸²ï¸³ï¸´ï¸µï¸¶ï¸·ï¸¸ï¸¹ï¸ºï¸»ï¸¼ï¸½ï¸¾ï¸¿ï¹€ï¹ï¹‚ï¹ƒï¹„ï¹…ï¹†ï¹‡ï¹ˆï¹‰ï¹Šï¹‹ï¹Œï¹ï¹ï¹ï¹ï¹‘ï¹’ï¹”ï¹•ï¹–ï¹—ï¹˜ï¹™ï¹šï¹›ï¹œï¹ï¹ï¹Ÿï¹ ï¹¡ï¹¢ï¹£ï¹¤ï¹¥ï¹¦ï¹¨ï¹©ï¹ªï¹«ğ–¿¢'
    'ã€€'
    #assert (162-2) == len(_punctuation_fullwidth_unsorted_chars)
    assert (162-0) == len(_punctuation_fullwidth_unsorted_chars)
    assert (32-0) == len(punctuation_ascii_sorted_chars)
    assert not 'ï½' == 'a'
    assert not 'ï¹¢' == '+'
    ######################
class ä¹¸åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬æ°ºè‡ªå®šä¹‰æ•°æ®ç‰œåŒºå†…å˜æ¢ä¹Šå­¤ç ç‰œæ’çŠ¶æ€ç‰œæ¨¡åŠ (é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬æ°ºè‡ªå®šä¹‰æ•°æ®ç‰œåŒºå†…å˜æ¢ä¹Šå­¤ç ):
    __slots__ = ()
    def __repr__(sf, /):
        return repr_helper(sf)
    @override
    def ç»Ÿè®¡å†«æ˜æ–‡æœ‰æ•ˆé•¿åº¦ç‰œæ–‡æœ¬æ‰Œ(sf, å›œæ–‡æ–‡æœ¬ç‰œè£¸, /):
        'å›œæ–‡æ–‡æœ¬ç‰œè£¸/str -> æ˜æ–‡æœ‰æ•ˆé•¿åº¦/uint'
        # !! [ç å…ƒ :: ichr/unicode_pt/code_pt]
        å›œæ–‡æ•°æ®ç‰œè£¸ = [*map(ord, å›œæ–‡æ–‡æœ¬ç‰œè£¸)]
        æ˜æ–‡æœ‰æ•ˆé•¿åº¦ = sf.ç»Ÿè®¡å†«æ˜æ–‡æœ‰æ•ˆé•¿åº¦ç‰œè‡ªå®šä¹‰æ•°æ®æ‰Œ(å›œæ–‡æ•°æ®ç‰œè£¸)
        return æ˜æ–‡æœ‰æ•ˆé•¿åº¦

    #@override
    åŒ¾åè®® = 'mod_add'
    #@override
    #ver1:åŒºä½é…ç½® = ä¹¸åŒºä½é…ç½®ç‰œç å…ƒä¸ºå­—ç¬¦ç¼–ç ç‚¹.æ„é€ å†«åŒºä½é…ç½®å·›å¤šåŒºé…ç½®ç®€æ˜“è¡¨è¾¾æ‰Œ('0..=9A..=Z::;_a..=z', r' +-#@%,.!?:;~$^&*[](){}<>|=\/')
        #[len(ä¸åŠ¨åŒº)==29]
    #ver2:å¢åŠ æ±‰å­—åŒº:
    #åŒºä½é…ç½® = ä¹¸åŒºä½é…ç½®ç‰œç å…ƒä¸ºå­—ç¬¦ç¼–ç ç‚¹.æ„é€ å†«åŒºä½é…ç½®å·›å¤šåŒºé…ç½®ç®€æ˜“è¡¨è¾¾æ‰Œ('0..=9A..=Z::;_a..=z::;ä¸€..=é¾¥', ' '+punctuation_ascii_sorted_chars.translate(str.maketrans('', '', '_"' "'`")))
        #[len(ä¸åŠ¨åŒº)==(1+32)-4==29]
    r'''[[[
    view ../../python3_src/seed/text/mk_char_pt_ranges5predicator.py
    [printable%95 == alnum%(10+26*2==62) | punctuation%32 | space%1]
    #]]]'''#'''
    #ver3:å¢åŠ å…¶ä»–å…¨è§’å­—ç¬¦++å…è®¸å¼•å·
    åŒºä½é…ç½® = ä¹¸åŒºä½é…ç½®ç‰œç å…ƒä¸ºå­—ç¬¦ç¼–ç ç‚¹.æ„é€ å†«åŒºä½é…ç½®å·›å¤šåŒºé…ç½®ç®€æ˜“è¡¨è¾¾æ‰Œ(
    '0..=9A..=Z::;_a..=z::;ä¸€..=é¾¥::;ï¼..=ï¼™ï¼¡..=ï¼º::;ï¹ï½..=ï½š'
    , ' '+punctuation_ascii_sorted_chars.replace('_', '')
    + 'ã€€'+_punctuation_fullwidth_unsorted_chars.replace('ï¹', '').replace('ğ–¿¢', '')
    + 'ã€‡'
    )
        #del ã€.translate(str.maketrans('', '', '_"' "'`"))ã€
        #[len(ä¸åŠ¨åŒº)==1+(32-1)+1+(162-2)+1==194]
    assert åŒºä½é…ç½®.ä½æ•°çºŸä¸åŠ¨åŒº == 194, åŒºä½é…ç½®.ä½æ•°çºŸä¸åŠ¨åŒº




    #
    #
    # [é¡ºé’¥æ•°æ®,é€†é’¥æ•°æ® :: int] #å…è´Ÿ
    # [ç å…ƒ :: ichr/unicode_pt/code_pt]

    # ç¼–ç å†«æ˜æ–‡ç‰œè£¸æ‰Œ
    # è§£ç å†«æ˜æ–‡ç‰œè£¸æ‰Œ
    # ç¼–ç å†«å¯†æ–‡ç‰œè£¸æ‰Œ
    # è§£ç å†«å¯†æ–‡ç‰œè£¸æ‰Œ
    # ç¼–ç å†«å¯†æ–‡ç‰œè£¹ç‰œç¬æ‰Œ
    # è§£ç å†«å¯†æ–‡ç‰œè£¹ç‰œç¬æ‰Œ

    # ç¼–ç å†«é€†é’¥æ‰Œ
    # è§£ç å†«é€†é’¥æ‰Œ
    # ç¼–ç å†«é¡ºé’¥æ‰Œ
    # è§£ç å†«é¡ºé’¥æ‰Œ
    #
    #
    #
    # [çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ :: (é¡ºé’¥æ•°æ®,åŒºå·ä¸²ä¹Šä½æ¬¡ä¿æŒ)]
    # [çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´ :: (åŒºå·ä¸²ä¹Šä½æ¬¡å˜æ›´,é€†é’¥æ•°æ®)]
    # [ç´¢å¼•ç½®æ¢ç‰œé¡ºå‘ == range(æ˜æ–‡æœ‰æ•ˆé•¿åº¦)]
    # [ç´¢å¼•ç½®æ¢ç‰œé€†å‘ == ç´¢å¼•ç½®æ¢ç‰œé¡ºå‘]
    # [é€†é’¥æ•°æ® == é¡ºé’¥æ•°æ®]
    #
    # æ³¨æ°´è§£ç å†«çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒæ‰Œ
    # æ³¨æ°´è§£ç å†«çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´æ‰Œ
    # è„±æ°´ç¼–ç å†«çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´æ‰Œ
    # å¤ä½æ‰Œ
    # æ˜“ä½æ‰Œ
    #
    #
    # åŒºå†…åŠ å¯†ä¹Šå­¤ç æ‰Œ
    # åŒºå†…è§£å¯†ä¹Šå­¤ç æ‰Œ
    #
    #
    #
    @override
    def è§£ç å†«é€†é’¥æ‰Œ(sf, é€†é’¥æ–‡æœ¬, /):
        'é€†é’¥æ–‡æœ¬ -> é€†é’¥æ•°æ®'
        é€†é’¥æ•°æ® = int(é€†é’¥æ–‡æœ¬, 10)
        return é€†é’¥æ•°æ®
    @override
    def ç¼–ç å†«é€†é’¥æ‰Œ(sf, é€†é’¥æ•°æ®, /, *, validate):
        'é€†é’¥æ•°æ® -> é€†é’¥æ–‡æœ¬'
        _validate = mk_validate4sub_call_(validate)
        check_type_is(int, é€†é’¥æ•°æ®)
        é€†é’¥æ–‡æœ¬ = str(é€†é’¥æ•°æ®)
        if validate:
            if not sf.è§£ç å†«é€†é’¥æ‰Œ(é€†é’¥æ–‡æœ¬) == (é€†é’¥æ•°æ®):raise Exception((sf, (é€†é’¥æ•°æ®), (é€†é’¥æ–‡æœ¬)))
        return é€†é’¥æ–‡æœ¬
    @override
    def è§£ç å†«é¡ºé’¥æ‰Œ(sf, é¡ºé’¥æ–‡æœ¬, /, *, validate):
        'é¡ºé’¥æ–‡æœ¬ -> é¡ºé’¥æ•°æ®'
        #validate@è§£ç å‘  <<== æ­¤ä¹ƒåŠ å¯†å‘
        _validate = mk_validate4sub_call_(validate)
        é¡ºé’¥æ•°æ® = int(é¡ºé’¥æ–‡æœ¬, 10)
        if validate:
            if not sf.ç¼–ç å†«é¡ºé’¥æ‰Œ(é¡ºé’¥æ•°æ®) == (é¡ºé’¥æ–‡æœ¬):raise Exception((sf, (é¡ºé’¥æ–‡æœ¬), (é¡ºé’¥æ•°æ®)))
        return é¡ºé’¥æ•°æ®
    @override
    def ç¼–ç å†«é¡ºé’¥æ‰Œ(sf, é¡ºé’¥æ•°æ®, /):
        'é¡ºé’¥æ•°æ® -> é¡ºé’¥æ–‡æœ¬'
        check_type_is(int, é¡ºé’¥æ•°æ®)
        é¡ºé’¥æ–‡æœ¬ = str(é¡ºé’¥æ•°æ®)
        return é¡ºé’¥æ–‡æœ¬
    @override
    def è§£ç å†«æ˜æ–‡ç‰œè£¸æ‰Œ(sf, æ˜æ–‡æ–‡æœ¬ç‰œè£¸, /, *, validate):
        'æ˜æ–‡æ–‡æœ¬ç‰œè£¸ -> æ˜æ–‡æ•°æ®ç‰œè£¸'
        #validate@è§£ç å‘  <<== æ­¤ä¹ƒåŠ å¯†å‘
        _validate = mk_validate4sub_call_(validate)
        æ˜æ–‡æ•°æ®ç‰œè£¸ = tuple(map(ord, æ˜æ–‡æ–‡æœ¬ç‰œè£¸))
        if validate:
            if not sf.ç¼–ç å†«æ˜æ–‡ç‰œè£¸æ‰Œ(æ˜æ–‡æ•°æ®ç‰œè£¸) == (æ˜æ–‡æ–‡æœ¬ç‰œè£¸):raise Exception((sf, (æ˜æ–‡æ–‡æœ¬ç‰œè£¸), (æ˜æ–‡æ•°æ®ç‰œè£¸)))
        return æ˜æ–‡æ•°æ®ç‰œè£¸
    @override
    def ç¼–ç å†«æ˜æ–‡ç‰œè£¸æ‰Œ(sf, æ˜æ–‡æ•°æ®ç‰œè£¸, /):
        'æ˜æ–‡æ•°æ®ç‰œè£¸ -> æ˜æ–‡æ–‡æœ¬ç‰œè£¸'
        #bug:return tuple(map(chr, æ˜æ–‡æ•°æ®ç‰œè£¸))
        return ''.join(map(chr, æ˜æ–‡æ•°æ®ç‰œè£¸))
    ######################
    @override
    def è§£ç å†«å¯†æ–‡ç‰œè£¸æ‰Œ(sf, å¯†æ–‡æ–‡æœ¬ç‰œè£¸, /):
        'å¯†æ–‡æ–‡æœ¬ç‰œè£¸ -> å¯†æ–‡æ•°æ®ç‰œè£¸'
        return tuple(map(ord, å¯†æ–‡æ–‡æœ¬ç‰œè£¸))
    @override
    def ç¼–ç å†«å¯†æ–‡ç‰œè£¸æ‰Œ(sf, å¯†æ–‡æ•°æ®ç‰œè£¸, /, *, validate):
        'å¯†æ–‡æ•°æ®ç‰œè£¸ -> å¯†æ–‡æ–‡æœ¬ç‰œè£¸'
        #bug:return tuple(map(chr, å¯†æ–‡æ•°æ®ç‰œè£¸))
        _validate = mk_validate4sub_call_(validate)
        å¯†æ–‡æ–‡æœ¬ç‰œè£¸ = ''.join(map(chr, å¯†æ–‡æ•°æ®ç‰œè£¸))
        if validate:
            if not sf.è§£ç å†«å¯†æ–‡ç‰œè£¸æ‰Œ(å¯†æ–‡æ–‡æœ¬ç‰œè£¸) == (å¯†æ–‡æ•°æ®ç‰œè£¸):raise Exception((sf, (å¯†æ–‡æ•°æ®ç‰œè£¸), (å¯†æ–‡æ–‡æœ¬ç‰œè£¸)))
        return å¯†æ–‡æ–‡æœ¬ç‰œè£¸
    ######################
    @override
    def è§£ç å†«å¯†æ–‡ç‰œè£¹ç‰œç¬æ‰Œ(sf, å¯†æ–‡æ–‡æœ¬ç‰œè£¹, /):
        'å¯†æ–‡æ–‡æœ¬ç‰œè£¹ -> (é€†é’¥æ–‡æœ¬, å¯†æ–‡æ–‡æœ¬ç‰œè£¸)'
        #è§£æ/parse
        (é€†é’¥æ–‡æœ¬, sep, å¯†æ–‡æ–‡æœ¬ç‰œè£¸) = å¯†æ–‡æ–‡æœ¬ç‰œè£¹.partition(':')
        if not sep:raise Exception((å¯†æ–‡æ–‡æœ¬ç‰œè£¹, ':'))
        return (é€†é’¥æ–‡æœ¬, å¯†æ–‡æ–‡æœ¬ç‰œè£¸)
    @override
    def ç¼–ç å†«å¯†æ–‡ç‰œè£¹ç‰œç¬æ‰Œ(sf, é€†é’¥æ–‡æœ¬, å¯†æ–‡æ–‡æœ¬ç‰œè£¸, /, *, validate):
        'é€†é’¥æ–‡æœ¬ -> å¯†æ–‡æ–‡æœ¬ç‰œè£¸ -> å¯†æ–‡æ–‡æœ¬ç‰œè£¹'
        #æ ¼å¼åŒ–/format
        _validate = mk_validate4sub_call_(validate)
        å¯†æ–‡æ–‡æœ¬ç‰œè£¹ = f'{é€†é’¥æ–‡æœ¬}:{å¯†æ–‡æ–‡æœ¬ç‰œè£¸}'
        if validate:
            if not sf.è§£ç å†«å¯†æ–‡ç‰œè£¹ç‰œç¬æ‰Œ(å¯†æ–‡æ–‡æœ¬ç‰œè£¹) == (é€†é’¥æ–‡æœ¬, å¯†æ–‡æ–‡æœ¬ç‰œè£¸):raise Exception((sf, (é€†é’¥æ–‡æœ¬, å¯†æ–‡æ–‡æœ¬ç‰œè£¸), (å¯†æ–‡æ–‡æœ¬ç‰œè£¹)))
        return å¯†æ–‡æ–‡æœ¬ç‰œè£¹





    @override
    def æ³¨æ°´è§£ç å†«çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒæ‰Œ(sf, é¡ºé’¥æ•°æ®, åŒºå·ä¸²ä¹Šä½æ¬¡ä¿æŒ, /):
        'é¡ºé’¥æ•°æ® -> åŒºå·ä¸²ä¹Šä½æ¬¡ä¿æŒ/[åŒºå·] -> çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ'
        #æœ¬è¯¥:validate@è§£ç å‘  <<== æ­¤ä¹ƒåŠ å¯†å‘
        #   ä½†:æ²¡æœ‰ç›¸åº”çš„ç¼–ç ç‰ˆï¼
        çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ = (é¡ºé’¥æ•°æ®,åŒºå·ä¸²ä¹Šä½æ¬¡ä¿æŒ)
        return çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ
    @override
    def æ³¨æ°´è§£ç å†«çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´æ‰Œ(sf, åŒºå·ä¸²ä¹Šä½æ¬¡å˜æ›´, é€†é’¥æ•°æ®, /):
        'åŒºå·ä¸²ä¹Šä½æ¬¡å˜æ›´/[åŒºå·] -> é€†é’¥æ•°æ® -> çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´'
        çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´ = (åŒºå·ä¸²ä¹Šä½æ¬¡å˜æ›´,é€†é’¥æ•°æ®)
        return çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´
    @override
    def è„±æ°´ç¼–ç å†«çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´æ‰Œ(sf, çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´, /, *, validate):
        'çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´ -> é€†é’¥æ•°æ®'
        _validate = mk_validate4sub_call_(validate)
        (åŒºå·ä¸²ä¹Šä½æ¬¡å˜æ›´,é€†é’¥æ•°æ®) = çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´
        if validate:
            if not sf.æ³¨æ°´è§£ç å†«çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´æ‰Œ(åŒºå·ä¸²ä¹Šä½æ¬¡å˜æ›´, é€†é’¥æ•°æ®) == (çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´):raise Exception((sf, (çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´), åŒºå·ä¸²ä¹Šä½æ¬¡å˜æ›´, (é€†é’¥æ•°æ®)))
        return é€†é’¥æ•°æ®
    @override
    def æ˜“ä½æ‰Œ(sf, çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, /, *, validate):
        'çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ -> (çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´, ç´¢å¼•ç½®æ¢ç‰œé¡ºå‘/[uint%æ˜æ–‡æœ‰æ•ˆé•¿åº¦])'
        # ä¸åŠ¨:æ’ç­‰å˜æ¢
        _validate = mk_validate4sub_call_(validate)
        (é¡ºé’¥æ•°æ®,åŒºå·ä¸²ä¹Šä½æ¬¡ä¿æŒ) = çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ
        æ˜æ–‡æœ‰æ•ˆé•¿åº¦ = len(åŒºå·ä¸²ä¹Šä½æ¬¡ä¿æŒ)
        ç´¢å¼•ç½®æ¢ç‰œé¡ºå‘ = range(æ˜æ–‡æœ‰æ•ˆé•¿åº¦)
        é€†é’¥æ•°æ® = é¡ºé’¥æ•°æ®
        åŒºå·ä¸²ä¹Šä½æ¬¡å˜æ›´ = ç½®æ¢æ‰Œ(ç´¢å¼•ç½®æ¢ç‰œé¡ºå‘,åŒºå·ä¸²ä¹Šä½æ¬¡ä¿æŒ)
        çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´ = sf.æ³¨æ°´è§£ç å†«çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´æ‰Œ(åŒºå·ä¸²ä¹Šä½æ¬¡å˜æ›´,é€†é’¥æ•°æ®)
        if validate:
            if not sf.å¤ä½æ‰Œ(çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´) == (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ,ç´¢å¼•ç½®æ¢ç‰œé€†å‘:=ç´¢å¼•ç½®æ¢ç‰œé¡ºå‘):raise Exception((sf, (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ), (çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´,ç´¢å¼•ç½®æ¢ç‰œé¡ºå‘)))
        return (çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´,ç´¢å¼•ç½®æ¢ç‰œé¡ºå‘)
    @override
    def å¤ä½æ‰Œ(sf, çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´, /):
        'çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´ -> (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ç´¢å¼•ç½®æ¢ç‰œé€†å‘/[uint%æ˜æ–‡æœ‰æ•ˆé•¿åº¦])'
        # ä¸åŠ¨:æ’ç­‰å˜æ¢
        (åŒºå·ä¸²ä¹Šä½æ¬¡å˜æ›´,é€†é’¥æ•°æ®) = çŠ¶æ€ä¹Šä½æ¬¡å˜æ›´
        æ˜æ–‡æœ‰æ•ˆé•¿åº¦ = len(åŒºå·ä¸²ä¹Šä½æ¬¡å˜æ›´)
        ç´¢å¼•ç½®æ¢ç‰œé€†å‘ = range(æ˜æ–‡æœ‰æ•ˆé•¿åº¦)
            # ç´¢å¼•ç½®æ¢ç‰œé€†å‘ = ç´¢å¼•ç½®æ¢ç‰œé¡ºå‘
        åŒºå·ä¸²ä¹Šä½æ¬¡ä¿æŒ = ç½®æ¢æ‰Œ(ç´¢å¼•ç½®æ¢ç‰œé€†å‘,åŒºå·ä¸²ä¹Šä½æ¬¡å˜æ›´)
        é¡ºé’¥æ•°æ® = é€†é’¥æ•°æ®
        çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ = sf.æ³¨æ°´è§£ç å†«çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒæ‰Œ(é¡ºé’¥æ•°æ®, åŒºå·ä¸²ä¹Šä½æ¬¡ä¿æŒ)
        return (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ç´¢å¼•ç½®æ¢ç‰œé€†å‘)






    def ç½“åŒºå†…å˜æ¢ä¹Šå­¤ç æ‰Œ(sf, åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡, çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·, /, *, åŠ å¯†ä¸·è§£å¯†):
        'åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡ -> çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ -> ä½å· -> (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·)'
        #æ’çŠ¶æ€
        (é¡ºé’¥æ•°æ®,åŒºå·ä¸²ä¹Šä½æ¬¡ä¿æŒ) = çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ
        æ˜æ–‡æœ‰æ•ˆé•¿åº¦ = len(åŒºå·ä¸²ä¹Šä½æ¬¡ä¿æŒ)
        # !! ä½å·@åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡
        åŒºå· = åŒºå·ä¸²ä¹Šä½æ¬¡ä¿æŒ[åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡]
        ä½æ•°ä¹ŠåŒºå· = sf.åŒºä½é…ç½®.åŒºå·è® ä½æ•°æ‰Œ(åŒºå·)
        n = æ˜æ–‡æœ‰æ•ˆé•¿åº¦%ä½æ•°ä¹ŠåŒºå·
        i = åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡%ä½æ•°ä¹ŠåŒºå·
        j = é¡ºé’¥æ•°æ®%ä½æ•°ä¹ŠåŒºå·
        k = (n+i+j)%ä½æ•°ä¹ŠåŒºå·
        if åŠ å¯†ä¸·è§£å¯†:
            #è§£å¯†
            k = -k
        ä½å· = (ä½å·+k)%ä½æ•°ä¹ŠåŒºå·
        åŒºå·ä¸²ä¹Šä½æ¬¡ä¿æŒ#æ’çŠ¶æ€
        return (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·)
    @override
    def åŒºå†…åŠ å¯†ä¹Šå­¤ç æ‰Œ(sf, åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡, çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·, /, *, validate):
        'åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡ -> çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ -> ä½å· -> (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·)'
        #æ’çŠ¶æ€
        _validate = mk_validate4sub_call_(validate)
        (_çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, _ä½å·) = sf.ç½“åŒºå†…å˜æ¢ä¹Šå­¤ç æ‰Œ(åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡, çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·, åŠ å¯†ä¸·è§£å¯†=False)
        if validate:
            if not (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·) == sf.åŒºå†…è§£å¯†ä¹Šå­¤ç æ‰Œ(åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡, _çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, _ä½å·):raise Exception({**locals()})
        return (_çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, _ä½å·)
    @override
    def åŒºå†…è§£å¯†ä¹Šå­¤ç æ‰Œ(sf, åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡, çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·, /):
        'åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡ -> çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ -> ä½å· -> (çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·)'
        #æ’çŠ¶æ€
        return sf.ç½“åŒºå†…å˜æ¢ä¹Šå­¤ç æ‰Œ(åºå·çºŸç å…ƒåŒ•æœ‰æ•ˆæ˜æ–‡, çŠ¶æ€ä¹Šä½æ¬¡ä¿æŒ, ä½å·, åŠ å¯†ä¸·è§£å¯†=True)
    pass

#end-class ä¹¸åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬æ°ºè‡ªå®šä¹‰æ•°æ®ç‰œåŒºå†…å˜æ¢ä¹Šå­¤ç ç‰œæ’çŠ¶æ€ç‰œæ¨¡åŠ (é­–åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬æ°ºè‡ªå®šä¹‰æ•°æ®ç‰œåŒºå†…å˜æ¢ä¹Šå­¤ç ):

åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬æ°ºè‡ªå®šä¹‰æ•°æ®ç‰œåŒºå†…å˜æ¢ä¹Šå­¤ç ç‰œæ’çŠ¶æ€ç‰œæ¨¡åŠ  = ä¹¸åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬æ°ºè‡ªå®šä¹‰æ•°æ®ç‰œåŒºå†…å˜æ¢ä¹Šå­¤ç ç‰œæ’çŠ¶æ€ç‰œæ¨¡åŠ ()
æ³¨å†Œå¤„çºŸåŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬ = ä¹¸æ³¨å†Œå¤„çºŸåŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬()
æ³¨å†Œå¤„çºŸåŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬.æ³¨å†Œæ‰Œ(åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬æ°ºè‡ªå®šä¹‰æ•°æ®ç‰œåŒºå†…å˜æ¢ä¹Šå­¤ç ç‰œæ’çŠ¶æ€ç‰œæ¨¡åŠ )


ç¬æ³¨å†Œæ‰Œ = æ³¨å†Œå¤„çºŸåŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬.æ³¨å†Œæ‰Œ
ç¬æŸ¥æ‰¾æ‰Œ = æ³¨å†Œå¤„çºŸåŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬.æŸ¥æ‰¾æ‰Œ
ç¬æšä¸¾å†«åŒ¾åè®®ä¹Šå·²æ³¨å†Œæ‰Œ = æ³¨å†Œå¤„çºŸåŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬.æšä¸¾å†«åŒ¾åè®®ä¹Šå·²æ³¨å†Œæ‰Œ

ç¬åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸è£¸æ‰Œ = æ³¨å†Œå¤„çºŸåŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬.åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸è£¸æ‰Œ
ç¬è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ = æ³¨å†Œå¤„çºŸåŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬.è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ
ç¬ç®€è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ = æ³¨å†Œå¤„çºŸåŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬.ç®€è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ

g_register_ = ç¬æ³¨å†Œæ‰Œ
g_lookup_ = ç¬æŸ¥æ‰¾æ‰Œ
g_iter_nms4protocol_ = ç¬æšä¸¾å†«åŒ¾åè®®ä¹Šå·²æ³¨å†Œæ‰Œ
g_encrypt_ = ç¬åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸è£¸æ‰Œ
g_self_decrypt__verbose_ = ç¬è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ
g_self_decrypt__brief_ = ç¬ç®€è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ

def _try(æ³¨å†Œå¤„=æ³¨å†Œå¤„çºŸåŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬, /):
    ###view ../../python3_src/nn_ns/math_nn/numbers/exponents4Mersenne_prime.py
    #-->
    #view ../../python3_src/nn_ns/math_nn/numbers/Mersenne_exponents.py
    _validate = -1
    åŒ¾åè®® = 'mod_add'
    é¡ºé’¥æ–‡æœ¬ = str(2**61 -1)
    æ˜æ–‡æ–‡æœ¬ç‰œè£¸ = '244:1341 - 0484$#'
    å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹ = æ³¨å†Œå¤„.åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸è£¸æ‰Œ(åŒ¾åè®®, é¡ºé’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸, validate=_validate)
    #if 0b0000:print_err((åŒ¾åè®®, é¡ºé’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸))
    #if 0b0000:print_err(å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹)
    (_åŒ¾åè®®, é€†é’¥æ–‡æœ¬, _æ˜æ–‡æ–‡æœ¬ç‰œè£¸) = æ³¨å†Œå¤„.è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ(å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹)
    assert _åŒ¾åè®® == åŒ¾åè®®, (åŒ¾åè®®, _åŒ¾åè®®)
    assert _æ˜æ–‡æ–‡æœ¬ç‰œè£¸ == æ˜æ–‡æ–‡æœ¬ç‰œè£¸, (æ˜æ–‡æ–‡æœ¬ç‰œè£¸, _æ˜æ–‡æ–‡æœ¬ç‰œè£¸)
    assert é€†é’¥æ–‡æœ¬ == é¡ºé’¥æ–‡æœ¬, (é¡ºé’¥æ–‡æœ¬, é€†é’¥æ–‡æœ¬)
    assert å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹ == 'mod_add:2305843009213693951:WZ0:Y131 - 16B8$#', (é¡ºé’¥æ–‡æœ¬, å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹)
    assert é¡ºé’¥æ–‡æœ¬ == '2305843009213693951', (é¡ºé’¥æ–‡æœ¬, å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹)

    é¡ºé’¥æ–‡æœ¬ = '19'
    å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹ = æ³¨å†Œå¤„.åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸è£¸æ‰Œ(åŒ¾åè®®, é¡ºé’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸, validate=_validate)
    assert å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹ == 'mod_add:19:WZ0:Y131 - 16B8$#', (é¡ºé’¥æ–‡æœ¬, å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹)

    é¡ºé’¥æ–‡æœ¬ = '1'
    å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹ = æ³¨å†Œå¤„.åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸è£¸æ‰Œ(åŒ¾åè®®, é¡ºé’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸, validate=_validate)
    assert å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹ == 'mod_add:1:EHI:GJLJ - JOTQ$#', (é¡ºé’¥æ–‡æœ¬, å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹)

    åŒ´åŠ å¯† = æ³¨å†Œå¤„.æŸ¥æ‰¾æ‰Œ(åŒ¾åè®®)
    æ˜æ–‡æœ‰æ•ˆé•¿åº¦ = åŒ´åŠ å¯†.ç»Ÿè®¡å†«æ˜æ–‡æœ‰æ•ˆé•¿åº¦ç‰œæ–‡æœ¬æ‰Œ(æ˜æ–‡æ–‡æœ¬ç‰œè£¸)

    #é¡ºé’¥æ–‡æœ¬ = str(-11) #11==(æ˜æ–‡æœ‰æ•ˆé•¿åº¦)
    é¡ºé’¥æ–‡æœ¬ = str(-æ˜æ–‡æœ‰æ•ˆé•¿åº¦)
    å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹ = æ³¨å†Œå¤„.åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸è£¸æ‰Œ(åŒ¾åè®®, é¡ºé’¥æ–‡æœ¬, æ˜æ–‡æ–‡æœ¬ç‰œè£¸, validate=_validate)
    assert å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹ == 'mod_add:-11:256:4797 - 7CHE$#', (é¡ºé’¥æ–‡æœ¬, å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹)


#_try()
assert '!?^a' == (__:=åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°.è½¬ä¹‰å†«è¶…æ–‡æœ¬æ‰Œ(['', ('a',)], validate=-1)), __

__all__

def g_encrypt_decrypt_(ed:'[+-]', msg, /, *, key='19', protocol='mod_add'):
    if ed == '+':
        #encrypt
        return g_encrypt_(protocol, key, msg, validate=1)
    elif ed == '-':
        #decrypt
        return g_self_decrypt__brief_(msg)
    else:
        raise Exception(f'[+-] not {ed!r}')

from seed.text.encrypt.anti_recognition_encrypt import g_encrypt_decrypt_

from seed.text.encrypt.anti_recognition_encrypt import g_register_, g_lookup_, g_iter_nms4protocol_, g_encrypt_, g_self_decrypt__verbose_, g_self_decrypt__brief_

from seed.text.encrypt.anti_recognition_encrypt import ç¬åŠ å¯†å†«æ˜æ–‡æ–‡æœ¬ç‰œè£¸è£¸æ‰Œ,ç¬è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ,ç¬ç®€è‡ªè§£å¯†å†«å¯†æ–‡æ–‡æœ¬ç‰œè£¹è£¹æ‰Œ
from seed.text.encrypt.anti_recognition_encrypt import ç¬æ³¨å†Œæ‰Œ,ç¬æŸ¥æ‰¾æ‰Œ,ç¬æšä¸¾å†«åŒ¾åè®®ä¹Šå·²æ³¨å†Œæ‰Œ
from seed.text.encrypt.anti_recognition_encrypt import æ³¨å†Œå¤„çºŸåŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬
from seed.text.encrypt.anti_recognition_encrypt import åŒ´åŠ å¯†ç‰œé˜²è¯†åˆ«ç‰œæ–‡æœ¬æ°ºè‡ªå®šä¹‰æ•°æ®ç‰œåŒºå†…å˜æ¢ä¹Šå­¤ç ç‰œæ’çŠ¶æ€ç‰œæ¨¡åŠ ,ä¹¸åŒºä½é…ç½®ç‰œç å…ƒä¸ºå­—ç¬¦ç¼–ç ç‚¹
from seed.text.encrypt.anti_recognition_encrypt import ä¹¸åŒ´è½¬ä¹‰å†«æ–‡æœ¬ç‰œæç®€å…·ç°,ä¹¸åŒ´è½¬ä¹‰å†«è¶…æ–‡æœ¬ç‰œæç®€å…·ç°

from seed.text.encrypt.anti_recognition_encrypt import *
